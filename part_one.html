<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=0.8"><title>I&nbsp;Fixed-Size Data</title><link rel="stylesheet" type="text/css" href="part_one_files/scribble.css" title="default"><link rel="stylesheet" type="text/css" href="part_one_files/shared.css" title="default"><link rel="stylesheet" type="text/css" href="part_one_files/racket.css" title="default"><link rel="stylesheet" type="text/css" href="part_one_files/figure.css" title="default"><link rel="stylesheet" type="text/css" href="part_one_files/manual-style.css" title="default"><link rel="stylesheet" type="text/css" href="part_one_files/manual-racket.css" title="default"><script type="text/javascript" src="part_one_files/scribble-common.js"></script><script type="text/javascript" src="part_one_files/figure.js"></script><script type="text/javascript" src="part_one_files/manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick='TocviewToggle(this,"tocview_0");'>▼</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">How to Design Programs, Second Edition</a></td></tr></tbody></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"></td><td><a href="part_preface.html" class="tocviewlink" data-pltdoc="x">Preface</a></td></tr><tr><td align="right"></td><td><a href="part_prologue.html" class="tocviewlink" data-pltdoc="x">Prologue:<span class="mywbr"> &nbsp;</span> How to Program</a></td></tr><tr><td align="right">I&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Fixed Size Data</a></td></tr><tr><td align="right"></td><td><a href="i1-2.html" class="tocviewlink" data-pltdoc="x">Intermezzo 1: Beginning Student Language</a></td></tr><tr><td align="right">II&nbsp;</td><td><a href="part_two.html" class="tocviewlink" data-pltdoc="x">Arbitrarily Large Data</a></td></tr><tr><td align="right"></td><td><a href="i2-3.html" class="tocviewlink" data-pltdoc="x">Intermezzo 2: Quote, Unquote</a></td></tr><tr><td align="right">III&nbsp;</td><td><a href="part_three.html" class="tocviewlink" data-pltdoc="x">Abstraction</a></td></tr><tr><td align="right"></td><td><a href="i3-4.html" class="tocviewlink" data-pltdoc="x">Intermezzo 3: Scope and Abstraction</a></td></tr><tr><td align="right">IV&nbsp;</td><td><a href="part_four.html" class="tocviewlink" data-pltdoc="x">Intertwined Data</a></td></tr><tr><td align="right"></td><td><a href="i4-5.html" class="tocviewlink" data-pltdoc="x">Intermezzo 4: The Nature of Numbers</a></td></tr><tr><td align="right">V&nbsp;</td><td><a href="part_five.html" class="tocviewlink" data-pltdoc="x">Generative Recursion</a></td></tr><tr><td align="right"></td><td><a href="i5-6.html" class="tocviewlink" data-pltdoc="x">Intermezzo 5: The Cost of Computation</a></td></tr><tr><td align="right">VI&nbsp;</td><td><a href="part_six.html" class="tocviewlink" data-pltdoc="x">Accumulators</a></td></tr><tr><td align="right"></td><td><a href="part_epilogue.html" class="tocviewlink" data-pltdoc="x">Epilogue:<span class="mywbr"> &nbsp;</span> Moving On</a></td></tr></tbody></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick='TocviewToggle(this,"tocview_1");'>►</a></td><td>I&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Fixed Size Data</a></td></tr></tbody></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right">1&nbsp;</td><td><a href="#%28part._ch~3abasic-arithmetic%29" class="tocviewlink" data-pltdoc="x">Arithmetic</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._ch~3afuncs-progs%29" class="tocviewlink" data-pltdoc="x">Functions and Programs</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._ch~3ahtdp%29" class="tocviewlink" data-pltdoc="x">How to Design Programs</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._ch~3aintervals-enums%29" class="tocviewlink" data-pltdoc="x">Intervals, Enumerations, and Itemizations</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._ch~3astructure%29" class="tocviewlink" data-pltdoc="x">Adding Structure</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._ch~3amix%29" class="tocviewlink" data-pltdoc="x">Itemizations and Structures</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="#%28part._ch~3asummary1%29" class="tocviewlink" data-pltdoc="x">Summary</a></td></tr></tbody></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.0.0.10</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="part_prologue.html" title="backward to &quot;Prologue: How to Program&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;How to Design Programs, Second Edition&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="i1-2.html" title="forward to &quot;Intermezzo 1: Beginning Student Language&quot;" data-pltdoc="x">next →</a></span>&nbsp;</div><h3>I<tt>&nbsp;</tt><a name="(part._part~3aone)"></a>Fixed-Size Data</h3><table cellspacing="0" cellpadding="0"><tbody><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3abasic-arithmetic%29" class="toclink" data-pltdoc="x">1<span class="hspace">&nbsp;</span>Арифметика</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aarith-num%29" class="toclink" data-pltdoc="x">1.1<span class="hspace">&nbsp;</span>Арифметика чисел </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aarith-str%29" class="toclink" data-pltdoc="x">1.2<span class="hspace">&nbsp;</span>Арифметика строк </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aarith-mix%29" class="toclink" data-pltdoc="x">1.3<span class="hspace">&nbsp;</span>Смешивание</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aarith-images%29" class="toclink" data-pltdoc="x">1.4<span class="hspace">&nbsp;</span>Арифметика изображений</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aarith-bools%29" class="toclink" data-pltdoc="x">1.5<span class="hspace">&nbsp;</span>Арифметика логических значений</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aboolean-if%29" class="toclink" data-pltdoc="x">1.6<span class="hspace">&nbsp;</span>Смешиваем с логическими значениями</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3apredicates%29" class="toclink" data-pltdoc="x">1.7<span class="hspace">&nbsp;</span>Предикаты: знай свои данные </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3afuncs-progs%29" class="toclink" data-pltdoc="x">2<span class="hspace">&nbsp;</span>Функции и программы</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3afuncs%29" class="toclink" data-pltdoc="x">2.1<span class="hspace">&nbsp;</span>Функции</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3acomputing%29" class="toclink" data-pltdoc="x">2.2<span class="hspace">&nbsp;</span>Вычисление</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3acomposing%29" class="toclink" data-pltdoc="x">2.3<span class="hspace">&nbsp;</span>Составные функции</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aglobal%29" class="toclink" data-pltdoc="x">2.4<span class="hspace">&nbsp;</span>Глобальные константы</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aprogs%29" class="toclink" data-pltdoc="x">2.5<span class="hspace">&nbsp;</span>Программы</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3ahtdp%29" class="toclink" data-pltdoc="x">3<span class="hspace">&nbsp;</span>Как разрабатывать программы</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3adesign-func%29" class="toclink" data-pltdoc="x">3.1<span class="hspace">&nbsp;</span>Разработка(Проектирование) Функций</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3afinger-design%29" class="toclink" data-pltdoc="x">3.2<span class="hspace">&nbsp;</span>Упражнения для пальцев: функции</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3adomain%29" class="toclink" data-pltdoc="x">3.3<span class="hspace">&nbsp;</span>Область Знаний</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3adesign%29" class="toclink" data-pltdoc="x">3.4<span class="hspace">&nbsp;</span>От функций к программам</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3atesting%29" class="toclink" data-pltdoc="x">3.5<span class="hspace">&nbsp;</span>На тестировании</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._.D.K._sec~3adesign-world%29" class="toclink" data-pltdoc="x">3.6<span class="hspace">&nbsp;</span>DРазработка мировых программ</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3azoo1%29" class="toclink" data-pltdoc="x">3.7<span class="hspace">&nbsp;</span>Виртуальные миры питомцев</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3aintervals-enums%29" class="toclink" data-pltdoc="x">4<span class="hspace">&nbsp;</span>Интервалы, перечисления и детализации</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3acond%29" class="toclink" data-pltdoc="x">4.1<span class="hspace">&nbsp;</span>Программирование с условиями</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aworks%29" class="toclink" data-pltdoc="x">4.2<span class="hspace">&nbsp;</span>Вычисление условий</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aenums%29" class="toclink" data-pltdoc="x">4.3<span class="hspace">&nbsp;</span>Перечисления</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aintervals%29" class="toclink" data-pltdoc="x">4.4<span class="hspace">&nbsp;</span>Интервалы</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._itemization._sec~3aitemization%29" class="toclink" data-pltdoc="x">4.5<span class="hspace">&nbsp;</span>Детализация</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3adesign-itemization%29" class="toclink" data-pltdoc="x">4.6<span class="hspace">&nbsp;</span>Проектирование с использованием детализации </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aworlds-more%29" class="toclink" data-pltdoc="x">4.7<span class="hspace">&nbsp;</span>Миры конечных состояний</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3astructure%29" class="toclink" data-pltdoc="x">5<span class="hspace">&nbsp;</span>Добавление структуры</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aposn-structures%29" class="toclink" data-pltdoc="x">5.1<span class="hspace">&nbsp;</span>От позиций к Структурам <span class="RktSym">posn</span> </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aeval-posns%29" class="toclink" data-pltdoc="x">5.2<span class="hspace">&nbsp;</span>Вычисления с <span class="RktSym">posn</span>s</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aprogramming-posn%29" class="toclink" data-pltdoc="x">5.3<span class="hspace">&nbsp;</span>Программирование с <span class="RktSym">posn</span></a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3astructures%29" class="toclink" data-pltdoc="x">5.4<span class="hspace">&nbsp;</span>Определение типов структур</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aeval-structs%29" class="toclink" data-pltdoc="x">5.5<span class="hspace">&nbsp;</span>Вычисления со структурами</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aprogstructs%29" class="toclink" data-pltdoc="x">5.6<span class="hspace">&nbsp;</span>Программирование со структурами</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._data-uni._sec~3adata-uni%29" class="toclink" data-pltdoc="x">5.7<span class="hspace">&nbsp;</span>Вселенная данных</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3adesignstructs%29" class="toclink" data-pltdoc="x">5.8<span class="hspace">&nbsp;</span>Проектирование с помощью структур </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aworld-structs%29" class="toclink" data-pltdoc="x">5.9<span class="hspace">&nbsp;</span>Структура в мире</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aedit1%29" class="toclink" data-pltdoc="x">5.10<span class="hspace">&nbsp;</span>Графический редактор </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3azoo2%29" class="toclink" data-pltdoc="x">5.11<span class="hspace">&nbsp;</span>Больше виртуальных питомцев</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3amix%29" class="toclink" data-pltdoc="x">6<span class="hspace">&nbsp;</span>Детализация и структуры </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._mix._sec~3aitemization-design2%29" class="toclink" data-pltdoc="x">6.1<span class="hspace">&nbsp;</span>Опять же, проектирование с использованием детализации </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aworlds-mix%29" class="toclink" data-pltdoc="x">6.2<span class="hspace">&nbsp;</span>Смешивая миры</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3ainput-errors%29" class="toclink" data-pltdoc="x">6.3<span class="hspace">&nbsp;</span>Ошибки ввода</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aworld-checking%29" class="toclink" data-pltdoc="x">6.4<span class="hspace">&nbsp;</span>Проверка мира </a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aequality1%29" class="toclink" data-pltdoc="x">6.5<span class="hspace">&nbsp;</span>Предикаты равенства</a></p>

</td></tr><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3asummary1%29" class="toclink" data-pltdoc="x">7<span class="hspace">&nbsp;</span>Резюме</a></p>

</td></tr></tbody></table>

<p>Каждый язык программирования поставляется с языком данных и 
языком операций с данными. Первый язык всегда предоставляет некоторые 
формы атомарных данных; Чтобы представить разнообразную информацию в 
реальном мире в виде данных, программист должен научиться составлять 
базовые данные и описывать такие композиции. Точно так же второй язык 
обеспечивает некоторые базовые операции с атомарными данными; Задача 
программиста состоит в том, чтобы объединить эти операции в программы, 
выполняющие желаемые вычисления. Мы используем арифметику для комбинации 
этих двух частей языка программирования, потому что она обобщает то, что 
вы знаете из начальной школы. </p>

<p>Эта первая часть книги (I) знакомит с арифметикой BSL, языка программирования, 
используемого в Прологе(начальной части книги). От арифметики - небольшой шаг 
до ваших первых простых программ, известных вам из математики как 
<span style="font-style: italic"> функции</span> . 
Однако, прежде чем вы это осознаете, процесс написания программ выглядит запутанным, 
и вы будете стремиться найти способ упорядочить свои мысли. Мы приравниваем 
“организацию мыслей“ к <span class="emph">разработке(проектированию)</span>, 
и эта первая часть книги знакомит вас с систематическим способом разработки программ.</p>

<h3>1<tt>&nbsp;</tt><a name="(part._ch~3abasic-arithmetic)"></a>Арифметика</h3>

<p></p>

<div class="SIntrapara">Из <a href="part_prologue.html" data-pltdoc="x">Пролога: Как программировать</a>, вы знаете как записать
<span style="font-style: italic">выражение</span> знакомое вам с первого класса, в нотации BSL:
</div><div class="SIntrapara"><ul><li>

<p>запишите “<span class="RktInBG"><span class="hspace"></span><span class="RktIn">(</span><span class="hspace"></span></span>”,<span class="refelem"><span class="refcolumn"><span class="refcontent">Быстро просмотрите эту первую главу, переходите ко второй и возвращайтесь
сюда, когда встретите “арифметику“, которую вы не знаете. .</span></span></span></p>

</li><li>

<p>дальше запишите название примитивной операции  <span class="RktSym">op</span>,</p>

</li><li>

<p>далее запишите аргументы, разделенные пробелом, и</p>

</li><li>

<p>далее запишите “<span class="RktInBG"><span class="hspace"></span><span class="RktIn">)</span><span class="hspace"></span></span>”.</p>

</li></ul></div><div class="SIntrapara">Напоминаем, что здесь это примитивное выражение:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Оно использует <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span>,  операцию 
сложения двух чисел, за которой следуют два аргумента, которые являются простыми числами. 
Но вот другой пример:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">В этом втором примере используются 
два момента в приведенном выше описании, которые открыты для интерпретации. 
Во-первых, примитивные операции могут использовать более двух аргументов. 
Во-вторых, аргументы не обязательно должны быть числами сами по себе; они 
тоже могут быть выражениями. </div>

<p></p>

<p></p>

<div class="SIntrapara">Вычисление выражений также просто. Сначала BSL вычисляет 
все аргументы примитивной операции. Во-вторых, он “скармливает“ полученные данные 
операции, которая дает результат. Таким образом, 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">3</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara"><span class="refelem"><span class="refcolumn"><span class="refcontent">Мы используем <span class="RktSym">==</span> 
для обозначения ”равно согласно законам вычислений”. </span></span></span>
и
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">18</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Эти расчеты должны показаться вам знакомыми, потому что они аналогичны
расчетам, которые вы выполняли на уроках математики. Возможно, вы записали шаги по-другому;
Возможно, вас никогда не учили записывать последовательность шагов расчета. Тем не менее, 
BSL выполняет вычисления точно так же, как и вы, и это должно быть облегчением. Он
гарантирует, что вы понимаете, что он делает с примитивными операциями и примитивными данными,
поэтому есть некоторая надежда, что вы сможете предсказать, что будут вычислять ваши
программы. Вообще говоря, для программиста критически важно знать, как вычисляет выбранный
язык, потому что в противном случае вычисления программы могут нанести вред людям, 
которые их используют или от имени которых программы вычисляют. </div>

<p></p>

<p>В оставшейся части этой главы представлены четыре формы 
<span style="font-style: italic">атомарных данных</span> BSL: числа, строки, 
изображения и логические значения.
<span class="refelem"><span class="refcolumn"><span class="refcontent">
В следующем томе <span style="font-style: italic">Как разрабатывать компоненты/span>
 будет объяснено, как проектировать атомарные данные.
</span></span></span>
Мы используем здесь слово “атомный“ по аналогии с физикой. Вы не можете 
заглянуть внутрь атомарных фрагментов данных, но у вас есть функции, которые объединяют несколько фрагментов атомарных данных в другие, извлекают их “свойства“, в том числе в
терминах атомарных данных, и так далее. В разделах этой главы представлены некоторые 
из этих функций, также называемых <span style="font-style: italic">примитивными операциями
</span> или <span style="font-style: italic">предопределенными операциями</span>. 
Вы можете найти другие в документации BSL, поставляемой с DrRacket. </p>

<h4>1.1<tt>&nbsp;</tt><a name="(part._sec~3aarith-num)"></a>Арифметика Чисел</h4>

<p>Большинство людей думают о “числах“ и “операциях с числами“, когда слышат 
“арифметика“. “Операции с числами“ означает сложение двух чисел для получения 
третьего, вычитание одного числа из другого, определение наибольшего общего 
делителя двух чисел и многое другое. Если мы не будем воспринимать арифметику 
слишком буквально, мы можем даже включить синус угла, округление действительнго
числа до ближайшего целого и т. Д. </p>

<p></p>

<div class="SIntrapara">Язык BSL поддерживает 
<a name="(tech._number)"></a><span style="font-style: italic">числа</span> и арифметику
над ними. Как обсуждалось в Прологе, арифметическая операция, такая как 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span>, используется следующим образом: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">то есть в форме префиксной записи. 
Вот некоторые из операций с числами, которые предоставляет наш язык:  
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._abs%29%29" class="RktValLink" data-pltdoc="x">abs</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._add1%29%29" class="RktValLink" data-pltdoc="x">add1</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._ceiling%29%29" class="RktValLink" data-pltdoc="x">ceiling</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._denominator%29%29" class="RktValLink" data-pltdoc="x">denominator</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._exact-~3einexact%29%29" class="RktValLink" data-pltdoc="x">exact-&gt;inexact</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._expt%29%29" class="RktValLink" data-pltdoc="x">expt</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._floor%29%29" class="RktValLink" data-pltdoc="x">floor</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._gcd%29%29" class="RktValLink" data-pltdoc="x">gcd</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._log%29%29" class="RktValLink" data-pltdoc="x">log</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._max%29%29" class="RktValLink" data-pltdoc="x">max</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._numerator%29%29" class="RktValLink" data-pltdoc="x">numerator</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._quotient%29%29" class="RktValLink" data-pltdoc="x">quotient</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._remainder%29%29" class="RktValLink" data-pltdoc="x">remainder</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqr%29%29" class="RktValLink" data-pltdoc="x">sqr</a></span>, и
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._tan%29%29" class="RktValLink" data-pltdoc="x">tan</a></span>.
 Мы пошли по алфавиту, чтобы показать разнообразие операций. Изучите, что 
они вычисляют, а затем узнайте, сколько их еще.</div>

<p></p>

<p></p>

<div class="SIntrapara">Если вам нужна операция с числами, которую вы знаете 
из курсов математики, скорее всего, BSL тоже знает о ней. Угадайте её название и
поэкспериментируйте в области взаимодействия. Скажем, вам нужно вычислить синус
(<span style="font-style: italic">sin</span>)
некоторого угла; пробуйте
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sin%29%29" class="RktValLink" data-pltdoc="x">sin</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">0</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">и пользуйтесь
им долго и счастливо. Или загляните в HelpDesk. 
<span class="refelem"><span class="refcolumn"><span class="refcontent">Вы можете знать 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._e%29%29" class="RktValLink" data-pltdoc="x">e</a></span> из математики. Это действительное число,
близкое к 2,718, которое называется “постоянной Эйлера“. Там вы обнаружите, что в 
дополнение к операциям BSL также распознает имена некоторых широко используемых чисел, например,  <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span> и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._e%29%29" class="RktValLink" data-pltdoc="x">e</a></span>.</div>

<p></p>

<p>Когда дело доходит до чисел, программы BSL могут использовать 
натуральные числа, 
целые числа, 
рациональные числа, 
действительные числа и 
комплексные числа. 
Мы предполагаем, что вы слышали обо всем, кроме последнего. Последнее могло 
быть упомянуто в вашем классе средней школы. Если нет, не волнуйтесь; 
Хотя комплексные числа полезны для всех видов вычислений, новичку необязательно 
знать о них. </p>

<p>Действительно важное различие касается точности чисел. 
На данный момент важно понимать, что BSL различает <span style="font-style: italic">точные числа
(exact numbers)</span> и <span style="font-style: italic">неточные числа
(inexact numbers)</span>. При вычислениях с точными числами BSL по возможности сохраняет 
эту точность. Например, <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="stt"> </span><span class="RktVal">4</span><span class="stt"> </span><span class="RktVal">6</span><span class="RktPn">)</span> дает точную дробь <span class="RktVal">2/3</span>,
 которую DrRacket может отображать как правильную дробь, неправильную дробь или смешанную
десятичную дробь. Поиграйте с компьютерной мышью, чтобы найти меню, в котором дробь 
заменяется десятичной дробью. </p>

<p>Некоторые числовые операции BSL не могут дать точного результата. Например, 
использование операции <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqrt%29%29" class="RktValLink" data-pltdoc="x">sqrt</a></span> над <span class="RktVal">2</span>
 дает иррациональное число, которое нельзя описать конечным числом цифр. 
Поскольку компьютеры имеют конечный размер и BSL должен каким-то образом вписывать 
такие числа в компьютер, он выбирает приближение: 
<span class="RktRes">1.4142135623730951</span>. Как упоминалось в Прологе, 
префикс <span class="stt">#i</span> предупреждает начинающих программистов об 
этой неточности. В то время как большинство языков программирования предпочитают 
снижать точность таким образом, лишь немногие рекламируют это и еще меньше предупреждают программистов. </p>

<p><span style="font-weight: bold">Замечание о числах</span>  
Слово “<a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">число(Number)</span></a>” относится к большому количеству чисел, 
включая счетные числа, целые числа, рациональные числа, действительные числа и 
даже комплексные числа. В большинстве случаев вы можете безопасно приравнять 
<a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a> к числовой прямой из начальной школы, 
хотя иногда этот перевод бывает слишком неточным. Если мы хотим быть точными, 
мы используем соответствующие слова: <a name="(tech._integer)"></a><span style="font-style: italic">Integer</span>, <a name="(tech._rational)"></a><span style="font-style: italic">Rational</span> и так далее. Мы можем даже уточнить эти понятия, 
используя такие стандартные термины, как <a name="(tech._positiveinteger)"></a><span style="font-style: italic">PositiveInteger</span>, <a name="(tech._nonnegativenumber)"></a><span style="font-style: italic">NonnegativeNumber</span>,
 <a name="(tech._negativenumber)"></a><span style="font-style: italic">NegativeNumber</span>, и т. Д. <span style="font-weight: bold">Конец</span></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._arith-n))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;1. Добавьте следующие определения для x и y в область 
определений DrRacket: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Теперь представьте, что 
<span class="RktSym">x</span> и <span class="RktSym">y</span> - координаты декартовой 
точки. Напишите выражение, которое вычисляет расстояние от этой точки до начала 
координат, то есть точки с координатами 
 (<span class="RktVal">0</span>,<span class="RktVal">0</span>).</div>

<p></p>

<p>Ожидаемый результат для этих значений - <span class="RktVal">5</span>, 
но ваше выражение должно давать правильный результат даже после изменения этих определений. </p>

<p></p>

<div class="SIntrapara">На всякий случай, если вы не проходили курсы геометрии 
или если вы забыли формулу, с которой встречались там, точка 
 <span style="font-style: italic"></span>(<span style="font-style: italic">x,y</span>)<span style="font-style: italic"></span> имеет расстояние 
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img src="part_one_files/pict_26.png" alt="image" width="52" height="15"></p>

</blockquote></div><div class="SIntrapara">от начала координат. В конце концов, 
мы учим вас разрабатывать программы, а не быть геометром. </div>

<p></p>

<p></p>

<div class="SIntrapara">Чтобы разработать желаемое выражение, лучше всего нажать 
<span class="emph">RUN</span> и поэкспериментировать в области взаимодействий. 
Действие <span class="emph">RUN</span> сообщает DrRacket текущие значения <span class="RktSym">x</span> и <span class="RktSym">y</span>, чтобы вы могли 
экспериментировать с выражениями, которые используют   
<span class="RktSym">x</span> и <span class="RktSym">y</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktSym">x</span></td></tr><tr><td>

<p><span class="RktRes">3</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktSym">y</span></td></tr><tr><td>

<p><span class="RktRes">4</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">13</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">12</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Когда у вас есть 
выражение, которое дает правильный результат, скопируйте его из области взаимодействий 
в область определений. </div>

<p></p>

<p>Чтобы убедиться, что выражение работает правильно, измените <span class="RktSym">x</span>
 на <span class="RktVal">12</span> и <span class="RktSym">y</span> на 
<span class="RktVal">5</span>, затем нажмите <span class="emph">RUN</span>. 
Результат должен быть <span class="RktVal">13</span>.</p>

<p>Ваш учитель математики сказал бы, что вы вычислили 
<span style="font-weight: bold">формулу расстояния</span>. 
Чтобы использовать формулу для альтернативных входных данных, вам нужно 
открыть DrRacket, отредактировать определения <span class="RktSym">x</span> и
<span class="RktSym">y</span>, чтобы они представляли желаемые координаты, 
и нажать <span class="emph">RUN</span>. Но такой способ повторного использования 
формулы расстояния громоздок и наивен. Вскоре мы покажем вам способ определения 
функций, который упрощает повторное использование формул. Сейчас мы используем это 
упражнение, чтобы привлечь внимание к идее функций и подготовить вас к программированию 
с их помощью.  <a href="#%28counter._%28exercise._arith-n%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>1.2<tt>&nbsp;</tt><a name="(part._sec~3aarith-str)"></a>Арифметика Строк</h4>

<p>Распространенное предубеждение относительно компьютеров касается их внутренностей. 
Многие считают, что все дело в битах и байтах - какими бы они ни были - и, возможно, 
в числах, потому что все знают, что компьютеры умеют вычислять. Хотя это правда, 
что инженеры-электрики должны понимать и изучать компьютер как такой объект, 
начинающие программисты и все остальные никогда (никогда) не должны поддаваться 
подобном мыслям. </p>

<p>В языках программирования речь идет о вычислениях с информацией, 
а информация бывает во всех видах и формах. Например, программа может 
работать с цветом, именами, деловыми письмами или разговорами между людьми. 
Даже если бы мы могли кодировать такую информацию в виде чисел, это было бы 
ужасной идеей. Только представьте, что вы запомнили большие таблицы кодов, 
например, <span class="RktVal">0</span> означает “red”(красный), а 
<span class="RktVal">1</span> означает “hello”(привет) и т. Д. </p>

<p>Вместо этого большинство языков программирования предоставляют по крайней 
мере один вид данных, который имеет дело с такой символьной информацией. 
На данный момент мы используем строки BSL. Вообще говоря, 
<a name="(tech._string)"></a><span style="font-style: italic">String</span>(строки) 
- это последовательность символьных знаков, которые вы можете вводить с клавиатуры, 
а также некоторые другие, о которых мы пока не заботимся, заключенные в двойные кавычки. 
В  <a href="part_prologue.html" data-pltdoc="x">Прологе: как программировать</a> мы 
видели несколько строк BSL: <span class="RktVal">"hello"</span>,
 <span class="RktVal">"world"</span>, <span class="RktVal">"blue"</span>, <span class="RktVal">"red"</span> и другие. Первые две - это слова, которые могут 
появиться в разговоре или в письме; остальные - называют цвет, который мы, возможно, захотим использовать. </p>

<p><span style="font-weight: bold">Примечание.</span>  Мы используем 
<span style="font-style: italic">1String</span> для обозначения символьных
знаков клавиатуры, составляющих  <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String(строку)</span></a>. Например, 
<span class="RktVal">"red"</span> состоит из трех таких <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>s: <span class="RktVal">"r"</span>, <span class="RktVal">"e"</span>, <span class="RktVal">"d"</span>. Оказывается, определение <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a> - это немного больше, 
но сейчас можно думать о них как о <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String(строках)</span></a> длины 1. 
<span style="font-weight: bold">Конец</span></p>

<p></p>

<div class="SIntrapara">BSL включает только одну операцию, которая исключительно 
использует(потребляет) и производит строки: <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span>(добавление строки), которая, как мы видели в 
<a href="part_prologue.html" data-pltdoc="x">Прологе: Как программировать</a>, 
объединяет две заданные строки в одну. Думайте о <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span> как о операции, которая похожа на <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span>. 
В то время как последняя потребляет два (или более) числа и производит новое число, 
первая потребляет две или более строк и создает новую строку: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"what a "</span><span class="hspace">&nbsp;</span><span class="RktVal">"lovely "</span><span class="hspace">&nbsp;</span><span class="RktVal">"day"</span><span class="hspace">&nbsp;</span><span class="RktVal">" 4 BSL"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"what a lovely day 4 BSL"</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Ничего в данных 
числах не меняется, когда <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span> складывает их, и ничего в данных строках не меняется, когда <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span>
 объединяет их в одну большую строку. Если вы хотите вычислить такие выражения, 
вам просто нужно подумать, что для <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span> выполняются очевидные законы, 
аналогичные законам для <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span>:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">2</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="stt"> </span><span class="RktVal">"a"</span><span class="stt"> </span><span class="RktVal">"b"</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">"ab"</span></p>

</td></tr><tr><td>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">3</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="stt"> </span><span class="RktVal">"ab"</span><span class="stt"> </span><span class="RktVal">"c"</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">"abc"</span></p>

</td></tr><tr><td>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">4</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="stt"> </span><span class="RktVal">"a"</span><span class="stt"> </span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">"a "</span></p>

</td></tr><tr><td>

<p>...</p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p>...</p>

</td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._arith-s0))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;2. Добавьте следующие две строки в область определений: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">prefix</span><span class="hspace">&nbsp;</span><span class="RktVal">"hello"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">suffix</span><span class="hspace">&nbsp;</span><span class="RktVal">"world"</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Затем используйте строковые примитивы, чтобы создать выражение, 
которое объединяет <span class="RktSym">prefix</span>(префикс) и 
<span class="RktSym">suffix</span>(суффикс) и добавляет между ними <span class="RktVal">"_"</span>. Когда вы запустите эту программу, вы увидите <span class="RktVal">"hello_world"</span> в области взаимодействия. </div>

<p></p>

<p>См. <a href="#%28counter._%28exercise._arith-n%29%29" data-pltdoc="x">Упражнение&nbsp;1</a>
 чтобы узнать, как создавать выражения с помощью DrRacket.  
<a href="#%28counter._%28exercise._arith-s0%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>1.3<tt>&nbsp;</tt><a name="(part._sec~3aarith-mix)"></a>Соединим все выше сказанное</h4>

<p></p>

<div class="SIntrapara">Все другие операции (в BSL), касающиеся строк, потребляют или 
производят данные, отличные от строк. Вот некоторые примеры: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span> потребляет строку и производит число;</p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-ith%29%29" class="RktValLink" data-pltdoc="x">string-ith</a></span> потребляет строку 
<span class="RktSym">s</span> вместе с числом  <span class="RktSym">i</span> 
и извлекает  <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>, расположенную в <span class="RktSym">i</span>-й 
позиции (считая от 0); а также</p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number-~3estring%29%29" class="RktValLink" data-pltdoc="x">number-&gt;string</a></span> потребляет число и производит строку.</p>

</li></ul></div><div class="SIntrapara">Также найдите <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._substring%29%29" class="RktValLink" data-pltdoc="x">substring</a></span> и узнайте, что она делает.</div>

<p></p>

<p></p>

<div class="SIntrapara">Если документация в HelpDesk сбивает с толку, 
поэкспериментируйте с функциями в области взаимодействия. 
Задайте им соответствующие аргументы и выясните, что они вычисляют. 
Также используйте <span style="font-weight: bold">inappropriate</span>(неподходящие)
аргументы для некоторых операций, чтобы узнать, 
как реагирует BSL: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">string-length:expects a string, given 42</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как видите, 
BSL сообщает об ошибке. Первая часть “string-length” информирует вас о неправильной операции;
вторая половина указывает, что не так с аргументами. В этом конкретном примере предполагается, что <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span> применяется 
к строке, но ей дается число, а именно <span class="RktVal">42</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Естественно, можно вкладывать операции, которые потребляют и 
производят различные типы данных, <span style="font-weight: bold">если вы отслеживаете, 
что правильно, а что нет</span>. Рассмотрим это выражение из <a href="part_prologue.html" data-pltdoc="x">Пролога: Как программировать</a>: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"hello world"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Внутреннее выражение применяет 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span> к <span class="RktVal">"hello world"</span>, 
нашей любимой строке. Внешнее выражение имеет <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span> 
использующий результат внутреннего выражения и <span class="RktVal">20</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Давайте шаг за шагом определим результат этого выражения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"hello world"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">31</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Неудивительно, что
 вычисления с такими вложенными выражениями, которые имеют дело со смесью данных, 
ничем не отличаются от вычислений с числовыми выражениями. 
Вот еще один пример: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number-~3estring%29%29" class="RktValLink" data-pltdoc="x">number-&gt;string</a></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"42"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">4</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Прежде чем продолжить, 
создайте несколько вложенных выражений, которые  <span style="font-weight: bold">неправильно</span> смешивают данные, например скажем, 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Запустите их в DrRacket. 
Изучите красное сообщение об ошибке, но также посмотрите, что DrRacket выделяет 
в области определений. </div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._arith-s1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;3. Добавьте следующие две строки в область определений: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktVal">"helloworld"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Затем создайте выражение, используя строковые примитивы, 
которое добавляет <span class="RktVal">"_"</span> в позицию <span class="RktSym">i</span>.
Обычно это означает, что результирующая строка длиннее исходной; здесь ожидаемый результат - <span class="RktVal">"hello_world"</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara"><span style="font-style: italic">Позиция</span>
 означает <span style="font-style: italic">i</span> символьных знаков слева от 
начала строки, но программисты начинают отсчет с <span class="RktVal">0</span>. 
Таким образом, пятая буква в этом примере - <span class="RktVal">"w"</span>, 
потому что <span class="RktVal">0</span>-я буква - <span class="RktVal">"h"</span>. 
<span style="font-weight: bold">Подсказка</span>. Когда вы столкнетесь с такими 
“проблемами подсчета“, вы можете добавить строку цифр ниже <span class="RktSym">str</span>,
чтобы облегчить подсчет: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">str</span><span class="hspace">&nbsp;</span><span class="RktVal">"helloworld"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ind</span><span class="hspace">&nbsp;</span><span class="RktVal">"0123456789"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>См.  <a href="#%28counter._%28exercise._arith-n%29%29" data-pltdoc="x">Упражнение 
&nbsp;1</a>, чтобы узнать, как создавать выражения в DrRacket.
 <a href="#%28counter._%28exercise._arith-s1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._arith-s2))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;4. Используйте ту же настройку, что и в <a href="#%28counter._%28exercise._arith-s1%29%29" data-pltdoc="x">упражнении&nbsp;3</a>, чтобы создать выражение, которое 
удаляет <span style="font-style: italic">i</span>-ю позицию из <span class="RktSym">str</span>.
Ясно, что это выражение создает более короткую строку, чем данная. Какие значения для 
<span class="RktSym">i</span> допустимы?  <a href="#%28counter._%28exercise._arith-s2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>1.4<tt>&nbsp;</tt><a name="(part._sec~3aarith-images)"></a>Арифметика Изображений</h4>

<p><a name="(tech._image)"></a><span style="font-style: italic">Image(Изображение)
</span> - это визуальный прямоугольный фрагмент данных, например фотография или 
геометрическая фигура и ее рамка.
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Не забудьте запросить <span class="sroman">библиотеку 
<span class="Smaller"><span style="font-style: italic">2htdp/image</span></span></span>
 в новой вкладке.
</span></span></span>
Вы можете вставлять изображения в DrRacket везде, где вы можете записать выражение, 
потому что изображения являются значениями, такими же, как числа и строки. </p>

<p></p>

<div class="SIntrapara">Ваши программы также могут манипулировать изображениями 
с помощью примитивных операций. Эти примитивные операции бывают трех видов. 
Первый касается создания базовых изображений:
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span>создает изображение круга из радиуса, строки режима(mode) 
и строки цвета(color); </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._ellipse%29%29" class="RktValLink" data-pltdoc="x">ellipse</a></span> создает эллипс из двух диаметров, строки режима(mode),
и строки цвета(color);  </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._line%29%29" class="RktValLink" data-pltdoc="x">line</a></span> создает линию из двух точек и строки цвета ; </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span> создает прямоугольник шириной, высотой,
строки режима и строки цвета; </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span> создает изображение текста из строки, размера шрифта и
строки цвета; и </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._triangle%29%29" class="RktValLink" data-pltdoc="x">triangle</a></span> создает направленный вверх равносторонний треугольник
из размера, строки режима(mode) и строки цвета(color)</p>

</li></ul></div><div class="SIntrapara">Названия этих операций в основном объясняют, 
какое изображение они создают. Все, что вы должны знать, это то, что 
<span style="font-style: italic">строки режима(mode)</span> имеют значения 
<span class="RktVal">"solid"</span>(сплошной) или <span class="RktVal">"outline"</span>(контурный), а <span style="font-style: italic">строки цвета</span>
 - это строки, такие как <span class="RktVal">"orange"</span>, 
<span class="RktVal">"black"</span> и т. Д. </div>

<p></p>

<p></p>

<div class="SIntrapara">Поиграйте с этими операциями в окне взаимодействий: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_27.png" alt="image" width="27" height="27"></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"blue"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_28.png" alt="image" width="17" height="27"></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._star%29%29" class="RktValLink" data-pltdoc="x">star</a></span><span class="hspace">&nbsp;</span><span class="RktVal">12</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"gray"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_29.png" alt="image" width="26" height="25"></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Стоп! 
Вышеупомянутый пример использует ранее не упомянутую операцию. Посмотрите её 
документацию и узнайте, сколько еще таких операций есть в  библиотеке
<span class="Smaller"><span style="font-style: italic">2htdp/image</span></span> 
</span>. Поэкспериментируйте с найденными операциями.</div>

<p></p>

<p></p>

<div class="SIntrapara">Второй вид функций для изображений касается свойств изображения: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span> определяет ширину изображения в терминах
пикселей;</p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span> определяет высоту изображения; </p>

</li></ul></div><div class="SIntrapara">Они извлекают из изображений ожидаемые значения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">20</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"blue"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">20</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Стоп! Объясните, как DrRacket определяет значение этого выражения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"blue"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>Правильное понимание примитивов третьего вида, создающих изображения, 
требует введения одной новой идеи: <span style="font-style: italic">anchor point
(точки привязки)</span>. Изображение - это не просто один пиксель, оно состоит из 
множества пикселей. В частности, каждое изображение похоже на фотографию, 
то есть на прямоугольник пикселей. Один из этих пикселей является неявной точкой привязки. 
Когда вы используете примитив изображения для компоновки двух изображений, 
композиция происходит относительно точек привязки, если вы явно не укажете 
какую-либо другую точку: </p>

<p></p>

<div class="SIntrapara"><ul><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span> помещает все изображения, к которым он применяется, друг на друга, используя центр в качестве точки привязки;</p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%2Fxy%29%29" class="RktValLink" data-pltdoc="x">overlay/xy</a></span> похож на <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span>, но принимает два числа - 
<span class="RktSym">x</span> и <span class="RktSym">y</span> - между двумя аргументами изображеними. Она сдвигает второе изображение на <span class="RktSym">x</span>
 пикселей вправо и на <span class="RktSym">y</span> пикселей вниз - все относительно 
верхнего левого угла первого изображения; неудивительно, что отрицательный 
<span class="RktSym">x</span> сдвигает изображение влево, а отрицательный 
<span class="RktSym">y</span> - вверх; а также </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%2Falign%29%29" class="RktValLink" data-pltdoc="x">overlay/align</a></span> похож на <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span>, но принимает две строки, которые смещают 
точку (точки) привязки к другим частям прямоугольников. 
Всего существует девять различных позиций; экспериментируйте со всеми 
возможностями! </p>

</li></ul></div><div class="SIntrapara"><span class="sroman">Библиотека 
<span class="Smaller"><span style="font-style: italic">2htdp/image</span></span> </span>
содержит множество других примитивных функций для объединения изображений. 
Когда вы познакомитесь с обработкой изображений, вам захочется прочитать об этом. 
А пока мы представляем еще три, потому что они важны для создания анимированных сцен и изображений для игр: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span> создает прямоугольник заданной ширины и высоты; </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span> помещает изображение на сцену в указаннй позиции. 
Если изображение не помещается на данную сцену, оно соответствующим образом обрезается; </p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._scene%2Bline%29%29" class="RktValLink" data-pltdoc="x">scene+line</a></span> потребляет сцену, четыре числа и цвет, 
чтобы нарисовать линию на данном изображении. Поэкспериментируйте, чтобы увидеть, 
как это работает. </p>

</li></ul></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3alaws-of-images))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table style="border-collapse: collapse;" cellspacing="0" cellpadding="0"><tbody><tr><td style="border-bottom: 1px solid black;">

<p>арифметика чисел</p>

</td><td style="border-bottom: 1px solid black;">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;">

<p>арифметика изображений</p>

</td></tr><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">2</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._square%29%29" class="RktValLink" data-pltdoc="x">square</a></span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"orange"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_30.png" alt="image" width="18" height="18"></td></tr></tbody></table></td></tr><tr><td valign="top">

<p></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p></p>

</td></tr><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">3</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._underlay%29%29" class="RktValLink" data-pltdoc="x">underlay</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._square%29%29" class="RktValLink" data-pltdoc="x">square</a></span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"orange"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_31.png" alt="image" width="18" height="18"></td></tr></tbody></table></td></tr><tr><td valign="top">

<p></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p></p>

</td></tr><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">4</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_32.png" alt="image" width="26" height="26"></td></tr></tbody></table></td></tr><tr><td valign="top">

<p>...</p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p>...</p>

</td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;10: </span>Законы создания
изображений</span></p>

</blockquote>

<p>Законы арифметики для изображений аналогичны законам для чисел; 
см. <a href="#%28counter._%28figure._fig~3alaws-of-images%29%29" data-pltdoc="x">рисунок&nbsp;<span class="FigureRef">10</span></a> для некоторых примеров 
и сравнения с числовой арифметикой. Опять же, ни одно изображение не будет разрушено 
или изменено. Как и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span>, эти примитивы просто создают 
новые изображения, которые каким-то образом объединяют данные. </p>

<p><a name="(counter._(exercise._arith-i2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;5. Используйте библиотеку <span class="sroman">the <span class="Smaller"><span style="font-style: italic">2htdp/image</span></span></span>, чтобы создать изображение 
простой лодки или дерева. Убедитесь, что вы можете легко изменить масштаб всего изображения.
  <a href="#%28counter._%28exercise._arith-i2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._arith-i1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;6. Добавьте следующую строку в область определений:<span class="refelem"><span class="refcolumn"><span class="refcontent">Скопируйте и вставьте изображение в DrRacket.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cat</span><span class="hspace">&nbsp;</span><img src="part_one_files/cat1.png" alt="" width="75" height="117"><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Создайте выражение, которое подсчитывает количество пикселей в изображении. <a href="#%28counter._%28exercise._arith-i1%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<h4>1.5<tt>&nbsp;</tt><a name="(part._sec~3aarith-bools)"></a>Арифметика логических значений</h4>

<p>Прежде чем мы сможем разрабатывать программы, нам нужен последний вид примитивных данных: логические значения(Boolean). Есть только два вида <a name="(tech._boolean)"></a><span style="font-style: italic">логических(Boolean)</span> значений: 
<span class="RktVal">#true</span> и <span class="RktVal">#false</span> 
Программы используют логические значения для представления решений или 
состояния переключателей. </p>

<p></p>

<div class="SIntrapara">Вычисления с логическими значениями тоже просты. 
В частности, программы BSL обходятся тремя операциями: 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span>, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span>, и
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span>. 
Эти операции похожи на сложение, умножение и отрицание для чисел. 
Конечно, поскольку есть только два логических значения, на самом деле можно продемонстрировать, как эти функции работают во  <span style="font-weight: bold">всех</span> возможных ситуациях: 
</div><div class="SIntrapara"><ul><li>

<p></p>

<div class="SIntrapara"><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span> проверяет, является ли <span style="font-weight: bold">какое-либо</span> из заданных логических значений истинным -  <span class="RktVal">#true</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

</li><li>

<p></p>

<div class="SIntrapara"><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span> проверяет, <span style="font-weight: bold">все</span> ли заданные логические значения равны истинне - <span class="RktVal">#true</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

</li><li>

<p></p>

<div class="SIntrapara"> и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span> всегда выбирает логическое значение, обратное заданому :
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

</li></ul></div><div class="SIntrapara">Неудивительно, что <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span> и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span> могут использоваться более чем с двумя выражениями. 
Наконец, для <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span> и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span> есть больше, чем предполагают эти объяснения, но для объяснения дополнительного бита требуется второй взгляд на вложенные выражения.  </div>

<p></p>

<p><a name="(counter._(exercise._arith-b1))"></a><span style="font-weight: bold">Упражнение 
</span>&nbsp;7. Логические выражения могут выражать некоторые повседневные проблемы. Предположим, вы хотите решить, подходящий ли сегодня день для посещения торгового центра. 
Вы идете в торговый центр либо если
<span class="refelem"><span class="refcolumn"><span class="refcontent">Надим Хамид предложил такую формулировку упражнения.</span></span></span>не солнечно, либо сегодня пятница (потому что именно тогда в магазинах появляются новые распродажи).</p>

<p></p>

<div class="SIntrapara">Вот как вы могли бы это сделать, используя свои новые знания 
о логических значениях. Сначала добавьте эти две строки в область определений DrRacket: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sunny</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">friday</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Теперь создайте выражение, которое вычисляет, является ли пятница 
<span class="RktSym">солнечный день</span> - ложь или истина. 
Итак, в данном конкретном случае ответ - <span class="RktVal">#false</span>(ложь). 
(Почему?) </div>

<p></p>

<p>См. <a href="#%28counter._%28exercise._arith-n%29%29" data-pltdoc="x">Упражнение 
&nbsp;1</a>, чтобы узнать, как создавать выражения в DrRacket. 
Сколько комбинаций логических значений вы можете связать с <span class="RktSym">sunny</span>(солнечно) и <span class="RktSym">friday</span>(пятница)? <a href="#%28counter._%28exercise._arith-b1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>1.6<tt>&nbsp;</tt><a name="(part._sec~3aboolean-if)"></a>Объединяем все выше сказанное с логическими значениями</h4>

<p></p>

<div class="SIntrapara">Одно из важных применений логических значений касается 
вычислений с различными типами данных. Из Пролога мы знаем, что программы BSL 
могут именовать значения через определения. Например, мы могли бы запустить 
программу с 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">а затем вычислить его обратное значение
(inverse):
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">inverse-of-x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Это работает нормально, пока мы не 
редактируем программу и не меняем <span class="RktSym">x</span> на
 <span class="RktVal">0</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Здесь на помощь приходят логические значения, в частности 
условные вычисления. Сначала примитивная функция <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span> определяет, 
равны ли два (или более) числа. Если да, то выдает <span class="RktVal">#true</span>, 
в противном случае - <span class="RktVal">#false</span>. Во-вторых, есть разновидность выражения BSL, о которой мы до сих пор не упоминали: выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>. Оно использует
слово “if”(если), как если бы это была примитивная функция; но это не так. 
За словом “if”(если) следуют три выражения, разделенных пробелами (включая табуляцию, 
разрывы строк и т. Д.). Естественно, все выражение заключено в круглые скобки. 
Вот пример: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Это выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>(если) содержит три 
<span style="font-style: italic">подвыражения </span>
 <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">)</span>, <span class="RktVal">0</span> и
 <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span>. Вычисление этого выражения происходит в два этапа: 
</div><div class="SIntrapara"><ol><li>

<p>Всегда вычисляется первое выражение. Его результат должен быть логическим
значением. </p>

</li><li>

<p>Если результатом первого выражения является <span class="RktVal">#true</span>, 
то вычисляется второе выражение; в противном случае - третье. Какими бы ни были 
их результаты, они также являются результатом всего выражения 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>. </p>

</li></ol></div>

<p></p>

<blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent">

<p>Щелкните результат правой кнопкой мыши и выберите другое представление.</p>

</blockquote></blockquote></blockquote>

<p></p>

<div class="SIntrapara">Учитывая определение <span class="RktSym">x</span> выше, вы можете поэкспериментировать с выражениями 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span> в области взаимодействий: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">0.5</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Используя законы арифметики, вы можете сами вычислить результат: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">because </span><span class="RktSym">x</span><span class="RktCmt"> stands for </span><span class="RktVal">2</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktVal">2</span><span class="RktCmt"> is not equal to </span><span class="RktVal">0</span><span class="RktCmt">, </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktCmt"> is </span><span class="RktVal">#false</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">normalize this to its decimal representation </span></td></tr><tr><td><span class="RktVal">0.5</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Другими словами, DrRacket знает, что <span class="RktSym">x</span> 
означает <span class="RktVal">2</span>, а последнее не равно <span class="RktVal">0</span>.
 Следовательно, <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">)</span> дает результат <span class="RktVal">#false</span>, 
что означает, что <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span> выберет свое третье подвыражение для вычисления. </div>

<p></p>

<p></p>

<div class="SIntrapara">Стоп! Представьте, что вы редактируете определение так, чтобы оно выглядело так: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Как вы думаете
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">вычисляется в этом контексте? Почему? Покажи свой расчет</div>

<p></p>

<p>Помимо <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span>, BSL предоставляет множество других 
примитивов сравнения. Объясните, что следующие четыре примитива сравнения определяют для
чисел: <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span>, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span>, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span>,
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span>.</p>

<p>Строки не сравниваются <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span> и его родственниками. 
Вместо них вы должны использовать <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span> или <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3c~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string&lt;=?</a></span> или <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3e~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string&gt;=?</a></span> если вам когда-нибудь понадобится сравнить строки. 
Хотя очевидно, что <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span> проверяет, равны ли две заданные строки, два других примитива открыты для интерпретации. Посмотрите их документацию. Или поэкспериментируйте, угадайте общий закон, а затем проверьте в документации, правильно ли вы угадали.</p>

<p></p>

<div class="SIntrapara">Вы можете задаться вопросом, зачем вообще нужно сравнивать строки друг с другом. Итак, представьте программу, которая занимается светофорами. Он может использовать строки span class="RktVal">"green"</span>, <span class="RktVal">"yellow"</span>, и
 <span class="RktVal">"red"</span>. Такая программа может содержать такой фрагмент: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">current-color</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara"><span class="refelem"><span class="refcolumn"><span class="refcontent">Точки в определении текущего цвета, конечно, не являются частью программы. Замените их строкой, относящейся к цвету. </span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">next-color</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="hspace">&nbsp;</span><span class="RktSym">current-color</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Легко представить, что этот фрагмент имеет дело с вычислением, определяющим, какую лампочку нужно включить следующей, а какую выключить. </div>

<p></p>

<p>В следующих нескольких главах представлены более эффективные выражения, чем 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span>, для выражения условных вычислений и, что наиболее важно, систематические способы их разработки. </p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._arith-b2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;8. Добавьте следующую строку в область определений:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cat</span><span class="hspace">&nbsp;</span><img src="part_one_files/cat1.png" alt="" width="75" height="117"><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Создайте условное выражение, 
которое вычисляет, высокое или широкое изображение. Изображение должно быть помечено 
как <span class="RktVal">"tall"</span>(высокое), если его высота больше или 
равна ширине; в противном случае оно <span class="RktVal">"wide"</span>(широкое). 
См. <a href="#%28counter._%28exercise._arith-n%29%29" data-pltdoc="x">Упражнение&nbsp;1</a>, чтобы узнать, как создавать такие выражения в DrRacket; по мере того как вы экспериментируете,
замените кота прямоугольником по вашему выбору, чтобы убедиться, что вы знаете ожидаемый ответ. </div>

<p></p>

<p>Теперь попробуйте следующую модификацию. Создайте выражение, которое вычисляет, 
является ли изображение  <span class="RktVal">"tall"</span>(высоким), <span class="RktVal">"wide"</span>(широким) или
<span class="RktVal">"square"</span>(квадратным). <a href="#%28counter._%28exercise._arith-b2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>1.7<tt>&nbsp;</tt><a name="(part._sec~3apredicates)"></a>Предикаты: знай свои данные</h4>

<p></p>

<div class="SIntrapara">Вспомните выражение <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="stt"> </span><span class="RktVal">42</span><span class="RktPn">)</span> и его результат. На самом деле выражение не дает 
результата, оно сигнализирует об ошибке. 
DrRacket сообщает об ошибках с помощью красного текста в области взаимодействия 
и выделения ошибочного выражения (в области определений). 
Этот способ пометки ошибок особенно полезен, когда вы используете это выражение (или его родственников), глубоко вложенные в какое-то другое выражение:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Поэкспериментируйте с этим выражением, 
введя его как в область взаимодействий DrRacket, так и в область определений 
(а затем нажмите  <span class="emph">RUN</span>).</div>

<p></p>

<p></p>

<div class="SIntrapara">Конечно, на самом деле вы не хотите, чтобы в вашей программе были такие выражения, сигнализирующие об ошибках. И обычно вы не допускаете таких очевидных 
ошибок, как использование <span class="RktVal">42</span> в качестве строки. 
Однако довольно часто программы имеют 
дело с переменными, которые могут обозначать число или строку: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Переменная, такая как <span class="RktSym">in</span>, может быть наполнена любым значением, включая число, и это значение затем отображается в выражении <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span>. </div>

<p></p>

<p></p>

<div class="SIntrapara">Один из способов предотвратить такие случайности - использовать <span style="font-style: italic">predicate</span>(предикат), который представляет собой функцию,
которая принимает значение и определяет, принадлежит ли оно какому-либо классу данных.
Например, предикат <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span> определяет, является ли данное 
значение числом или нет: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"fortytwo"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как видите, 
предикаты производят логические значения. Следовательно, когда предикаты комбинируются
с условными выражениями, программы могут защитить выражения от неправильного 
использования: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>Каждый класс данных, который мы представили в этой главе, имеет предикат. 
Поэкспериментируйте с <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span>, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span>,
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._image~3f%29%29" class="RktValLink" data-pltdoc="x">image?</a></span> и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span> чтобы убедиться, что вы понимаете, как они работают. </p>

<p></p>

<div class="SIntrapara">В дополнение к предикатам, которые различают разные формы данных,
языки программирования также имеют предикаты, которые различают разные типы чисел.
В BSL числа классифицируются двумя способами: по построению(конструкции) и по точности.
Конструкция относится к знакомым наборам чисел: <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._integer~3f%29%29" class="RktValLink" data-pltdoc="x">integer?</a></span>, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._rational~3f%29%29" class="RktValLink" data-pltdoc="x">rational?</a></span>, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._real~3f%29%29" class="RktValLink" data-pltdoc="x">real?</a></span> и
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._complex~3f%29%29" class="RktValLink" data-pltdoc="x">complex?</a></span>,
<span class="refelem"><span class="refcolumn"><span class="refcontent">Поместите <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqrt%29%29" class="RktValLink" data-pltdoc="x">sqrt</a></span><span class="stt"> </span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span> 
в подсказку в области взаимодействия и нажмите клавишу “enter”. 
Внимательно посмотрите на результат. В результате вы видите первое так называемое 
комплексное число, с которым сталкивается каждый. Хотя ваш учитель мог сказать вам, 
что нельзя вычислять квадратный корень из отрицательных чисел, правда в том, 
что математики и некоторые программисты считают это приемлемым и полезным 
в любом случае. Но не волнуйтесь: понимание комплексных чисел не обязательно 
для разработчика программ. </span></span></span>
но многие языки программирования, включая BSL, также предпочитают использовать 
конечные приближения к хорошо известным константам, что приводит к несколько 
неожиданным результатам с предикатом
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._rational~3f%29%29" class="RktValLink" data-pltdoc="x">rational?</a></span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._rational~3f%29%29" class="RktValLink" data-pltdoc="x">rational?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Что касается точности, 
то мы уже упоминали об этой идее. А пока поэкспериментируйте с <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._exact~3f%29%29" class="RktValLink" data-pltdoc="x">exact?</a></span>(точно)  и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._inexact~3f%29%29" class="RktValLink" data-pltdoc="x">inexact?</a></span>(не точно) чтобы убедиться, что они выполняют проверки, о которых говорят их имена. 
Позже мы собираемся обсудить природу чисел более подробно. </div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._arith-p1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;9. Добавьте следующую строку в область определений DrRacket: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Затем создайте выражение, которое преобразует значение <span class="RktSym">in</span> в неотрицательное число. Для <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>(строки) оно определяет, какова длина <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>; для <a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a>(изображения) используется площадь; для <a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>(числа) используется абсолютное значение; для 
<span class="RktVal">#true</span> оно использует  <span class="RktVal">10</span>, а для <span class="RktVal">#false</span> <span class="RktVal">20</span>. 
<span style="font-weight: bold">Подсказка</span>  Прочтите про <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> из 
<a href="part_prologue.html" data-pltdoc="x">Пролога: Как программировать</a> (снова). </div>

<p></p>

<p>См. <a href="#%28counter._%28exercise._arith-n%29%29" data-pltdoc="x">Упражнение&nbsp;1</a>
чтобы узнать, как создавать выражения в DrRacket. <a href="#%28counter._%28exercise._arith-p1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._arith-p2))"></a><span style="font-weight: bold">Упражнение </span>&nbsp;10. Теперь расслабьтесь, поешьте, поспите и переходите к следующей главе.  <a href="#%28counter._%28exercise._arith-p2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h3>2<tt>&nbsp;</tt><a name="(part._ch~3afuncs-progs)"></a>Функции и программы</h3>

<p>Что касается программирования, “арифметика“ - это половина дела; 
другая половина - “алгебра“. Конечно, “алгебра“ относится к школьному 
понятию алгебры так же мало/сильно, как понятие “арифметика“ из предыдущей главы 
относится к арифметике, которой обучают в арифметике в начальной школе. 
В частности, необходимые понятия алгебры включают переменную, определение функции, 
применение функции и композицию функции. Эта глава вновь знакомит вас с этими 
понятиями в увлекательной и доступной форме. </p>

<h4>2.1<tt>&nbsp;</tt><a name="(part._sec~3afuncs)"></a>Функции</h4>

<p>Программы - это функции. Как и функции, программы потребляют(используют) 
входные данные и производят выходные данные. В отличие от функций, которые вы, 
возможно, знаете, программы работают с различными данными: числами, строками, 
изображениями, их смесями и т. Д. Более того, программы запускаются событиями 
в реальном мире, и результаты программ влияют на реальный мир. Например, программа 
для работы с электронными таблицами может реагировать на нажатия клавиш бухгалтера, 
заполняя некоторые ячейки числами, или программа-календарь на компьютере может запускать программу ежемесячного расчета заработной платы в последний день каждого месяца. 
Наконец, программа не может использовать все свои входные данные сразу, вместо этого 
она может решить обрабатывать данные поэтапно. </p>

<p><span style="font-weight: bold">Определения</span> Хотя многие языки 
программирования скрывают связь между программами и функциями, BSL выдвигает 
ее на первый план. Каждая программа BSL состоит из нескольких определений, 
за которыми обычно следует выражение, включающее эти определения. 
Есть два вида определений: </p>

<ul><li>

<p><span style="font-style: italic">определения констант</span>, формы <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktVar">Variable</span><span class="stt"> </span><span class="RktVar">Expression</span><span class="RktPn">)</span>, с которыми мы столкнулись в предыдущей главе; а также</p>

</li><li>

<p><a name="(idx._(gentag._11))"></a><span style="font-style: italic">определения функций</span>, которые бывают разных видов, одино из которых мы использовали в Прологе .</p>

</li></ul>

<p></p>

<div class="SIntrapara">Как и выражения, <a name="(idx._(gentag._12))"></a>определения функций в BSL имеют единообразную форму:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">FunctionName</span><span class="hspace">&nbsp;</span><span class="RktVar">Variable</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVar">Variable</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">Expression</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">То есть для определения функции записываем 
</div><div class="SIntrapara"><ul><li>

<p>“<span class="RktInBG"><span class="hspace"></span><span class="RktIn">(</span><span class="hspace"></span></span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="RktMeta"></span> <span class="RktInBG"><span class="hspace"></span><span class="RktIn">(</span><span class="hspace"></span></span>”,</p>

</li><li>

<p>имя функции,</p>

</li><li>

<p>за которым следуют несколько переменных, разделенных пробелом и оканчивающихся на “<span class="RktInBG"><span class="hspace"></span><span class="RktIn">)</span><span class="hspace"></span></span>”,</p>

</li><li>

<p>и выражения, за которым следует  “<span class="RktInBG"><span class="hspace"></span><span class="RktIn">)</span><span class="hspace"></span></span>”.</p>

</li></ul></div><div class="SIntrapara">Вот и все. Вот несколько небольших примеров:
</div><div class="SIntrapara"><ul><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">g</span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">h</span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">y</span><span class="stt"> </span><span class="RktSym">z</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</li></ul></div>

<p></p>

<p>Прежде чем мы объясним, почему эти примеры глупые, нам нужно объяснить, 
что означают определения функций. Грубо говоря, определение функции вводит 
новую операцию с данными; Другими словами, оно добавляет операцию в наш словарь, 
если мы думаем о примитивных операциях как о тех, которые всегда доступны. 
Как и примитивная функция, функция определенная использует входные данные. 
Количество переменных определяет, сколько входов - также называемых 
<span style="font-style: italic">аргументами</span> или 
<span style="font-style: italic">параметрами</span> - потребляемые(принимаемые)
функцией. Таким образом, <span class="RktSym">f</span> - это функция с одним аргументом, иногда называемая <span style="font-style: italic">unary</span>(унарной) функцией. 
Напротив, <span class="RktSym">g</span> - это функция с двумя аргументами, также называемая <span style="font-style: italic">binary</span>(бинарной), а <span class="RktSym">h</span> - это <span style="font-style: italic">ternary</span>(тройная) функция или функция с тремя аргументами. Выражение, часто называемое <span style="font-style: italic">телом функции</span>, определяет вывод. </p>

<p>Примеры глупые, потому что выражения внутри функций не включают переменные. 
Поскольку переменные относятся к входным параметрам, отсутствие упоминания их 
в выражениях означает, что выходные данные функции не зависят от их входных данных и,
следовательно, всегда одинаковы. Нам не нужно писать функции или программы, 
если результат всегда один и тот же. </p>

<p></p>

<div class="SIntrapara">Переменные - это не данные; они представляют данные. 
Например, определение константы, такое как
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">говорит, что <span class="RktSym">x</span>
всегда означает <span class="RktVal">3</span>. Переменные в <span style="font-style: italic">заголовке функции</span>, то есть переменные, следующие за именем функции, 
являются заполнителями для <span style="font-weight: bold">unknown</span>(неизвестных)
фрагментов данных, входов функции. Упоминание переменной в теле функции - это способ использовать эти фрагменты данных, когда функция применяется и значения переменных становятся известными. </div>

<p></p>

<p></p>

<div class="SIntrapara">Рассмотрим следующий фрагмент определения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Это заголовок функции - 
<span class="RktPn">(</span><span class="RktSym">ff</span><span class="stt"> </span><span class="RktSym">a</span><span class="RktPn">)</span>, он означает, что <span class="RktSym">ff</span> потребляет/использует одну частичку ввода, а переменная 
<span class="RktSym">a</span> является заполнителем для этой частицы ввода. 
Конечно, в то время, когда мы определяем функцию, мы не знаем, какими будут ее входы. 
В самом деле, весь смысл определения функции состоит в том, что мы можем использовать 
функцию много раз для множества различных входных данных. </div>

<p></p>

<p></p>

<div class="SIntrapara">Полезные тела функций ссылаются на параметры функции. 
Ссылка на параметр функции на самом деле является ссылкой на фрагмент данных, 
который является входом для функции. Если мы завершим определение 
<span class="RktSym">ff</span> следующим образом 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">мы тем самым скажем, что вывод функции в десять раз больше ее ввода. 
Предположительно эта функция будет снабжаться числами в качестве входных данных, 
потому что нет смысла умножать изображения, логические значения или строки на 
 <span class="RktVal">10</span>.</div>

<p></p>

<p>На данный момент единственный оставшийся вопрос - как функция получает 
свои входные данные. С этой целью мы обратимся к понятию применения(applying) 
функции. </p>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">Применения</span> 
<span style="font-style: italic">Применение функции</span> заставляет <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span>(определенные) функции работать, и оно выглядит так же, как применение заранее 
определенной операции:
</div><div class="SIntrapara"><ul><li>

<p>запишите “(”,</p>

</li><li>

<p>запишите имя определяемой функции <span class="RktSym">f</span>,</p>

</li><li>

<p>запишите столько аргументов, сколько потребляет <span class="RktSym">f</span>, через пробел,</p>

</li><li>

<p>и добвьте в конце “)”.</p>

</li></ul></div>

<p></p>

<p></p>

<div class="SIntrapara">После этого небольшого объяснения вы можете теперь 
экспериментировать с функциями в области взаимодействий, как мы предлагали вам
поэкспериментировать с примитивами, чтобы выяснить, что они вычисляют. 
Например, следующие три эксперимента подтверждают, что <span class="RktSym">f</span>
из приведенного выше значения дает одно и то же значение независимо от того, к какому входу она применяется: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">1</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">"hello world"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">1</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">1</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Что дает <span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="stt"> </span><span class="RktVal">3</span><span class="stt"> </span><span class="RktVal">"solid"</span><span class="stt"> </span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span>
<span class="refelem"><span class="refcolumn"><span class="refcontent">Не забудьте добавить <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktSym">2htdp/image</span><span class="RktPn">)</span> в область определений. </span></span></span></div>

<p></p>

<p></p>

<div class="SIntrapara">Видите ли, даже изображения в качестве входных данных не меняют поведения <span class="RktSym">f</span>. Но вот что происходит, когда функция применяется к слишком малому или слишком большому количеству аргументов: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">f:expects 1 argument, found none</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">f:expects only 1 argument, found 5</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">DrRacket сигнализирует об ошибке, которая похожа на те, которые вы видите, когда применяете примитив к неправильному количеству аргументов: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">+:expects at least 2 arguments, found none</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Функции не нужно применять в подсказке в области взаимодействия. Совершенно приемлемо использовать
применения функции, вложенные в другие применения функции: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">32</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">1280</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">100</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

<p><a name="(counter._(exercise._fun0))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;11. Определите функцию, которая использует два числа, <span style="font-style: italic">x</span> и
<span style="font-style: italic">y</span>, и вычисляет расстояние от точки <span style="font-style: italic"></span>(<span style="font-style: italic">x,y</span>)<span style="font-style: italic"></span> до начала координат. </p>

<p>В <a href="#%28counter._%28exercise._arith-n%29%29" data-pltdoc="x">упражнении&nbsp;1</a>
вы разработали правую часть этой функции для конкретных значений 
<span style="font-style: italic">x</span> и <span style="font-style: italic">y</span>.
 Теперь добавьте заголовок.  <a href="#%28counter._%28exercise._fun0%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun1))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;12. Определите функцию <span class="RktSym">cvolume</span>, 
которая принимает длину стороны равностороннего куба и вычисляет его объем. 
Если у вас есть время, подумайте также об определении <span class="RktSym">csurface</span>.</p>

<p><span style="font-weight: bold">Совет</span>. Равносторонний куб - 
это трехмерный контейнер, ограниченный шестью квадратами. 
Вы можете определить поверхность(surface) куба, если знаете, 
что площадь квадрата равна его длине, умноженной на себя. 
Его объем - это длина, умноженная на площадь одного из его квадратов. (Почему?)  
<a href="#%28counter._%28exercise._fun1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun2))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;13. Определите функцию <span class="RktSym">string-first</span>,
 которая извлекает первую <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a> из 
<span style="font-weight: bold">непустой/span> строки.  
<a href="#%28counter._%28exercise._fun2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun3))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;14. Определите функцию <span class="RktSym">string-last</span>, которая извлекает
последнюю строку <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a> из непустой строки.  
<a href="#%28counter._%28exercise._fun3%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun4))"></a><span style="font-weight: bold">Упражнение 
</span>&nbsp;15. Определите <span class="RktSym">==&gt;</span>. Функция использует два логических значения, назовите их <span class="RktSym">sunny</span> и <span class="RktSym">friday</span>. Её ответ - <span class="RktVal">#true</span>, 
если <span class="RktSym">sunny</span>(солнечно) - ложно или <span class="RktSym">friday</span>(пятница) - истинно. 
<span style="font-weight: bold">Примечание</span>. Логики называют эту логическую операцию <span style="font-style: italic">implication</span>(импликацией), и для этой цели они используют обозначение <span style="font-style: italic">sunny =&gt; friday</span>.
 <a href="#%28counter._%28exercise._fun4%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun5))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;16. Определите функцию i<span class="RktSym">image-area</span>, 
которая подсчитывает количество пикселей в данном изображении. См. Идеи в 
<a href="#%28counter._%28exercise._arith-i1%29%29" data-pltdoc="x">упражнении &nbsp;6</a>. 
<a href="#%28counter._%28exercise._fun5%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun10))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;17. Определите функцию <span class="RktSym">image-classify</span>, которая потребляет(принимает) изображение и условно производит <span class="RktVal">"tall"</span>(высокое), если высота изображения больше ширины, <span class="RktVal">"wide"</span>(широкое), если оно больше широкое, чем высокое, или <span class="RktVal">"square"</span>(квадратное), если его ширина и высота совпадают. . См. Идеи в <a href="#%28counter._%28exercise._arith-b2%29%29" data-pltdoc="x">упражнении&nbsp;8</a>  <a href="#%28counter._%28exercise._fun10%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun10a))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;18. Определите функцию <span class="RktSym">string-join</span>, 
которая использует две строки и складывает их используя символьный знак 
<span class="RktVal">"_"</span> между ними. Идеи см. В <a href="#%28counter._%28exercise._arith-s0%29%29" data-pltdoc="x">упражнении&nbsp;2</a> <a href="#%28counter._%28exercise._fun10a%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun10b))"></a><span style="font-weight: bold">Упражнение </span>&nbsp;19. Определите функцию <span class="RktSym">string-insert</span>, 
которая использует строку <span class="RktSym">str</span> плюс число 
<span class="RktSym">i</span> и вставляет <span class="RktVal">"_"</span> в 
<span style="font-style: italic">i</span>-ю позицию строки <span class="RktSym">str</span>.
 Предположим, что <span class="RktSym">i</span> - это число от <span class="RktVal">0</span>
 до длины данной строки (включительно). См. Идеи в <a href="#%28counter._%28exercise._arith-s1%29%29" data-pltdoc="x">упражненииnbsp;3</a>. 
Подумайте, как <span class="RktSym">string-insert</span> справляется с <span class="RktVal">""</span>. 
 <a href="#%28counter._%28exercise._fun10b%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun10c))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;20. Определите функцию <span class="RktSym">string-delete</span>, 
которая использует строку и число <span class="RktSym">i</span> и удаляет 
<span style="font-style: italic">i</span>-ю позицию из <span class="RktSym">str</span>.
Предположим, что <span class="RktSym">i</span> - это число от <span class="RktVal">0</span>
(включительно) до длины данной строки (исключая). 
Идеи см. В <a href="#%28counter._%28exercise._arith-s2%29%29" data-pltdoc="x">упражнении&nbsp;4</a>. 
Может ли <span class="RktSym">string-delete</span> работать с пустыми строками? 
 <a href="#%28counter._%28exercise._fun10c%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>2.2<tt>&nbsp;</tt><a name="(part._sec~3acomputing)"></a>Вычисление</h4>

<p>Определения функций и применения  работают в тандеме. Если вы хотите разрабатывать 
программы, вы должны понимать это сотрудничество, потому что вам нужно представить, 
как DrRacket запускает ваши программы, и потому, что вам нужно выяснить, 
<span style="font-weight: bold">что</span> идет не так, 
<span style="font-weight: bold">когда</span> что-то идет не так, 
а что-то <span style="font-weight: bold">будет</span> не так.</p>

<p>Хотя вы, возможно, видели эту идею в курсе алгебры, мы предпочитаем объяснять 
ее по-своему. Итак, поехали. Выполнение(Оценка) применения функции происходит в 
три этапа: DrRacket определяет значения выражений аргументов; он проверяет, 
что количество аргументов и количество параметров функции одинаковы; 
в этом случае DrRacket вычисляет значение тела функции, при этом все параметры 
заменяются соответствующими значениями аргументов. Последнее значение является 
значением применения функции. Это непросто, поэтому нам нужны примеры. </p>

<p></p>

<div class="SIntrapara">Вот пример расчета <span class="RktSym">f</span> из предыдущего раздела: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> knows that </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">2</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> replaced all occurrences of </span><span class="RktSym">x</span><span class="RktCmt"> with </span><span class="RktVal">2</span></td></tr><tr><td><span class="RktVal">1</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Последнее уравнение странно, потому что  <span class="RktSym">x</span> не встречается в теле <span class="RktSym">f</span>. Следовательно, замена вхождения 
<span class="RktSym">x</span> на <span class="RktVal">2</span> в теле функции дает 
<span class="RktVal">1</span>, которое является самим телом функции. </div>

<p></p>

<p></p>

<div class="SIntrapara">For <span class="RktSym">ff</span>, Для <span class="RktSym">ff</span>
DrRacket выполняет другой вид вычислений: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> again knows that </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">2</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> replaces </span><span class="RktSym">a</span><span class="RktCmt"> with </span><span class="RktVal">2</span><span class="RktCmt"> in </span><span class="RktSym">ff</span><span class="RktCmt">'</span><span class="RktCmt">s body</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">and from here, </span><span class="RktCmt">DrRacket</span><span class="RktCmt"> uses plain arithmetic </span></td></tr><tr><td><span class="RktVal">20</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Лучше всего то, что когда вы объединяете эти законы 
вычислений с законами арифметики, вы можете в значительной степени предсказать 
результат любой программы в BSL:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> knows that </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">3</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> replaces </span><span class="RktSym">a</span><span class="RktCmt"> with </span><span class="RktVal">3</span><span class="RktCmt"> in </span><span class="RktSym">ff</span><span class="RktCmt">'</span><span class="RktCmt">s body</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">now </span><span class="RktCmt">DrRacket</span><span class="RktCmt"> uses the laws of arithmetic </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">32</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Естественно, мы можем повторно использовать результат 
этого вычисления в других: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> substitutes </span><span class="RktVal">4</span><span class="RktCmt"> for </span><span class="RktSym">a</span><span class="RktCmt"> in </span><span class="RktSym">ff</span><span class="RktCmt">'</span><span class="RktCmt">s body</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> knows that </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">4</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">==</span><span class="stt"> </span><span class="RktVal">40</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">now it uses the result of the above calculation</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">1280</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">because it is really just math </span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>В общем, DrRacket невероятно быстро изучает алгебру; 
он знает все законы арифметики и отлично справляется с заменой(подстановкой). 
Более того, DrRacket не может только определять значение выражения; 
он также может показать вам, <span style="font-weight: bold">как/span> это происходит. 
То есть он может шаг за шагом показать вам, как решить эти алгебраические задачи, 
которые просят вас определить значение выражения.</p>

<p>Еще раз взгляните на кнопки DrRacket. Одна из них выглядит как кнопка 
“advance to next track”(перейти к следующей дорожке) на аудиоплеере. 
Если вы нажмете эту кнопку, появится <span style="font-weight: bold">stepper</span>
окно(пошагового исполнения программы), в котором вы сможете выполнить 
пошагово вычисление программы из области определений. </p>

<p>Введите определение <span class="RktSym">ff</span> в область определений. 
Добавьте ниже <span class="RktPn">(</span><span class="RktSym">ff</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span>. 
Теперь нажмите <span class="emph">STEP</span>(ШАГ). 
Появится окно пошагового исполнения; На  <a href="#%28counter._%28figure._fig~3astepper%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">11</span></a> показано, 
как это выглядит в версии 6.2 программного обеспечения. 
На этом этапе вы можете использовать стрелки вперед и назад, 
чтобы увидеть все этапы вычислений, которые DrRacket использует 
для определения значения выражения. Посмотрите, как шаговый исполнитель выполняет те же вычисления, что и мы. </p>

<p>Стойте! Да, вы могли бы использовать DrRacket, чтобы решить домашнее 
задание по алгебре. Поэкспериментируйте с различными вариантами, 
которые предлагает stepper(пошаговый исполнитель).</p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3astepper))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside">

<p><img src="part_one_files/dd-stepper.png" alt="" width="363" height="125"></p>

</blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;11: </span>DrRacket пошаговый исполнитель(stepper)</span></p>

</blockquote>

<p><a name="(counter._(exercise._ex~3astepper1))"></a><span style="font-weight: bold">Упражнение </span>&nbsp;21. Используйте степпер DrRacket для пошагового выполнения 
<span class="RktPn">(</span><span class="RktSym">ff</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span>. 
Также попробуйте <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">ff</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span>. 
Использует ли пошаговый исполнитель DrRacket результаты вычислений повторно? 
<a href="#%28counter._%28exercise._ex~3astepper1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>В этот момент вы можете подумать, что снова изучаете курс алгебры со всеми 
этими вычислениями, включающими неинтересные функции и числа. К счастью, этот подход распространяется на <span style="font-weight: bold">все</span> программы в этой книге, 
в том числе и на самые интересные.</p>

<p></p>

<div class="SIntrapara">Начнем с рассмотрения функций, обрабатывающих строки. 
Напомним некоторые законы строковой арифметики: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"hello"</span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="hspace">&nbsp;</span><span class="RktVal">"world"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktVal">"hello world"</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"bye"</span><span class="hspace">&nbsp;</span><span class="RktVal">", "</span><span class="hspace">&nbsp;</span><span class="RktVal">"world"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktVal">"bye, world"</span></td></tr><tr><td><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь предположим, что мы определяем функцию, которая создает начало письма:  <a name="(idx._(gentag._13))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">opening</span><span class="hspace">&nbsp;</span><span class="RktSym">first-name</span><span class="hspace">&nbsp;</span><span class="RktSym">last-name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Dear "</span><span class="hspace">&nbsp;</span><span class="RktSym">first-name</span><span class="hspace">&nbsp;</span><span class="RktVal">","</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Когда вы применяете эту функцию к двум строкам, вы получаете начало письма: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">opening</span><span class="hspace">&nbsp;</span><span class="RktVal">"Matthew"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Fisler"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"Dear Matthew,"</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Что еще более важно, 
законы вычислений объясняют, как DrRacket определяет этот результат и как можно определить, 
что делает DrRacket: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">opening</span><span class="hspace">&nbsp;</span><span class="RktVal">"Matthew"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Fisler"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> substitutes </span><span class="RktVal">"Matthew"</span><span class="RktCmt"> for </span><span class="RktSym">first-name</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Dear "</span><span class="hspace">&nbsp;</span><span class="RktVal">"Matthew"</span><span class="hspace">&nbsp;</span><span class="RktVal">","</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">"Dear Matthew,"</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Поскольку <span class="RktSym">last-name</span>(фамилия)
не встречается в определении <span class="RktSym">opening</span>(начала письма), 
замена ее на <span class="RktVal">"Fisler"</span> не имеет никакого эффекта. </div>

<p></p>

<p>Остальная часть книги вводит больше форм данных.
<span class="refelem"><span class="refcolumn"><span class="refcontent">В конце концов вы
столкнетесь с императивными операциями, которые не объединяют и не извлекают значения, 
а <span style="font-weight: bold">изменяют</span> их. 
Чтобы вычислить с помощью таких операций, вам нужно будет добавить некоторые законы к законам арифметики и подстановки.</span></span></span> Для объяснения операций с данными мы всегда пользуемся законами, подобными арифметическим в этой книге. </p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._dr-step0))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;22. Используйте степпер DrRacket на этом фрагменте программы:  <a name="(idx._(gentag._14))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-origin</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqrt%29%29" class="RktValLink" data-pltdoc="x">sqrt</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqr%29%29" class="RktValLink" data-pltdoc="x">sqr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqr%29%29" class="RktValLink" data-pltdoc="x">sqr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">distance-to-origin</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Соответствует ли объяснение вашей интуиции?  <a href="#%28counter._%28exercise._dr-step0%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._dr-step2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;23. Первая <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a> в <span class="RktVal">"hello world"</span>
- это <span class="RktVal">"h"</span>. Как следующая функция вычисляет этот результат?  <a name="(idx._(gentag._15))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-first</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._substring%29%29" class="RktValLink" data-pltdoc="x">substring</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Используйте степпер, чтобы подтвердить свои идеи. <a href="#%28counter._%28exercise._dr-step2%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._dr-step4))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;24. Вот определение <span class="RktSym">==&gt;</span>: <a name="(idx._(gentag._16))"></a>y
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">==&gt;</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Используйте пошаговый исполнитель(степпер), чтобы определить значение  <span class="RktPn">(</span><span class="RktSym">==&gt;</span><span class="stt"> </span><span class="RktVal">#true</span><span class="stt"> </span><span class="RktVal">#false</span><span class="RktPn">)</span>. <a href="#%28counter._%28exercise._dr-step4%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._dr-step10))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;25 Взгляните на эту попытку решить <a href="#%28counter._%28exercise._fun10%29%29" data-pltdoc="x">упражнение&nbsp;17</a>: <a name="(idx._(gentag._17))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">image-classify</span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"tall"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"square"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"wide"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Предлагает ли пошаговое выполнение приложения исправление? <a href="#%28counter._%28exercise._dr-step10%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._dr-step10b))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;26. Какое значение вы ожидаете от этой программы:  <a name="(idx._(gentag._18))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-insert</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._substring%29%29" class="RktValLink" data-pltdoc="x">substring</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"_"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._substring%29%29" class="RktValLink" data-pltdoc="x">substring</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">string-insert</span><span class="hspace">&nbsp;</span><span class="RktVal">"helloworld"</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Подтвердите свои ожидания с DrRacket и его пошаговым вычислителем.  <a href="#%28counter._%28exercise._dr-step10b%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<h4>2.3<tt>&nbsp;</tt><a name="(part._sec~3acomposing)"></a>Составные(Композиционные) функции</h4>

<p>Программа редко состоит из одного определения функции. 
Обычно программы состоят из определения <span style="font-style: italic">основной</span> 
и нескольких других функций, которые превращают результат одного применения функции 
во входные данные для другого. По аналогии с алгеброй мы называем этот способ определения 
функций <span style="font-style: italic">композицией</span> и называем эти 
дополнительные функции <span style="font-style: italic">вспомогательными функциями</span>
 или <span style="font-style: italic">функциями помощниками</span>. 
<a name="(idx._(gentag._19))"></a>
<a name="(idx._(gentag._20))"></a>
<a name="(idx._(gentag._21))"></a>
<a name="(idx._(gentag._22))"></a></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3aletter-template))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letter</span><span class="hspace">&nbsp;</span><span class="RktSym">fst</span><span class="hspace">&nbsp;</span><span class="RktSym">lst</span><span class="hspace">&nbsp;</span><span class="RktSym">signature-name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">opening</span><span class="hspace">&nbsp;</span><span class="RktSym">fst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"\n\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">fst</span><span class="hspace">&nbsp;</span><span class="RktSym">lst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"\n\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">closing</span><span class="hspace">&nbsp;</span><span class="RktSym">signature-name</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">opening</span><span class="hspace">&nbsp;</span><span class="RktSym">fst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"Dear "</span><span class="hspace">&nbsp;</span><span class="RktSym">fst</span><span class="hspace">&nbsp;</span><span class="RktVal">","</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">body</span><span class="hspace">&nbsp;</span><span class="RktSym">fst</span><span class="hspace">&nbsp;</span><span class="RktSym">lst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"We have discovered that all people with the"</span><span class="hspace">&nbsp;</span><span class="RktVal">"\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"last name "</span><span class="hspace">&nbsp;</span><span class="RktSym">lst</span><span class="hspace">&nbsp;</span><span class="RktVal">" have won our lottery. So, "</span><span class="hspace">&nbsp;</span><span class="RktVal">"\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">fst</span><span class="hspace">&nbsp;</span><span class="RktVal">", "</span><span class="hspace">&nbsp;</span><span class="RktVal">"hurry and pick up your prize."</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">closing</span><span class="hspace">&nbsp;</span><span class="RktSym">signature-name</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"Sincerely,"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"\n\n"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">signature-name</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"\n"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;12: </span> Пакетная программа</span></p>

</blockquote>

<p>Рассмотрим программу на <a href="#%28counter._%28figure._fig~3aletter-template%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">12</span></a> для заполнения 
шаблонов писем. Она состоит из четырех функций. Первая - это основная функция,
которая создает полное письмо, состоящее из имени и фамилии адресата, плюс подпись. 
Основная функция обращается к трем вспомогательным функциям для создания трех частей письма -
открытия(заголовка), тела и подписи - и объединяет результаты в правильном порядке с
помощью <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span>.</p>

<p></p>

<div class="SIntrapara">Стоп! Введите эти определения в область определений DrRacket, нажмите 
<span class="emph">RUN</span> и вычислите эти выражения в области взаимодействий:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">letter</span><span class="hspace">&nbsp;</span><span class="RktVal">"Matthew"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Fisler"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Felleisen"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"Dear Matthew,\n\nWe have discovered that ...\n"</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">letter</span><span class="hspace">&nbsp;</span><span class="RktVal">"Kathi"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Felleisen"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Findler"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"Dear Kathi,\n\nWe have discovered that ...\n"</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">Отклоняясь</span> 
Результатом является длинная строка, содержащая <span class="RktVal">"\n"</span>, 
знак представляющий новую строку при <span style="font-weight: bold">печати</span> строки. 
Теперь добавьте <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="stt"> </span><span class="RktSym">2htdp/batch-io</span><span class="RktPn">)</span> в вашу программу, 
что добавит функцию <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span> в общий репертуар доступных функций;
она позволяет <span style="font-weight: bold">вывести(напечатать)</span> эту строку на консоль:<span class="refelem"><span class="refcolumn"><span class="refcontent">Думайте пока о
<span class="RktVal">'</span><span class="RktVal">stdout</span> как о 
<a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>(строке).</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stdout</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letter</span><span class="hspace">&nbsp;</span><span class="RktVal">"Matt"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Fiss"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Fell"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tbody><tr><td>

<p><span class="RktOut">Dear Matt,</span></p>

</td></tr><tr><td>

<p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span></p>

</td></tr><tr><td>

<p><span class="RktOut">We have discovered that all people with the</span></p>

</td></tr><tr><td>

<p><span class="RktOut">last name Fiss have won our lottery. So, </span></p>

</td></tr><tr><td>

<p><span class="RktOut">Matt, hurry and pick up your prize.</span></p>

</td></tr><tr><td>

<p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span></p>

</td></tr><tr><td>

<p><span class="RktOut">Sincerely, </span></p>

</td></tr><tr><td>

<p><span class="RktOut"></span></p>

</td></tr><tr><td>

<p><span class="RktOut">Fell</span></p>

</td></tr></tbody></table></td></tr><tr><td>

<p><span class="RktRes">'stdout</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Раздел <a href="#%28part._sec~3aprogs%29" data-pltdoc="x">Программы</a> подробно объясняет 
такие пакетные программы. <span style="font-weight: bold">Конец</span></div>

<p></p>

<p>В общем, когда проблема относится к разным задачам вычислений, программа 
должна состоять из одной функции для каждой задачи и основной функции, 
которая объединяет все это вместе. 
Мы формулируем эту идею в виде простого слогана:</p>

<blockquote>

<p><span style="font-style: italic">Определите одну функцию для каждой задачи.</span></p>

</blockquote>

<p>Преимущество следования этому слогану состоит в том, что вы получаете 
достаточно небольшие функции, каждая из которых проста для понимания и 
состав которых легко понять. Когда вы научитесь разрабатывать функции, вы поймете, 
что заставить маленькие функции работать правильно, намного проще, чем сделать это 
с большими. Еще лучше, если вам когда-нибудь понадобится изменить часть программы 
из-за некоторого изменения в формулировке проблемы, как правило, гораздо проще найти
соответствующие части, когда она организована как набор небольших функций, 
а не большой, монолитный блок. </p>

<p>Вот небольшая иллюстрация этого момента на примере задачи: </p>

<p></p>

<div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример задачи</span> 
Владелец монопольного кинотеатра в маленьком городке имеет полную свободу устанавливать 
цены на билеты. Чем больше он берет, тем меньше людей могут позволить себе билеты. 
Чем меньше он берет, тем дороже обходится шоу, потому что посещаемость растет. 
В недавнем эксперименте владелец установил зависимость между ценой билета и 
средней посещаемостью. </p>

<p></p>

<div class="SIntrapara">При цене 5 долларов за билет на спектакль приходят 120 человек. 
На каждые 10 центов изменения стоимости билета средняя посещаемость меняется на 15 человек. 
То есть, если владелец взимает 5,10 доллара, в среднем приходит около 105 человек; 
если цена упадет до 4,90 доллара, средняя посещаемость увеличится до 135. 
Давайте переведем эту идею в математическую формулу: 
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img src="part_one_files/pict_33.png" alt="image" width="312" height="21"></p>

</blockquote></div><div class="SIntrapara">Стоп! Объясните знак минус, прежде чем продолжить.</div>

<p></p>

<p>К сожалению, увеличение посещаемости также обходится дороже. 
Каждое выступление обходится владельцу по фиксированной цене в 
размере 180 долларов плюс переменные затраты в размере 0,04 доллара на участника. </p>

<p>Владелец хотел бы знать точное соотношение между прибылью и ценой билета, 
чтобы максимизировать прибыль. </p>

</blockquote></div><div class="SIntrapara">Пока задача ясна, как ее решить - нет. 
Все, что мы можем сказать на данный момент, - это то, что несколько величин 
зависят друг от друга. </div>

<p></p>

<p></p>

<div class="SIntrapara">Когда мы сталкиваемся с такой ситуацией, 
лучше выявить различные зависимости, одну за другой: 
</div><div class="SIntrapara"><ol><li>

<p>В постановке задачи указано, как количество участников зависит от цены билета. 
Очевидно, что вычисление этого числа - отдельная задача и поэтому заслуживает 
отдельного определения функции:  <a name="(idx._(gentag._23))"></a></p>

<blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">attendees</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">120</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="hspace">&nbsp;</span><span class="RktVal">5.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">15</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></li><li>

<p><span style="font-style: italic">revenue</span>(Выручка) создается исключительно 
за счет продажи билетов, то есть это в точности произведение цены билета и 
количества участников:  <a name="(idx._(gentag._24))"></a></p>

<blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">revenue</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">attendees</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></li><li>

<p><span style="font-style: italic">cost</span>(Стоимость) состоит из двух частей: 
фиксированной части (180 долларов США) и переменной части, которая зависит от 
количества участников. Учитывая, что количество посетителей является функцией цены билета, 
функция для вычисления стоимости шоу должна также потреблять(использовать) цену билета, 
чтобы она могла повторно использовать функцию <span class="RktSym">attendees</span>:  
<a name="(idx._(gentag._25))"></a></p>

<blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cost</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">180</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.04</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">attendees</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></li><li>

<p>Наконец, <span style="font-style: italic">profit</span>(прибыль) - это разница 
между доходом и затратами при заданной цене билета:  
<a name="(idx._(gentag._26))"></a></p>

<blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">profit</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">revenue</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">cost</span><span class="hspace">&nbsp;</span><span class="RktSym">ticket-price</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote>

<p>BSL определение <span class="RktSym">profit</span>(прибыли) непосредственно 
следует за предложением неформального описания проблемы. </p>

</li></ol></div><div class="SIntrapara">Эти четыре функции - все, что нужно для 
вычисления прибыли(profit), и теперь мы можем использовать функцию profit для 
определения хорошей цены билета. </div>

<p></p>

<p><a name="(counter._(exercise._fun6-constant))"></a><span style="font-weight: bold">Упражнение </span>&nbsp;27. Наше решение примера задачи содержит несколько констант в середине функций. 
Как уже указывалось в  <a href="part_prologue.html#%28part._pro-many-def%29" data-pltdoc="x">One Program, Many Definitions(Одна программа, Много определений)</a>, лучше давать имена 
таким константам, чтобы будущие читатели понимали, откуда берутся эти числа. 
Соберите все определения в области определений DrRacket и измените их так, 
чтобы все магические числа были преобразованы в постоянные определения. 
 <a href="#%28counter._%28exercise._fun6-constant%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._fun6))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;28. Определите потенциальную прибыль для этих цен на билеты: 
1 доллар, 2 доллара, 3 доллара, 4 доллара и 5 долларов. 
Какая цена максимизирует прибыль кинотеатра? Определите лучшую цену билета до копейки.  
<a href="#%28counter._%28exercise._fun6%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Вот альтернативная версия той же программы, представленная как определение одной функции:  <a name="(idx._(gentag._27))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">profit</span><span class="hspace">&nbsp;</span><span class="RktSym">price</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">120</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">15</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">5.0</span><span class="hspace">&nbsp;</span><span class="RktSym">price</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">price</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">180</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.04</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">120</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">15</span><span class="hspace">&nbsp;</span><span class="RktVal">0.1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">5.0</span><span class="hspace">&nbsp;</span><span class="RktSym">price</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Введите это определение в DrRacket и убедитесь, 
что оно дает те же результаты, что и исходная версия для 1, 2, 3, 4 и 5 долларов. 
Одного взгляда должно хватить, чтобы показать, насколько сложнее понять эту функцию 
по сравнению с четырьмя вышеупомянутыми. </div>

<p></p>

<p><a name="(counter._(exercise._fun7))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;29. Изучив стоимость шоу, владелец обнаружил несколько способов снизить стоимость. 
В результате этих улучшений больше нет фиксированной стоимости; остаются переменные затраты в размере 1,50 доллара на участника.
</p>

<p>Измените обе программы, чтобы отразить это изменение. Когда программы будут изменены, протестируйте их еще раз с ценами на билеты 3, 4 и 5 долларов и сравните результаты.  
<a href="#%28counter._%28exercise._fun7%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>2.4<tt>&nbsp;</tt><a name="(part._sec~3aglobal)"></a>Глобальные константы</h4>

<p></p>

<div class="SIntrapara">Как уже сказано в Прологе, такие функции, 
как <span class="RktSym">profit</span>(прибыль), выигрывают от использования 
глобальных констант. Каждый язык программирования позволяет программистам определять константы. 
В BSL такое определение имеет следующую форму: 
</div><div class="SIntrapara"><ul><li>

<p>напишите “(<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span> ”,</p>

</li><li>

<p>ниже запишите имя,</p>

</li><li>

<p>с последующим пробелом и выражением, и </p>

</li><li>

<p>ниже запишите “)”.</p>

</li></ul></div><div class="SIntrapara">Имя константы - это <span style="font-style: italic">глобальная переменная</span>, а определение называется 
<span style="font-style: italic">определением константы</span>. 
Мы склонны называть выражение в определении константы <span style="font-style: italic">правой частью</span> определения. </div>

<p></p>

<p></p>

<div class="SIntrapara">В определениях констант вводятся имена для всех форм данных: чисел, изображений, строк и т. Д. Вот несколько простых примеров: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the current price of a movie ticket:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CURRENT-PRICE</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">useful to compute the area of a disk:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ALMOST-PI</span><span class="hspace">&nbsp;</span><span class="RktVal">3.14</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">a blank line:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">NL</span><span class="hspace">&nbsp;</span><span class="RktVal">"\n"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">an empty scene:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Первые две - числовые константы, последние две - строка и изображение. 
По соглашению мы используем прописные буквы для глобальных констант, потому что это гарантирует,
что независимо от размера программы читатели наших программ смогут легко отличить 
такие переменные от других. </div>

<p></p>

<p></p>

<div class="SIntrapara">Все функции в программе могут ссылаться на эти 
глобальные переменные. Ссылка на переменную аналогична использованию 
соответствующих констант. Преимущество использования имен переменных 
вместо констант заключается в том, что одно изменение определения константы 
влияет на все виды использования. Например, мы можем добавить цифры в 
<span class="RktSym">ALMOST-PI</span> или увеличить пустую сцену: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ALMOST-PI</span><span class="hspace">&nbsp;</span><span class="RktVal">3.14159</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">an empty scene:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;</span><span class="RktVal">800</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">В большинстве наших примеров определений в правой части 
используются <span style="font-style: italic">литеральные константы</span>, 
но в последнем используется выражение. И действительно, программист может использовать
произвольные выражения для вычисления констант. Предположим, программе нужно иметь 
дело с изображением некоторого размера и его центром: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MID-WIDTH</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MID-HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Она может использовать два определения с литеральными 
константами в правой части и двумя <span style="font-style: italic">вычисляемыми 
константами</span>, то есть переменные, значения которых являются не просто литеральными
константами, но результатами вычисления значения выражения. </div>

<p></p>

<p>Опять же, мы заявляем императивный лозунг:</p>

<blockquote>

<p><span style="font-style: italic">Для каждой константы, упомянутой в формулировке задачи,
введите одно определение константы. </span></p>

</blockquote>

<p><a name="(counter._(exercise._constant1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;30. Определите константы для программы оптимизации цен в кинотеатре, 
чтобы ценовая чувствительность посещаемости (15 человек на каждые 10 центов) 
стала вычисляемой константой. 
 <a href="#%28counter._%28exercise._constant1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>2.5<tt>&nbsp;</tt><a name="(part._sec~3aprogs)"></a>Программы</h4>

<p></p>

<div class="SIntrapara">Вы готовы создавать простые программы. 
С точки зрения кодирования программа - это просто набор определений
функций и констант. Обычно одна функция выделяется как “main”(основная), 
и эта основная функция имеет тенденцию составлять другие. 
Однако с точки зрения запуска программы есть два различных вида: 
</div><div class="SIntrapara"><ul><li>

<p><a name="(idx._(gentag._28))"></a><span style="font-style: italic">пакетная программа
</span> потребляет все свои входные данные сразу и вычисляет свой результат. 
Её основная функция - это композиция вспомогательных функций, которые могут 
относиться к дополнительным вспомогательным функциям и так далее. 
Когда мы запускаем пакетную программу, операционная система вызывает 
основную функцию на своих входах и ожидает вывода программы. </p>

</li><li>

<p><a name="(idx._(gentag._29))"></a><span style="font-style: italic">интерактивная программа
</span> потребляет некоторые из своих входных данных, вычисляет, производит некоторые 
выходные данные, потребляет больше входных данных и так далее. 
Когда появляется ввод, мы говорим о <span style="font-style: italic">событии(event)</span> 
и создаем интерактивные программы как программы, <span style="font-style: italic">управляемые событиями</span>(event-driven). Основная функция такой программы, управляемой событиями,
использует выражение, чтобы описать, какие функции вызывать для каких типов событий. Эти функции называются <span style="font-style: italic">обработчиками событий
(event handlers)</span>.</p>

<p>Когда мы запускаем интерактивную программу, функция main сообщает 
об этом описании операционной системе. Как только происходят события ввода, 
операционная система вызывает соответствующий обработчик событий. 
Точно так же операционная система знает из описания, когда и как представлять 
результаты этих вызовов функций в качестве выходных данных. </p>

</li></ul></div><div class="SIntrapara">В этой книге основное внимание уделяется программам,
которые взаимодействуют через <span style="font-style: italic">графический пользовательский интерфейс (GUI)</span>; существуют и другие виды интерактивных программ, 
и вы узнаете о них, продолжая изучать информатику. </div>

<p></p>

<p><span style="font-weight: bold">Пакетные программы</span> Как уже упоминалось, 
пакетная программа потребляет(использует) все свои входные данные сразу и 
вычисляет результат на основе этих входных данных. Её основная функция ожидает 
некоторые аргументы, передает их вспомогательным функциям, получает результаты 
от них и объединяет эти результаты в свой собственный окончательный ответ. </p>

<p>Как только программы созданы, мы хотим их использовать. В DrRacket мы 
запускаем пакетные программы в области взаимодействия, чтобы мы могли 
наблюдать за работой программы. </p>

<p>Программы даже более полезны, если они могут извлекать входные данные 
из одного файла и передавать выходные данные в другой файл. В самом деле, 
название “пакетная программа“ восходит к ранним дням развития вычислительной техники, 
когда программа считывала файл (или несколько файлов) из партии перфокарт и 
помещала результат в какой-то другой файл(ы), также как и партию карт. 
По идее, пакетная программа считывает входной файл(ы) сразу, а также сразу
создает  файл(ы) результатов. </p>

<p></p>

<div class="SIntrapara">Мы создаем такие пакетные программы на основе файлов с помощью 
библиотеки <span class="sroman"> <span class="Smaller"><span style="font-style: italic">
2htdp/batch-io</span></span></span>, которая добавляет в наш словарь две функции (среди прочего): 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span>, которая считывает содержимое всего файла как строку, и</p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span>, которая создает файл из заданной строки.</p>

</li></ul></div><div class="SIntrapara">Эти функции<span class="refelem"><span class="refcolumn"><span class="refcontent">Прежде чем вычислять эти выражения, 
сохраните область определений в файл.</span></span></span>  
записывают строки в файлы и читают из них строки:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"sample.dat"</span><span class="hspace">&nbsp;</span><span class="RktVal">"212"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"sample.dat"</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"sample.dat"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"212"</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">После первого взаимодействия файл с именем 
<span class="RktVal">"sample.dat"</span> содержит
</div><div class="SIntrapara"><table class="SVerbatim" cellspacing="0" cellpadding="0"><tbody><tr><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">212</span></p>

</td></tr></tbody></table></div><div class="SIntrapara">Результатом 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span> является подтверждение того, что строка была 
помещена в файл. Если файл уже существует, она заменяет его содержимое заданной 
строкой; в противном случае она создает файл и делает данную строку своим содержимым. 
Второе взаимодействие <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="stt"> </span><span class="RktVal">"sample.dat"</span><span class="RktPn">)</span> производит <span class="RktVal">"212"</span>, 
потому что оно превращает содержимое <span class="RktVal">"sample.dat"</span> в   
<a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String(строку)</span></a>.</div>

<p></p>

<p></p>

<div class="SIntrapara">По прагматическим соображениям 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span> также принимает в качестве первого аргумента 
<span class="RktVal">'</span><span class="RktVal">stdout</span>, особый вид токена. 
Затем он отображает результирующее содержимое файла в области текущего взаимодействия, например:<span class="refelem"><span class="refcolumn"><span class="refcontent">Имена 
<span class="RktVal">'</span><span class="RktVal">stdout</span> и 
<span class="RktVal">'</span><span class="RktVal">stdin</span> являются сокращениями 
для стандартного устройства вывода и стандартного устройства ввода соответственно.
</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stdout</span><span class="hspace">&nbsp;</span><span class="RktVal">"212\n"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktOut">212</span></p>

</td></tr><tr><td>

<p><span class="RktRes">'stdout</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">По аналогии, 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span> принимает <span class="RktVal">'</span><span class="RktVal">stdin</span> вместо имени файла, а затем считывает ввод из области текущего взаимодействия. </div>

<p></p>

<p>Давайте проиллюстрируем создание пакетной программы на простом примере. 
Предположим, мы хотим создать программу, которая преобразует температуру, 
измеренную на градуснике Фаренгейта, в температуру Цельсия. 
Не волнуйтесь, этот вопрос не является проверкой ваших знаний по физике; 
вот формула преобразования: :<span class="refelem"><span class="refcolumn"><span class="refcontent">Эта книга не о запоминании фактов, но мы надеемся, что вы знаете, 
где их найти. Вы знаете, где узнать, как конвертируются температуры? 
</span></span></span></p>

<blockquote class="SCentered">

<p><img src="part_one_files/pict_34.png" alt="image" width="87" height="15"></p>

</blockquote>

<p>Естественно, в этой формуле <span style="font-style: italic">f</span> - температура 
по Фаренгейту, а <span style="font-style: italic">C</span> - температура по Цельсию. 
Хотя этой формулы может быть достаточно для учебника предалгебры, математик или 
программист должен написать <span style="font-style: italic">C</span>(<span style="font-style: italic">f</span>)<span style="font-style: italic"></span> в левой части уравнения, 
чтобы напомнить читателям, что <span style="font-style: italic">f</span> - заданное значение, 
а <span style="font-style: italic">C</span> вычисляется из  
<span style="font-style: italic">f</span>.</p>

<p></p>

<div class="SIntrapara">Перевод этой формулы в BSL несложен:  <a name="(idx._(gentag._30))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">C</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5/9</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Напомним, что <span class="RktVal">5/9</span> - это число, 
точнее рациональная дробь, и что <span style="font-style: italic">C</span> зависит 
от заданного <span style="font-style: italic">f</span>, что и выражает обозначение функции. </div>

<p></p>

<p></p>

<div class="SIntrapara">Запуск этой пакетной программы в области взаимодействий работает как обычно:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">C</span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">0</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">C</span><span class="hspace">&nbsp;</span><span class="RktVal">212</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">100</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">C</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-4</span>0</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">-40</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Но предположим, 
что мы хотим использовать эту функцию как часть программы, которая считывает температуру 
по Фаренгейту из файла, преобразует это число в температуру Цельсия, а затем создает 
другой файл, содержащий результат. </div>

<p></p>

<p></p>

<div class="SIntrapara">Когда у нас есть формула преобразования в BSL, создание 
main(основной) функции означает составление <span class="RktSym">C</span> с 
существующими примитивными функциями:  <a name="(idx._(gentag._31))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">convert</span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="hspace">&nbsp;</span><span class="RktSym">out</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span><span class="hspace">&nbsp;</span><span class="RktSym">out</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number-~3estring%29%29" class="RktValLink" data-pltdoc="x">number-&gt;string</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">C</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"\n"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Мы назовем основную функцию <span class="RktSym">convert</span>. 
Она использует два имени файла: <span class="RktSym">in</span> для файла, в котором находится
температура по Фаренгейту, и <span class="RktSym">out</span> для того, где мы хотим получить
результат по Цельсию. Композиция пяти функций вычисляет результат convert. 
Давайте внимательно пройдемся по телу <span class="RktSym">convert</span>: 
</div><div class="SIntrapara"><ol><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="stt"> </span><span class="RktSym">in</span><span class="RktPn">)</span> извлекает содержимое указанного файла в виде строки;</p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span> превращает эту строку в число; </p>

</li><li>

<p><span class="RktSym">C</span> интерпретирует число как температуру по 
Фаренгейту и преобразует его в температуру по Цельсию;</p>

</li><li>

<p><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number-~3estring%29%29" class="RktValLink" data-pltdoc="x">number-&gt;string</a></span> потребляет 
эту температуру по Цельсию и превращает ее в строку; а также </p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span><span class="stt"> </span><span class="RktSym">out</span><span class="stt"> </span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span> помещает эту строку в файл с именем  <span class="RktSym">out</span>.</p>

</li></ol></div><div class="SIntrapara">Этот длинный список шагов может показаться ошеломляющим, и в нем даже нет части,  <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span>. Стоп! Объясните 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"\n"</span><span class="RktPn">)</span></p>

</blockquote></div>

<p></p>

<p>Напротив, композиция средних функций в курсе предалгебры включает две функции, 
возможно, три. Однако имейте в виду, что программы выполняют реальную задачу, 
в то время как упражнения по алгебре просто иллюстрируют идею композиции функций. 
</p>

<p></p>

<div class="SIntrapara">На этом этапе мы можем поэкспериментировать с 
<span class="RktSym">convert</span>. Для начала мы используем 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span> для создания входного файла для  
<span class="RktSym">convert</span>:<span class="refelem"><span class="refcolumn"><span class="refcontent">Вы также можете создать <span class="stt">"sample.dat"</span> с помощью редактора файлов. </span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"sample.dat"</span><span class="hspace">&nbsp;</span><span class="RktVal">"212"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"sample.dat"</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">convert</span><span class="hspace">&nbsp;</span><span class="RktVal">"sample.dat"</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stdout</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktOut">100</span></p>

</td></tr><tr><td>

<p><span class="RktRes">'stdout</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">convert</span><span class="hspace">&nbsp;</span><span class="RktVal">"sample.dat"</span><span class="hspace">&nbsp;</span><span class="RktVal">"out.dat"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"out.dat"</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"out.dat"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"100"</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Для первого взаимодействия 
мы используем <span class="RktVal">'</span><span class="RktVal">stdout</span>, чтобы мы могли видеть, какие  данные выводит <span class="RktSym">convert</span> области взаимодействий DrRacket.
Для второго <span class="RktSym">convert</span> возмьем имя <span class="RktVal">"out.dat"</span>.
Как и ожидалось, вызов <span class="RktSym">convert</span> возвращает эту строку; из описания 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span> мы также знаем, что она помещает в файл температуру 
по Фаренгейту. Здесь мы читаем содержимое этого файла с помощью 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span>, но вы также можете просмотреть его с помощью текстового редактора. </div>

<p></p>

<p><a name="(idx._(gentag._32))"></a></p>

<p>В дополнение к запуску пакетной программы полезно также выполнить вычисления
по шагам. Убедитесь, что файл <span class="stt">"sample.dat"</span>существует и 
содержит только число, затем нажмите кнопку <span class="emph">STEP</span>(ШАГ)
 в DrRacket. Откроется другое окно, в котором вы можете просмотреть вычислительный 
процесс, который запускает вызов основной функции пакетной программы. Вы увидите, 
что процесс следует описанному выше. </p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._letter-writing))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;31. Напомним,  программу <span class="RktSym">letter</span> из <a href="#%28part._sec~3acomposing%29" data-pltdoc="x">Составления функций</a>. Вот как запустить программу и записать ее вывод в область взаимодействия: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">stdout</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letter</span><span class="hspace">&nbsp;</span><span class="RktVal">"Matthew"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Fisler"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Felleisen"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tbody><tr><td>

<p><span class="RktOut">Dear Matthew,</span></p>

</td></tr><tr><td>

<p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span></p>

</td></tr><tr><td>

<p><span class="RktOut">We have discovered that all people with the</span></p>

</td></tr><tr><td>

<p><span class="RktOut">last name Fisler have won our lottery. So, </span></p>

</td></tr><tr><td>

<p><span class="RktOut">Matthew, hurry and pick up your prize.</span></p>

</td></tr><tr><td>

<p><span class="RktOut"></span><span class="hspace">&nbsp;</span><span class="RktOut"></span></p>

</td></tr><tr><td>

<p><span class="RktOut">Sincerely, </span></p>

</td></tr><tr><td>

<p><span class="RktOut"></span></p>

</td></tr><tr><td>

<p><span class="RktOut">Felleisen</span></p>

</td></tr></tbody></table></td></tr><tr><td>

<p><span class="RktRes">'stdout</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Конечно, программы 
полезны, потому что вы можете запустить их для многих различных входов. 
Запустите <span class="RktSym">letter</span> для трех входных данных по вашему выбору. </div>

<p></p>

<p></p>

<div class="SIntrapara">Вот пакетная программа letter-writing, которая читает имена из трех файлов и записывает буквы к одной:   <a name="(idx._(gentag._33))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">in-fst</span><span class="hspace">&nbsp;</span><span class="RktSym">in-lst</span><span class="hspace">&nbsp;</span><span class="RktSym">in-signature</span><span class="hspace">&nbsp;</span><span class="RktSym">out</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._write-file%29%29" class="RktValLink" data-pltdoc="x">write-file</a></span><span class="hspace">&nbsp;</span><span class="RktSym">out</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">letter</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in-fst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in-lst</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpbatch-io.html#%28def._%28%28lib._2htdp%2Fbatch-io..rkt%29._read-file%29%29" class="RktValLink" data-pltdoc="x">read-file</a></span><span class="hspace">&nbsp;</span><span class="RktSym">in-signature</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Функция потребляет/использует четыре строки: 
первые три являются именами входных файлов, а последняя служит в качестве выходного файла. 
Она использует первые три, чтобы прочитать одну строку в каждом из трех именованных файлов,
передает эти строки в <span class="RktSym">letter</span>, и в конечном итоге записывает результат вызова этой функции  в файл с именем, четвертого аргумента  функции
<span class="RktSym">main</span>.</div>

<p></p>

<p>Создайте соответствующие файлы, запустите <span class="RktSym">main</span> и проверьте, доставляет ли(формирует ли) она ожидаемое письмо в данном файле.  <a href="#%28counter._%28exercise._letter-writing%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><span style="font-weight: bold">Интерактивные программы</span> 
Пакетные программы являются основным продуктом использования компьютеров в бизнесе, 
но программы, с которыми сейчас сталкиваются люди, являются интерактивными. 
В наши дни люди в основном взаимодействуют с настольными приложениями с помощью клавиатуры 
и мыши. Кроме того, интерактивные программы также могут реагировать на 
генерируемые компьютером события, например, тиканье часов или поступление сообщения 
с другого компьютера. </p>

<p><a name="(counter._(exercise._cell))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;32. 
Большинство людей больше не используют настольные компьютеры только для запуска приложений, 
но также используют сотовые телефоны, планшеты и информационные экраны своих автомобилей. 
Скоро люди будут использовать носимые компьютеры в виде умных очков, одежды и спортивного снаряжения. В несколько более отдаленном будущем люди могут появиться со встроенными биокомпьютерами, которые напрямую взаимодействуют с функциями тела. 
Подумайте о десяти различных формах событий, с которыми придется иметь дело программным приложениям на таких компьютерах. 
 <a href="#%28counter._%28exercise._cell%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>Цель этого раздела - познакомить с механикой написания 
<span style="font-weight: bold">интерактивных</span> BSL программ. 
Поскольку многие примеры стиля разработки в этой книге представляют собой 
интерактивные программы, мы представляем идеи медленно и осторожно. 
Вы можете вернуться к этому разделу, когда будете заниматься некоторыми 
проектами интерактивного программирования; второе или третье чтение может 
прояснить некоторые продвинутые аспекты механики. </p>

<p>Сам по себе чистый компьютер - бесполезное физическое оборудование. 
Он называется <span style="font-style: italic">hardware</span>(твердым изделием,
обычно переводимым как оборудование), потому что к нему можно прикоснуться. 
Это оборудование становится полезным после установки 
<span style="font-style: italic">software</span>(программного обеспечения), 
то есть набора программ. Обычно первым программным обеспечением, устанавливаемым на компьютер, является <span style="font-style: italic">операционная система</span>. 
Её задача - управлять компьютером за вас, включая подключенные устройства, 
такие как монитор, клавиатура, мышь, динамики и т. Д. Это работает так: 
когда пользователь нажимает клавишу на клавиатуре, операционная система запускает функцию, обрабатывающую нажатия клавиш. Мы говорим, что нажатие клавиши является 
<span style="font-style: italic">key event</span>(клавиатурным событием), 
а функция - <span style="font-style: italic">event handler</span>(обработчиком события). 
В том же духе операционная система запускает обработчик событий для отсчетов часов, 
для действий мыши и так далее. И наоборот, после того, как обработчик событий 
завершил свою работу, операционной системе может потребоваться изменить изображение на экране, позвонить в колокольчик, распечатать документ или выполнить аналогичное действие. 
Для выполнения этих задач он также выполняет функции, преобразующие данные операционной системы 
в звуки, изображения, действия на принтере и т. Д. </p>

<p>Естественно, у разных программ разные потребности. Одна программа может 
интерпретировать нажатия клавиш как сигналы для управления ядерным реактором; 
другая передает их текстовому процессору. Чтобы универсальный компьютер работал 
над этими радикально разными задачами, разные программы устанавливают разные 
обработчики событий. То есть программа запуска ракеты использует один вид функций 
для работы с тактами(отсчетами) часов, в то время как программное обеспечение 
духовки использует другой вид. </p>

<p>Для разработки интерактивной программы требуется способ обозначить некоторую 
функцию как функцию, которая отвечает за события клавиатуры, другую функцию для 
работы с тактами часов, третью для представления некоторых данных в виде изображения и т. Д.
Задача основной(main) функции интерактивной программы - сообщить эти обозначения(назначения)
операционной системе, то есть программной платформе, на которой запускается программа. </p>

<p>DrRacket - небольшая операционная система, а BSL - один из языков программирования. 
Последний поставляется с <span class="sroman">библиотекойe <span class="Smaller"><span style="font-style: italic">2htdp/universe</span></span> </span>, 
которая предоставляет <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>(большой взрыв), 
механизм, сообщающий операционной системе, какая функция с каким событием имеет дело. 
Кроме того, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> отслеживает 
<span style="font-style: italic">состояние программы</span>. 
Для этого у него есть одно обязательное подвыражение, значение которого становится 
<span style="font-style: italic">initial
state</span>(начальным состоянием) программы. В противном случае <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> состоит из одного обязательного предложения и множества дополнительных предложений. Обязательно(required) предложение
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span> сообщает DrRacket, 
как визуализировать состояние программы, включая начальное. Каждое из других необязательных предложений сообщает операционной системе, что определенная функция заботится 
об определенном событии. Обработка события в BSL означает, что функция использует(принимает) 
состояние программы и описание события и создает следующее состояние программы. 
Поэтому мы говорим о <span style="font-style: italic">current state</span>
(текущем состоянии) программы. </p>

<p><span style="font-weight: bold">Терминология</span> В некотором смысле выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>(большой взрыв) описывает, 
как программа взаимодействует с небольшим сегментом мира. 
Этот мир может быть игрой, в которую играют пользователи программы, анимацией, 
которую смотрит пользователь, или текстовым редактором, который пользователь 
использует для управления некоторыми заметками. 
Поэтому исследователи языка программирования часто говорят, что 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> - это описание маленького мира: 
его начального состояния, как состояния преобразуются, как состояния отображаются и 
как <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> может определять другие атрибуты 
текущего состояния. В этом духе мы также говорим о 
<span style="font-style: italic">state of the world</span>(состоянии мира) и даже называем <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> программы - 
<span style="font-style: italic">world programs</span>(программными мирами). 
<span style="font-weight: bold">Конец </span></p>

<p></p>

<div class="SIntrapara">Давайте изучим эту идею шаг за шагом, начиная с этого определения:<a name="(idx._(gentag._34))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">number-&gt;square</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._square%29%29" class="RktValLink" data-pltdoc="x">square</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Функция принимает
положительное число и создает сплошной красный квадрат этого размера. После нажатия 
<span class="emph">RUN</span> поэкспериментируйте с функцией, например: </div>

<p></p>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">number-&gt;square</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td>

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_35.png" alt="image" width="12" height="12"></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">number-&gt;square</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td>

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_36.png" alt="image" width="17" height="17"></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">number-&gt;square</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td>

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_37.png" alt="image" width="27" height="27"></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Она ведет 
себя как пакетная программа, принимая число и создавая изображение, 
которое DrRacket визуализирует для вас. </div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь попробуйте следующее выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> в области взаимодействия:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">number-&gt;square</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Появится отдельное окно с изображением <img src="part_one_files/pict_38.png" alt="image" width="51" height="9"> красного квадрата. Кроме того, в области взаимодействий DrRacket не отображается другое приглашение; это как если бы программа продолжала работать, и это действительно так. Чтобы остановить программу, нажмите кнопку <span class="emph">STOP</span> DrRacket или 
кнопку <span class="emph">CLOSE</span> в окне: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">number-&gt;square</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">100</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Когда DrRacket 
останавливает вычисление выражения span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, он возвращает текущее состояние, 
которое в данном случае является просто начальным состоянием:  
 <span class="RktVal">100</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Вот более интересное выражение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> :
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">number-&gt;square</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Это 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> выражение добавляет 
два необязательных предложения к предыдущему: 
предложение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span> сообщает DrRacket, 
как работать с тактами часов, а предложение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span> говорит, 
когда остановить программу. Мы читаем его следующим образом, начиная со 
<span class="RktVal">100</span> в качестве начального состояния: 
</div><div class="SIntrapara"><ol><li>

<p>каждый раз, когда часы тикают, вычитайте <span class="RktVal">1</span> из текущего состояния;</p>

</li><li>

<p>затем проверьте, что <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span> верно для нового состояния, и если да,
остановиться; а также </p>

</li><li>

<p>каждый раз, когда обработчик события возвращает значение, используйте 
<span class="RktSym">number-&gt;square</span>, чтобы отобразить его как изображение. </p>

</li></ol></div><div class="SIntrapara">Теперь нажмите кнопку “return” и посмотрите, 
что произойдет. В конце концов вычисление выражений прекращается, и DrRacket отображает
 <span class="RktVal">0</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Выражение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> отслеживает текущее состояние. Первоначально это состояние равно  <span class="RktVal">100</span>. Каждый раз, когда 
часы тикают, он вызывает обработчик тактов и получает новое состояние. Следовательно, 
состояние <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> меняется следующим образом:
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><span class="RktVal">100</span>, <span class="RktVal">99</span>, <span class="RktVal">98</span>, ..., <span class="RktVal">2</span>, <span class="RktVal">1</span>, <span class="RktVal">0</span></p>

</blockquote></div><div class="SIntrapara">Когда значение состояния становится 
равным <span class="RktVal">0</span>, вычисление завершено. Для любого другого 
состояния - от <span class="RktVal">100</span> до <span class="RktVal">1</span> - 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> переводит состояние в изображение, используя <span class="RktSym">number-&gt;square</span>, как указано в предложении 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span>. 
Следовательно, в окне отображается красный квадрат, который сжимается от <img src="part_one_files/pict_39.png" alt="image" width="51" height="9"> пикселей изображения к <img src="part_one_files/pict_40.png" alt="image" width="26" height="8"> пикселям изображения за 100 тактов отсчета.</div>

<p></p>

<p></p>

<div class="SIntrapara">Давайте добавим предложение для работы с событиями клавиатуры. 
Во-первых, нам нужна функция, которая использует текущее состояние и строку, описывающую
клавиатурное событие, а затем возвращающую новое состояние:  <a name="(idx._(gentag._35))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reset</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Эта функция отбрасывает 
свои аргументы и возвращает <span class="RktVal">100</span>, что является начальным 
состоянием выражения <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, которое мы хотим изменить. 
Во-вторых, мы добавляем предложение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span> к выражению 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">number-&gt;square</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span><span class="hspace">&nbsp;</span><span class="RktSym">reset</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Стоп! Объясните, что происходит, когда вы нажимаете “return”, сосчитаете до 10 и, наконец, 
нажимаете <span class="RktVal">"a"</span>.</div>

<p></p>

<p>Вы увидите, что красный квадрат сжимается со скоростью один пиксель за один такт отсчета
часов. Однако, как только вы нажмете клавишу <span class="RktVal">"a"</span>, 
красный квадрат снова расширится до полного размера, потому что выполняется 
<span class="RktSym">reset</span>(сброс) текущей длины квадрата и 
<span class="RktVal">"a"</span> и возвращается <span class="RktVal">100</span>. 
Это число становится новым состоянием <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> и 
<span class="RktSym">number-&gt;square</span> превращает его в полноразмерный красный квадрат. 
</p>

<p>Чтобы понять, как вычисляются выражения <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> в целом, 
давайте взглянем на схематическую версию:</p>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tock</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ke-h</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-mouse%29%29" class="RktStxLink" data-pltdoc="x">on-mouse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">me-h</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">render</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span><span class="hspace">&nbsp;</span><span class="RktSym">end?</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Это выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> определяет три обработчика событий - 
<span class="RktSym">tock</span>, <span class="RktSym">ke-h</span>, 
<span class="RktSym">ke-h</span> и 
<span class="RktSym">me-h</span> - и предложение 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span>. 
</div>

<p></p>

<p>Вычисление этого выражения <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> начинается с 
<span class="RktSym">cw0</span>, которое обычно является выражением. 
DrRacket, наша операционная система, устанавливает значение <span class="RktSym">cw0</span> 
как текущее состояние. Она использует <span class="RktSym">render</span> для преобразования
текущего состояния в изображение, которое затем отображается в отдельном окне. 
Действительно, <span class="RktSym">render</span> - это единственное средство выражения 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> для представления данных миру.
</p>

<p></p>

<div class="SIntrapara">Вот как обрабатываются события:
</div><div class="SIntrapara"><ul><li>

<p>Каждый раз, когда тикают часы, DrRacket применяет <span class="RktSym">tock</span> к 
текущему состоянию <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> и получает в ответ значение; 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> рассматривает это возвращаемое 
значение как следующее текущее состояние.</p>

</li><li>

<p>Каждый раз, когда нажимается клавиша, DrRacket применяет <span class="RktSym">ke-h</span> 
к текущему состоянию <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> и строке, представляющей клавишу; 
например, нажатие клавиши “a” обозначается буквой <span class="RktVal">"a"</span>, 
а клавиша со стрелкой влево - <span class="RktVal">"left"</span>. 
Когда <span class="RktSym">ke-h</span> возвращает значение, 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> рассматривает его 
как следующее текущее состояние. </p>

</li><li>

<p>Каждый раз, когда мышь входит в окно, покидает его, перемещается или нажимается, 
DrRacket применяет <span class="RktSym">me-h</span> к текущему состоянию 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, координатам x- и y- события и строке,
которая представляет тип события мыши, которое произошло; 
например, нажатие кнопки мыши обозначается как <span class="RktVal">"button-down"</span>. 
Когда <span class="RktSym">me-h</span> возвращает значение, 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> рассматривает его как 
следующее текущее состояние. 
</p>

</li></ul></div><div class="SIntrapara">Все события обрабатываются по порядку; если кажется, 
что два события произошли одновременно, DrRacket выполняет роль рефери(tie-breaker) и 
размещает их в определенном порядке. </div>

<p></p>

<p></p>

<div class="SIntrapara">После обработки события <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> использует обе функции
<span class="RktSym">end?</span> и <span class="RktSym">render</span>, чтобы проверить 
текущее состояние: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktPn">(</span><span class="RktSym">end?</span><span class="stt"> </span><span class="RktSym">cw</span><span class="RktPn">)</span> производит логическое значение. 
Если оно #<span class="RktVal">#true</span>(истина), <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> немедленно останавливает вычисление. 
В противном случае оно продолжается.</p>

</li><li>

<p><span class="RktPn">от (</span><span class="RktSym">render</span><span class="stt"> </span><span class="RktSym">cw</span><span class="RktPn">)</span> ожидается создание изображения и функция <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> отобразит это изображение в отдельном окне. 
</p>

</li></ul></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._world-process))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered"><table style="border-collapse: collapse;" cellspacing="0" cellpadding="0"><tbody><tr><td align="left">

<p>текущее состояние</p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p>...</p>

</td></tr><tr><td style="border-bottom: 1px solid black;" align="left">

<p>событие</p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p><span style="font-style: italic">e</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span></p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p><span style="font-style: italic">e</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span></p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p>...</p>

</td></tr><tr><td align="left">

<p>отчет часов(тик)</p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">tock</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">tock</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p>...</p>

</td></tr><tr><td align="left">

<p>при нажатии клавиши</p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">ke-h</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span style="font-style: italic">e</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">ke-h</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span style="font-style: italic">e</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p>...</p>

</td></tr><tr><td align="left">

<p>при событии мыши</p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">me-h</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span style="font-style: italic">e</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">me-h</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span style="font-style: italic">e</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p>...</p>

</td></tr><tr><td align="left">

<p>его отбражение</p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">render</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><span class="RktPn">(</span><span class="RktSym">render</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span></p>

</td><td align="left">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="left">

<p>...</p>

</td></tr></tbody></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Figure&nbsp;13: </span>How <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> works</span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Таблица на <a href="#%28counter._%28figure._world-process%29%29" data-pltdoc="x">рисунке&nbsp;
<span class="FigureRef">13</span></a> кратко описывает этот процесс. 
В первой строке перечислены названия текущих состояний. Во второй строке перечислены имена событий, с которыми сталкивается DrRacket: <span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span>,
<span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> и так далее.
Каждое <span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">i</span></span><span style="font-style: italic"></span> может быть тактом часов, 
нажатием клавиши или событием мыши. В следующих трех строках указывается результат обработки события: 
</div><div class="SIntrapara"><ul><li>

<p>Если <span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> - это такт часов, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> вычисляет 
<span class="RktPn">(</span><span class="RktSym">tock</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span> для получения  <span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>.</p>

</li><li>

<p>Если <span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> является
клавиатурным событием, вычисляется <span class="RktPn">(</span><span class="RktSym">ke-h</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="RktPn">)</span> и дает <span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>. Обработчик должен применяться к самому событию, потому что, как правило, 
программы будут реагировать на каждую клавишу по-разному. 
</p>

</li><li>

<p>Если <span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> - 
это событие мыши, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> запускает <span class="RktPn">(</span><span class="RktSym">me-h</span><span class="stt"> </span><span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span><span class="stt"> </span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span> чтобы получить
<span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span>. 
Вызов представляет собой sketch(набросок), потому что событие мыши <span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> действительно связано с несколькими частями данных - 
его природой и координатами - и мы просто хотим указать это. </p>

</li><li>

<p>Наконец, <span class="RktSym">render</span> превращает текущее состояние в изображение, 
на которое указывает последняя строка. DrRacket отображает эти изображения в отдельном окне.</p>

</li></ul></div><div class="SIntrapara">Столбец под <span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> показывает, как генерируется 
<span style="font-style: italic">cw</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span>, в зависимости от того, какое событие <span style="font-style: italic">e</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> имеет место. </div>

<p></p>

<p></p>

<div class="SIntrapara">
Давайте интерпретируем эту таблицу с конкретной последовательностью событий: пользователь нажимает клавишу “a”, 
затем тикают часы, и, наконец, пользователь щелкает мышью, чтобы вызвать событие “button down”(нажатие кнопки) 
в позиции <span style="font-style: italic"></span>(<span style="font-style: italic"></span>9<span style="font-style: italic"></span>0<span style="font-style: italic">,</span>1<span style="font-style: italic"></span>0<span style="font-style: italic"></span>0<span style="font-style: italic"></span>)<span style="font-style: italic"></span>. Тогда в обозначениях Racket 
</div><div class="SIntrapara"><ol><li>

<p><span class="RktSym">cw1</span> это результат  <span class="RktPn">(</span><span class="RktSym">ke-h</span><span class="stt"> </span><span class="RktSym">cw0</span><span class="stt"> </span><span class="RktVal">"a"</span><span class="RktPn">)</span>;</p>

</li><li>

<p><span class="RktSym">cw2</span> это результат  <span class="RktPn">(</span><span class="RktSym">tock</span><span class="stt"> </span><span class="RktSym">cw1</span><span class="RktPn">)</span>; and</p>

</li><li>

<p><span class="RktSym">cw3</span> это результат <span class="RktPn">(</span><span class="RktSym">me-h</span><span class="stt"> </span><span class="RktSym">cw2</span><span class="stt"> </span><span class="RktVal">90</span><span class="stt"> </span><span class="RktVal">100</span><span class="stt"> </span><span class="RktVal">"button-down"</span><span class="RktPn">)</span>.</p>

</li></ol></div><div class="SIntrapara">На самом деле мы можем выразить эти три шага как последовательность 
трех определений: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ke-h</span><span class="hspace">&nbsp;</span><span class="RktSym">cw0</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">cw1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">me-h</span><span class="hspace">&nbsp;</span><span class="RktSym">cw2</span><span class="hspace">&nbsp;</span><span class="RktVal">90</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">"button-down"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Стоп! Как <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> отображает каждое из этих трех состояний? </div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь давайте рассмотрим последовательность из трех тактов часов. 
В этом случае, 
</div><div class="SIntrapara"><ol><li>

<p><span class="RktSym">cw1</span> это результат  <span class="RktPn">(</span><span class="RktSym">tock</span><span class="stt"> </span><span class="RktSym">cw0</span><span class="RktPn">)</span>;</p>

</li><li>

<p><span class="RktSym">cw2</span> это результат  <span class="RktPn">(</span><span class="RktSym">tock</span><span class="stt"> </span><span class="RktSym">cw1</span><span class="RktPn">)</span>; and</p>

</li><li>

<p><span class="RktSym">cw3</span> это результат  <span class="RktPn">(</span><span class="RktSym">tock</span><span class="stt"> </span><span class="RktSym">cw2</span><span class="RktPn">)</span>.</p>

</li></ol></div><div class="SIntrapara">Или, переформулируя на BSL:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">cw0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">cw1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">cw2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">В самом деле, мы также можем определить <span class="RktSym">cw3</span> с помощью одного выражения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">cw0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Оно определяет состояние, которое вычисляет <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> после трех тактов(отсчетов) часов. 
Стоп! Переформулируйте первую последовательность событий как выражение. 
 <a name="(idx._(gentag._36))"></a> <a name="(idx._(gentag._37))"></a> <a name="(idx._(gentag._38))"></a></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3ainteractive))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">DOT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">place-dot-at</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span><span class="hspace">&nbsp;</span><span class="RktSym">stop</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">place-dot-at</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">DOT</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">stop</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;14: </span>Первая интерактивная программа</span></p>

</blockquote>

<p>Короче говоря, последовательность событий определяет, в каком порядке  <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> концептуально проходит приведенную выше таблицу 
возможных состояний, чтобы достичь текущего состояния для каждого временного интервала. 
Конечно, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> не касается текущего состояния; он просто защищает его и при необходимости 
передает обработчикам событий и другим функциям. 
</p>

<p>Отсюда легко определить первую интерактивную программу. См. <a href="#%28counter._%28figure._fig~3ainteractive%29%29" data-pltdoc="x">рисунок&nbsp;<span class="FigureRef">14</span></a>.
 Программа состоит из двух определений констант, за которыми следуют три определения функций: 
<span class="RktSym">main</span>, запускающую  интерактивную программу <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>; <span class="RktSym">place-dot-at</span>, 
которая переводит текущее состояние в изображение; и <span class="RktSym">stop</span>, которая 
отбрасывает свои входные данные и возвращает  <span class="RktVal">0</span>.</p>

<p></p>

<div class="SIntrapara">После нажатия <span class="emph">RUN</span> мы можем попросить DrRacket вычислить
применение этих функций-обработчиков. Это один из способов подтвердить их работоспособность:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">place-dot-at</span><span class="hspace">&nbsp;</span><span class="RktVal">89</span><span class="RktPn">)</span></td></tr><tr><td>

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_41.png" alt="image" width="107" height="107"></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">stop</span><span class="hspace">&nbsp;</span><span class="RktVal">89</span><span class="hspace">&nbsp;</span><span class="RktVal">"q"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">0</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Стоп! Попытайтесь теперь понять, 
как <span class="RktSym">main</span> реагирует на нажатие клавиши. </div>

<p></p>

<p></p>

<div class="SIntrapara">Один из способов узнать, верна ли ваша гипотеза, - запустить функцию 
<span class="RktSym">main</span> с некоторым разумным числом: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktVal">90</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<table cellspacing="0" cellpadding="0"><tbody><tr><td>

<p>&nbsp;</p>

</td></tr><tr><td>

<p>Расслабляемся.</p>

</td></tr><tr><td>

<p>&nbsp;</p>

</td></tr></tbody></table>

<p></p>

<p>
К настоящему моменту вы можете почувствовать, что эти первые две главы ошеломляют. 
Они вводят множество новых концепций, включая новый язык, его словарь, его значение, 
его идиомы, инструмент для записи текстов в этом словаре и способ запуска этих программ. 
Столкнувшись с этим изобилием идей, вы можете задаться вопросом, как можно создать программу, 
когда ей предлагают постановку задачи. Чтобы ответить на этот центральный вопрос, 
в следующей главе мы сделаем шаг назад и подробно рассмотрим систематическую разработку программ. 
Так что сделайте передышку и продолжайте, когда будете готовы. 
</p>

<h3>3<tt>&nbsp;</tt><a name="(part._ch~3ahtdp)"></a>Как Разрабатывать(проектировать) Программы</h3>

<p>Первые несколько глав этой книги показывают, что обучение программированию 
требует некоторого владения многими концепциями. С одной стороны, программированию 
нужен язык, обозначение для передачи того, что мы хотим вычислить. 
Языки для формулирования программ - это искусственные конструкции, 
хотя освоение языка программирования имеет общие элементы с усвоением естественного языка. 
Оба имеют словарный запас, грамматику и понимание того, что означают “phrases”(фразы). </p>

<p>С другой стороны, очень важно научиться переходить от постановки задачи к программе. 
Нам нужно определить, что уместно в формулировке проблемы, а что можно игнорировать. 
Нам нужно выяснить, что программа потребляет(использует), что она производит и 
как соотносит входные данные с выходными. Мы должны знать или выяснять, предоставляют ли 
выбранный язык и его библиотеки определенные базовые операции для данных, которые наша 
программа должна обрабатывать. В противном случае нам, возможно, придется разработать 
вспомогательные функции, реализующие эти операции. Наконец, когда у нас есть программа, 
мы должны проверить, действительно ли она выполняет предполагаемое вычисление. 
И это может выявить всевозможные ошибки, которые нам необходимо понять и исправить. 
</p>

<p>Все это звучит довольно сложно, и вы можете задаться вопросом, 
почему мы не запутываемся, экспериментируя тут и там, оставляя достаточно хороший код в покое, 
когда результаты выглядят достойно. Такой подход к программированию, часто называемый 
“гаражным программированием“, широко распространен и во многих случаях оказывается успешным; 
иногда это стартовая площадка для начинающей компании. Тем не менее, стартап не может 
продавать результаты “гаражных усилий“, потому что их могут использовать только оригинальные
(первоначальные) программисты и их друзья. </p>

<p>Хорошая программа поставляется с коротким описанием, в котором объясняется, 
что она делает, какие входные данные ожидает и что она производит. 
В идеале это также дает некоторую уверенность в том, что она действительно работает. 
В лучших условиях связь программы с постановкой задачи очевидна, 
так что небольшое изменение в постановке задачи легко перевести в небольшое изменение 
в программе. Инженеры-программисты называют это “программным продуктом“. </p>

<p>Вся эта дополнительная работа необходима, потому что программисты не создают программы для себя. 
Программисты пишут программы для чтения другими программистами, и иногда люди запускают эти программы, 
чтобы выполнить работу.
<span class="refelem"><span class="refcolumn"><span class="refcontent">Слово “другой“ также включает 
в себя более старые версии кода программиста, который обычно не может вспомнить все мысли, 
которые были вложены при разработке младшая версии программы.</span></span></span> 

Большинство программ представляют собой большие сложные наборы взаимодействующих функций, 
и никто не может написать все эти функции за один день. Программисты присоединяются к проектам, 
пишут код, покидают проекты; другие берут на себя их программы и работают над ними. 
Другая трудность состоит в том, что клиенты программиста склонны менять свое мнение о том, 
какую проблему они действительно хотят решить. Обычно у них все почти правильно, но чаще всего 
они ошибаются в некоторых деталях. Хуже того, сложные логические конструкции, такие как программы, 
почти всегда страдают от человеческих ошибок; Короче говоря, программисты ошибаются. 
В конце концов, кто-то обнаруживает эти ошибки, и программисты должны их исправить. 
Им нужно перечитать программы написанные месяц назад, год назад или двадцать лет назад и изменить их. 
</p>

<p><a name="(counter._(exercise._y2k))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;33. Изучите проблему “2000 года“.  <a href="#%28counter._%28exercise._y2k%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>Здесь мы представляем <a name="(idx._(gentag._39))"></a>рецепт разработки, 
который объединяет пошаговый процесс со способом организации программ вокруг данных проблемы. 
Для читателей, которые не любят долго смотреть в пустой экран, этот рецепт разработки предлагает 
способ систематического прогресса. Для тех из вас, кто учит других разрабатывать программы, 
рецепт - это инструмент для диагностики трудностей новичка. Для других наш рецепт может быть чем-то, 
что они могут применить в других областях, например, в медицине, журналистике или инженерии. 
Для тех, кто хочет стать настоящими программистами, рецепт разработки также предлагает способ 
понять существующие программы и работать с ними, хотя не все программисты используют метод, 
подобный этому рецепту разработки, для создания программ.
Остальная часть этой главы посвящена первым шагам ребенка в мир рецептов разработки; 
следующие главы и части так или иначе уточняют и расширяют рецепт. 
</p>

<h4>3.1<tt>&nbsp;</tt><a name="(part._sec~3adesign-func)"></a>Разработка Функций</h4>

<p><span style="font-weight: bold">Информация и данные</span> 
<a name="(idx._(gentag._41))"></a>Цель программы - описать <a name="(idx._(gentag._42))"></a>вычислительный процесс,
который  потребляет(принимает) некоторую информацию и производит новую информацию. 
В этом смысле программа похожа на инструкции, которые учитель математики дает ученикам начальной школы. 
Однако, в отличие от ученика, программа работает не только с числами: она вычисляет с помощью 
навигационной информации, ищет адрес человека, включает переключатели или проверяет состояние видеоигры. 
Вся эта информация поступает из части реального мира, часто называемой <span style="font-style: italic">domain</span>(доменом/областью) программы, и результаты вычислений программы представляют больше информации в этой области. 
</p>

<p><span style="font-style: italic">Информация</span> играет центральную роль в нашем описании. 
Думайте об информации как о фактах о области деятельности(домене) программы. 
Для программы, посвященной каталогу мебели, “стол на пяти ножках“ или “квадратный стол размером два на два метра“ 
являются фрагментами информации. 
Игровая программа имеет дело с областью(доменом) другого типа, где “пять“ может относиться 
к количеству пикселей за такт часов, которое некоторый объект перемещает на своем пути от одной части 
холста(канвы/canvas) к другой. Или программа расчета заработной платы, вероятно, будет иметь дело 
с “пятью удержаниями“.
</p>

<p>For a program to process information, it must turn it into some form of
 <span style="font-style: italic">data</span> in the programming language; then it processes the data;
 and once it is finished, it turns the resulting data into information
 again. An interactive program may even intermingle these steps, acquiring
 more information from the world as needed and delivering information in
 between.</p>

<p>Мы используем BSL и DrRacket, поэтому вам <span style="font-weight: bold">не</span> нужно беспокоиться о 
переводе информации в данные. В BSL DrRacket вы можете применить функцию непосредственно к данным и наблюдать, 
что она производит(выдает). В результате мы избегаем серьезной проблемы курицы и яйца при написании функций, 
которые преобразуют информацию в данные и наоборот. Для простых видов информации создание таких частей программы тривиально; для всего, кроме простой информации, вам нужно знать, например, о синтаксическом анализе, 
а это немедленно требует большого опыта в разработке программ. </p>

<p>Программные инженеры используют слоган <span style="font-style: italic">model-view-controller</span> 
(MVC/модель-представление-контроллер) для способа, каким BSL и DrRacket отделяют обработку данных 
от преобразования(анализа) информации в данные и преобразования данных в информацию. 
Действительно, сейчас общепринято мнение, что хорошо спроектированные программные системы обеспечивают 
это разделение, хотя большинство вводных книг все еще смешивают их. 
Таким образом, работа с BSL и DrRacket позволяет вам сосредоточиться на разработке ядра программ, 
и когда у вас будет достаточно опыта в этом, вы можете научиться проектировать части преобразования 
информация-данные. 
</p>

<p>Здесь мы используем два предустановленных обучающих пакета, чтобы продемонстрировать 
разделение данных и информации: <span class="stt">2htdp/batch-io</span> и <span class="stt">2htdp/universe</span>. 
Начиная с этой главы, мы разрабатываем рецепты проектирования 
<a name="(idx._(gentag._43))"></a><span style="font-weight: bold">batch</span>(пакетных) и 
<a name="(idx._(gentag._44))"></a><span style="font-weight: bold">interactive</span>(интерактивных) программ, 
чтобы дать вам представление о том, как создаются полные программы. 
Помните, что библиотеки полноценных языков программирования предлагают гораздо больше контекстов для 
законченных программ, и что вам нужно будет соответствующим образом адаптировать рецепты разработки. </p>

<p><a name="(idx._(gentag._45))"></a>
<a name="(idx._(gentag._46))"></a>
<a name="(idx._(gentag._47))"></a></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3adata-info))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_42.png" alt="image" width="269.4677734375" height="172.078125"></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;15: </span>От инофрмации к данным и обратно</span></p>

</blockquote>

<p>Учитывая центральную роль информации и данных, разработка программы должна начинаться 
с установления связи между ними. В частности, мы, программисты, должны решить, 
как использовать выбранный нами язык программирования для 
<span style="font-style: italic">представления</span> соответствующих фрагментов информации 
в виде данных и как мы должны <span style="font-style: italic">интерпретировать</span> данные 
как информацию. <a href="#%28counter._%28figure._fig~3adata-info%29%29" data-pltdoc="x">Рисунок&nbsp;<span class="FigureRef">15</span></a> поясняет эту идею с помощью абстрактной диаграммы. </p>

<p></p>

<div class="SIntrapara">Чтобы конкретизировать эту идею, давайте рассмотрим несколько примеров. 
Предположим, вы разрабатываете программу, которая использует(потребляет) и производит информацию 
в виде чисел. Хотя выбор представления прост, интерпретация требует объяснения того, что обозначает
число <span class="RktVal">42</span>,  в домене: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktVal">42</span>  может относиться к количеству пикселей от верхнего поля 
в области изображений; </p>

</li><li>

<p><span class="RktVal">42</span> может обозначать количество пикселей за такт часов, 
на которое перемещается имитационный или игровой объект;</p>

</li><li>

<p><span class="RktVal">42</span> может означать температуру по шкале Фаренгейта, 
Цельсия или Кельвина для области физики; </p>

</li><li>

<p><span class="RktVal">42</span>  может указывать размер некоторой таблицы, если предметной 
областью программы является каталог мебели; или же </p>

</li><li>

<p><span class="RktVal">42</span> может просто обозначать количество символов в строке</p>

</li></ul></div><div class="SIntrapara">Ключ в том, чтобы знать, как перейти от чисел как информации к 
числам как данным и наоборот. </div>

<p></p>

<p>Поскольку эти знания так важны для всех, кто читает программу, мы часто записываем их 
в виде комментариев, которые мы называем <span style="font-style: italic">определениями данных</span>. 
Определение данных служит двум целям. Во-первых, он именует набор данных - 
<span style="font-style: italic">class</span>(класс) - с помощью значащего слова. 
Во-вторых,
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Ученые-информатики используют термин “class”(класс) для обозначения чего-то вроде 
“математического множества“. </span></span></span>  
оно информирует читателей, как создавать элементы этого класса и как определить, 
принадлежит ли некоторый произвольный фрагмент данных коллекции.
</p>

<p></p>

<div class="SIntrapara">Вот определение данных для одного из приведенных выше примеров:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._temperature)"></a><span style="font-style: italic">Temperature</span><span class="RktCmt"> is a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">. </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> represents Celsius degrees</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Первая строка вводит имя набора данных, 
<a href="#%28tech._temperature%29" class="techoutside" data-pltdoc="x"><span class="techinside">Temperature</span></a>
(Температура), и сообщает нам, что класс состоит из <a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>(чисел). Так, например, если мы спросим, является ли 
<span class="RktVal">102</span> температурой, вы можете ответить “да“, потому что 
<span class="RktVal">102</span> - это число, а все числа - это температуры. 
Точно так же, если мы спросим, является ли  <span class="RktVal">"cold"</span>(холодно) температурой, 
вы ответите “нет“, потому что ни одна строка не принадлежит 
<a href="#%28tech._temperature%29" class="techoutside" data-pltdoc="x"><span class="techinside">Temperature</span></a>(температуре). 
И если мы попросим вас составить образец <a href="#%28tech._temperature%29" class="techoutside" data-pltdoc="x"><span class="techinside">Temperature</span></a>(температуры), вы можете получить что-то вроде 
 <span class="RktVal"><span class="nobreak">-4</span>00</span>.</div>

<p></p>

<p>Если вы знаете, что минимально возможная температура приблизительно соответствует 
<img src="part_one_files/pict_43.png" alt="image" width="32" height="10"> C, 
вы можете задаться вопросом, можно ли выразить это знание в определении данных. 
Поскольку наши определения данных на самом деле являются просто описаниями классов 
на английском языке, вы действительно можете определить класс температур гораздо более точно, 
чем показано здесь. В этой книге мы используем стилизованную форму английского языка для таких 
определений данных, а в следующей главе представлен стиль для наложения ограничений(constraints), 
таких как “larger than
 <span class="RktVal"><span class="nobreak">-2</span>74</span>.”(больше -274). 
</p>

<p>До сих пор вы встречали имена четырех классов данных: 
<a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>, 
<a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>, 
<a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a>, и
<a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a>. 
При этом формулировка нового определения данных означает не что иное, как введение нового имени для 
существующей формы данных, скажем, “temperature”(температура) для чисел. 
Однако даже этих ограниченных знаний достаточно, чтобы объяснить схему нашего 
<a name="(idx._(gentag._48))"></a>процесса проектирования. </p>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">Процесс проектирования</span> 
Как только вы поймете, как представлять входную информацию 
<span class="refelem"><span class="refcolumn"><span class="refcontent">
На этом этапе вы можете перечитать раздел Предисловия о <a href="part_preface.html#%28part._sec~3asystematic-design%29" data-pltdoc="x">систематическом проектировании программ</a>, особенно 
<a href="part_preface.html#%28counter._%28figure._fig~3athe-design-recipe%29%29" data-pltdoc="x">рисунок&nbsp;<span class="FigureRef">1</span></a>.</span></span></span>
как данные и интерпретировать выходные данные как информацию, проектирование отдельной 
<a name="(idx._(gentag._49))"></a> функции осуществляется в соответствии с простым процессом:
</div><div class="SIntrapara"><ol><li>

<p></p>

<div class="SIntrapara">Выразите, как вы хотите представить информацию в виде данных. 
Достаточно однострочного комментария: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">We use numbers to represent centimeters.(Мы используем числа для обозначения сантиметров.) </span></p>

</blockquote></div><div class="SIntrapara">Сформулируйте определения данных, такие как определение 
<a href="#%28tech._temperature%29" class="techoutside" data-pltdoc="x"><span class="techinside">Temperature</span></a>(температуры), для классов данных, которые вы считаете критическими для успеха вашей программы. 
</div>

<p></p>

</li><li>

<p>
Запишите сигнатуру, <a name="(idx._(gentag._50))"></a>заявление о цели(предназначение) и заголовок функции. </p>

<p></p>

<div class="SIntrapara"> <a name="(idx._(gentag._51))"></a><span style="font-style: italic">Сигнатура функции</span>
 - это комментарий, который сообщает читателям вашего проекта, сколько входов потребляет ваша функция, 
из каких классов они взяты и какие данные она производит. 
Вот три примера для функций, которые соответственно 
</div><div class="SIntrapara"><ul><li>

<p></p>

<div class="SIntrapara">потребляет одну <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>(строку) и производит <a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>(число):
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></p>

</blockquote></div>

<p></p>

</li><li>

<p></p>

<div class="SIntrapara">потребляет <a href="#%28tech._temperature%29" class="techoutside" data-pltdoc="x"><span class="techinside">Temperature</span></a> и производит <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._temperature%29" class="techoutside" data-pltdoc="x"><span class="techinside">Temperature</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a></p>

</blockquote></div><div class="SIntrapara">Как указывает эта <a name="(idx._(gentag._52))"></a>сигнатура, 
введение <a name="(idx._(gentag._53))"></a>определения данных в качестве псевдонима для существующей 
формы данных позволяет легко прочитать намерение, стоящее за сигнатурами. </div>

<p></p>

<p>Тем не менее, мы рекомендуем вам пока держаться подальше от 
определения псевдонимов данных. Распространение таких имен может вызвать путаницу. 
Требуется практика, чтобы сбалансировать потребность в новых именах и удобочитаемости программ, 
и есть более важные идеи, которые нужно понять прямо сейчас. </p>

</li><li>

<p></p>

<div class="SIntrapara">потребляет <a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>,  <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a> и <a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></p>

</blockquote></div><div class="SIntrapara">Стоп! Что производит эта функция?</div>

<p></p>

</li></ul></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(idx._(gentag._54))"></a><span style="font-style: italic">purpose statement</span>(предназначение) - это комментарий BSL, который объявлет назначение функции в одной строке. 
Если вы когда-либо сомневаетесь в предназначении(формулировке цели), 
запишите как можно более короткий ответ на вопрос. 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-style: italic"что вычисляет функция?</span></p>

</blockquote></div><div class="SIntrapara">Каждый читатель вашей программы должен понимать, 
что вычисляют ваши функции, <span style="font-weight: bold">без</span> необходимости читать саму функцию.</div>

<p></p>

<p>Многофункциональная программа также должна иметь <a name="(idx._(gentag._55))"></a>purpose statement/предназначение.
Действительно, хорошие программисты пишут два предназначения: одно для читателя, которому, возможно, 
придется изменить код, и другое для человека, который хочет использовать программу, а не читать ее. </p>

<p></p>

<div class="SIntrapara">Наконец, <a name="(idx._(gentag._56))"></a><span style="font-style: italic">header</span>
(заголовок) - это упрощенное определение функции, также называемое <span style="font-style: italic">stub</span>(заглушкой).
Выберите одно имя переменной для каждого класса входных данных в сигнатуре; 
тело функции может быть любым фрагментом данных из класса выходных данных. 
Эти три заголовка функций соответствуют трем вышеупомянутым сигнатурам: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">f</span><span class="stt"> </span><span class="RktSym">a-string</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">g</span><span class="stt"> </span><span class="RktSym">n</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">"a"</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">h</span><span class="stt"> </span><span class="RktSym">num</span><span class="stt"> </span><span class="RktSym">str</span><span class="stt"> </span><span class="RktSym">img</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="stt"> </span><span class="RktVal">100</span><span class="stt"> </span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</li></ul></div><div class="SIntrapara">Наши имена параметров отражают, какой тип данных представляет параметр. 
Иногда вы можете захотеть использовать имена, указывающие на назначение параметра. </div>

<p></p>

<p></p>

<div class="SIntrapara">Когда вы формулируете <a name="(idx._(gentag._57))"></a>(purpose statement)предназначение, 
часто бывает полезно использовать имена параметров, чтобы прояснить, что вычисляется. 
Например, 
<a name="(idx._(gentag._58))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktSym">s</span><span class="RktCmt"> to </span><span class="RktSym">img</span><span class="RktCmt">,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">y</span><span class="RktCmt"> pixels from the top and </span><span class="RktVal">10</span><span class="RktCmt"> from the left </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-image</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>На этом этапе вы можете нажать кнопку <span class="emph">RUN</span> и поэкспериментировать с функцией. 
Конечно, результатом всегда будет одно и то же значение, что делает эти эксперименты довольно скучными. 
</p>

</li><li>

<p>Проиллюстрируйте <a name="(idx._(gentag._59))"></a>сигнатуру и <a name="(idx._(gentag._60))"></a>
предназначение(формулировку цели) некоторыми функциональными примерами. 
Чтобы построить <a name="(idx._(gentag._61))"></a><span style="font-style: italic"><a name="(idx._(gentag._61))"></a><span style="font-style: italic">функциональный пример</span>, выберите по одному фрагменту данных из 
каждого входного класса из сигнатуры и определите, что вы ожидаете в ответ. </p>

<p></p>

<div class="SIntrapara">Предположим, вы разрабатываете функцию, которая вычисляет площадь квадрата. 
Ясно, что эта функция использует длину стороны квадрата, и это лучше всего можно представить с помощью 
(положительного) числа. Предполагая, что вы выполнили первый шаг процесса в соответствии с рецептом, 
вы добавляете примеры между заявлением о назначении(предназначением) и заголовком и получаете следующее:  
<a name="(idx._(gentag._62))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the area of a square with side </span><span class="RktSym">len</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: 2, expect: 4</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: 7, expect: 49</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">area-of-square</span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

</li><li>

<p>Следующий шаг - провести <span style="font-style: italic">inventory</span>(инвентаризацию), 
чтобы понять, что есть данность и что нам нужно вычислить.
<span class="refelem"><span class="refcolumn"><span class="refcontent">Термином “inventory” 
мы обязаны Стивену Блоху</span></span></span> 
Мы знаем, что для простых функций, которые мы рассматриваем прямо сейчас, 
они получают данные через параметры. Хотя параметры являются заполнителями для значений, 
которые мы еще не знаем, мы знаем, что именно из этих неизвестных данных функция должна вычислить свой результат. 
Чтобы напомнить себе об этом факте, мы заменяем тело функции 
<a name="(idx._(gentag._63))"></a><span style="font-style: italic">template</span>(шаблоном.).</p>

<p></p>

<div class="SIntrapara">На данный момент шаблон содержит только параметры, 
поэтому предыдущий пример выглядит так:  <a name="(idx._(gentag._64))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">area-of-square</span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Точки напоминают вам, что это не полная функция, а шаблон, 
предложение для организации(дальнейшего заполнения). </div>

<p></p>

<p>Шаблоны этого раздела выглядят скучно. Как только мы введем новые формы данных, 
шаблоны станут более интересными. </p>

</li><li>

<p>Пришло время <span style="font-style: italic">кодировать</span>(писать код). 
В общем, кодировать означает программировать, хотя часто и самым узким образом, 
а именно писать исполняемые выражения и определения функций. </p>

<p></p>

<div class="SIntrapara">Для нас кодирование означает замену тела функции выражением, 
которое пытается вычислить из частей в шаблоне то, что обещает <a name="(idx._(gentag._65))"></a>
предназначение(формулировка цели). Вот полное определение  
<a name="(idx._(gentag._66))"></a><span class="RktSym">area-of-square</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the area of a square with side </span><span class="RktSym">len</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: 2, expect: 4</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: 7, expect: 49</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">area-of-square</span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqr%29%29" class="RktValLink" data-pltdoc="x">sqr</a></span><span class="hspace">&nbsp;</span><span class="RktSym">len</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3adesign1))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktSym">s</span><span class="RktCmt"> to </span><span class="RktSym">img</span><span class="RktCmt">, </span><span class="RktSym">y</span><span class="RktCmt"> pixels from top, </span><span class="RktVal">10</span><span class="RktCmt"> pixels to the left</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">5</span><span class="RktCmt"> for </span><span class="RktSym">y</span><span class="RktCmt">, </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"hello"</span><span class="RktCmt"> for </span><span class="RktSym">s</span><span class="RktCmt">, and</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="stt"> </span><span class="RktVal">100</span><span class="stt"> </span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktCmt"> for </span><span class="RktSym">img</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">expected: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="stt"> </span><span class="RktVal">"hello"</span><span class="stt"> </span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">5</span><span class="stt"> </span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">where ... is </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="stt"> </span><span class="RktVal">100</span><span class="stt"> </span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add-image</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">img</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;16: </span> Завершение 5-го этапа проектирования </span></p>

</blockquote>

<p>Для завершения функции <span class="RktSym">add-image</span> требуется немного больше работы, 
чем это: см. 
<a href="#%28counter._%28figure._fig~3adesign1%29%29" data-pltdoc="x">рисунок&nbsp;<span class="FigureRef">16</span></a>. 
В частности, функция должна превратить заданную строку <span class="RktSym">s</span> в изображение, 
которое затем помещается в заданную сцену. 
</p>

</li><li>

<p></p>

<div class="SIntrapara">Последний шаг в правильном проектировании - это проверить функцию на примерах, 
которые вы разработали ранее. Пока что тестирование работает так. 
Нажмите кнопку <span class="emph">RUN</span> и введите применение функции, соответствующие примерам, 
в области взаимодействия:  <a name="(idx._(gentag._67))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">area-of-square</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">4</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">area-of-square</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">49</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Результаты должны соответствовать 
ожидаемому результату; вы должны проверить каждый результат и убедиться, что он соответствует тому, 
что записано в примере части разработки. Если результат не соответствует ожидаемому результату, 
рассмотрите следующие три возможности: 
</div><div class="SIntrapara"><ol><li>

<p>Вы просчитали и определили неверный ожидаемый результат для некоторых примеров.</p>

</li><li>

<p>В качестве альтернативы определение функции дает неверный результат. 
В этом случае в вашей программе есть <span style="font-style: italic">логическая ошибка</span>, 
также известная как <span style="font-style: italic">bug</span>(баг/ошибка).</p>

</li><li>

<p>И <a name="(idx._(gentag._68))"></a>примеры, и определение функции неверны.</p>

</li></ol></div><div class="SIntrapara">Если вы обнаружите несоответствие между 
ожидаемыми результатами и фактическими значениями, мы рекомендуем сначала убедиться 
в правильности ожидаемых результатов. Если это так, предположим, что ошибка в определении функции. 
В противном случае исправьте пример и снова запустите тесты. Если вы все еще сталкиваетесь 
с проблемами, возможно, вы столкнулись с третьей, довольно редкой ситуацией. 
</div>

<p></p>

</li></ol></div>

<p></p>

<h4>3.2<tt>&nbsp;</tt><a name="(part._sec~3afinger-design)"></a>Упражнения для пальцев: функции</h4>

<p>Первые несколько из следующих упражнений почти копируют те, что в 
<a href="#%28part._sec~3afuncs%29" data-pltdoc="x">Функции</a>, хотя там, 
где в последних используется слово “define”(определить), в приведенных ниже 
упражнениях используется слово “design”(разработать). Это различие означает, 
что вы должны работать используя рецепт разработки, чтобы создать эти функции, 
и ваши решения должны включать все соответствующие части.</p>

<p>Как следует из названия раздела, эти упражнения представляют собой практические упражнения, 
которые помогут вам усвоить процесс. Пока шаги не станут вашей привычкой, никогда не пропускайте их, 
потому что это приводит к ошибкам, которых легко избежать. 
В программировании остается много места для сложных ошибок; 
нам не нужно тратить время на глупости. </p>

<p><a name="(counter._(exercise._design1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;34.  
Разработайте функцию <span class="RktSym">string-first</span>, которая извлекает первый символ из 
непустой строки. Не беспокойтесь о пустых строках.  
<a href="#%28counter._%28exercise._design1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._design2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;35.
 Создайте функцию <span class="RktSym">string-last</span>, которая извлекает последний символ 
из непустой строки.  
<a href="#%28counter._%28exercise._design2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._design3))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;36.
Разработайте функцию <span class="RktSym">image-area</span>, которая подсчитывает количество пикселей 
в данном изображении. 
<a href="#%28counter._%28exercise._design3%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._design4))"></a><span style="font-weight: bold"> Упражнение</span>&nbsp;37.
Разработайте функцию <span class="RktSym">string-rest</span>, которая создает строку, 
подобную данной, с удаленным первым символом.  
<a href="#%28counter._%28exercise._design4%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._design5))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;38.
Разработайте функцию <span class="RktSym">string-remove-last</span>, которая создает строку, подобную данной, 
с удаленным <span style="font-weight: bold">последним</span> символом.  
<a href="#%28counter._%28exercise._design5%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>3.3<tt>&nbsp;</tt><a name="(part._sec~3adomain)"></a>Область(домен) знаний</h4>

<p></p>

<div class="SIntrapara">Естественно задаться вопросом, какие знания необходимы, 
чтобы кодировать тело функции. Небольшое размышление скажет вам, что этот шаг требует 
надлежащего понимания предметной области программы. В самом деле, существует две формы 
такой <span style="font-style: italic">области знания(domain knowledge)</span>:
</div><div class="SIntrapara"><ol><li>

<p>Знания из внешних областей, таких как математика, музыка, биология, 
гражданское строительство, искусство и т. Д. Поскольку программисты не могут 
знать все прикладные области вычислений, они должны быть готовы понимать 
язык множества прикладных областей, чтобы они могли обсуждать проблемы с 
экспертами в данной области. Математика находится на пересечении многих, 
но не всех областей. Следовательно, программисты должны часто осваивать 
новые языки, решая проблемы с экспертами в предметной области. </p>

</li><li>

<p>Знание функций библиотеки на выбранном языке программирования. 
Когда ваша задача - перевести математическую формулу, включающую 
тангенциальную функцию, вам нужно знать или угадывать, что выбранный вами язык 
имеет такую функцию, как <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._tan%29%29" class="RktValLink" data-pltdoc="x">tan</a></span> BSL. 
Когда ваша задача связана с графикой, вам будет полезно понять возможности
<span class="sroman"> библиотеки  <span class="Smaller"><span style="font-style: italic">2htdp/image</span></span> </span>.</p>

</li></ol></div><div class="SIntrapara">Поскольку вы никогда не можете предсказать, 
в какой области вы будете работать, или какой язык программирования вам придется использовать,
крайне важно, чтобы у вас было твердое представление обо всех возможностях любых 
компьютерных языков, которые существуют и подходят. В противном случае вашу работу 
возьмет на себя какой-нибудь эксперт в предметной области с недостаточными знаниями
в области программирования. </div>

<p></p>

<p>Вы можете распознать проблемы, требующие знания предметной области, 
из определений данных, которые вы разрабатываете. Поскольку в определениях данных 
используются классы, существующие на выбранном языке программирования, 
определение тела функции (и программы) в основном зависит от опыта в данной области. 
Позже, когда мы вводим сложные формы данных, проектирование функций требует 
знаний в области информатики. </p>

<h4>3.4<tt>&nbsp;</tt><a name="(part._sec~3adesign)"></a>От функций к программам</h4>

<p>Не все программы состоят из определения одной функции. 
Некоторым требуется несколько функций; многие также используют 
определения констант. Несмотря ни на что, всегда важно систематически 
проектировать каждую функцию, глобальные константы, а также 
вспомогательные функции немного меняют процесс проектирования. </p>

<p>Когда вы определили глобальные константы, ваши функции могут использовать 
их для вычисления результатов. Чтобы напомнить себе об их существовании, 
вы можете добавить эти константы в свои шаблоны; в конце концов, они принадлежат 
к набору тех вещей, которые могут способствовать определению функции. </p>

<p>Многофункциональные программы возникают потому, что интерактивным программам 
автоматически требуются функции, которые обрабатывают события клавиш и мыши, 
функции, отображающие состояние как музыку, и, возможно, многое другое.
Даже пакетным программам может потребоваться несколько различных функций, 
поскольку они выполняют несколько отдельных задач. Иногда постановка проблемы 
сама предлагает эти задачи; в других случаях вы обнаружите необходимость во 
вспомогательных функциях, когда будете в процессе разработки какой-либо функции.</p>

<p>По этим причинам мы рекомендуем хранить список необходимых функций 
или <span style="font-style: italic">список пожеланий(wish list)</span>.
<span class="refelem"><span class="refcolumn"><span class="refcontent">Термином
“wish list”(список пожеланий) мы обязаны Джону Стоуну.</span></span></span> 
Каждая запись в списке пожеланий должна состоять из трех вещей: 
значимого имени функции, сигнатуры и предназначения(заявления о цели). 
Для разработки пакетной программы поместите основную функцию в список пожеланий 
и приступайте к ее проектированию. Для разработки интерактивной программы вы 
можете поместить в список обработчики событий, функцию остановки -
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span> и функцию рендеринга сцены
(scene-rendering). Пока список не пуст, выберите пожелание и создайте функцию. 
Если во время проектирования вы обнаружите, что вам нужна другая функция, 
внесите ее в список. Когда список пуст, все готово. </p>

<h4>3.5<tt>&nbsp;</tt><a name="(part._sec~3atesting)"></a>В Тестировании</h4>

<p>Тестирование быстро превращается в трудоемкую работу. 
Хотя небольшие программы легко запускать в области взаимодействия, 
для этого требуется много механического труда и сложных проверок. 
По мере того, как программисты развивают свои системы, они хотят проводить 
множество тестов. Вскоре этот труд становится непосильным, и программисты 
начинают им пренебрегать. В то же время тестирование - это первый инструмент 
для обнаружения и предотвращения основных недостатков. Неаккуратное тестирование 
быстро приводит к ошибкам в функциях, то есть функциям со скрытыми проблемами, 
а ошибочные функции тормозят проекты, зачастую множеством способов. </p>

<p></p>

<div class="SIntrapara">Следовательно, очень важно механизировать тесты, 
а не проводить  их вручную. Как и многие языки программирования, BSL включает 
средство тестирования, и DrRacket знает об этом. Чтобы представить это средство 
тестирования, мы еще раз рассмотрим функцию, которая преобразует температуру по 
Фаренгейту в температуру по Цельсию из <a href="#%28part._sec~3aprogs%29" data-pltdoc="x">Программы</a>. Вот определение: 
<a name="(idx._(gentag._69))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">converts Fahrenheit temperatures to Celsius</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given 32, expect 0</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given 212, expect 100</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given -40, expect -40</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5/9</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Тестирование примеров функции требует трех вычислений 
и трех сравнений между двумя числами каждое. Вы можете сформулировать эти тесты и 
добавить их в область определений DrRacket: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-4</span>0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-4</span>0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktVal">212</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Когда вы теперь нажмете кнопку <span class="emph">RUN</span>, 
вы увидите отчет BSL о том, что программа прошла все три теста - и вам больше ничего
не надо делать.</div>

<p></p>

<p></p>

<div class="SIntrapara">В дополнение к автоматическому запуску тестов формы 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span> показывают еще 
одно преимущество, когда тесты терпят неудачу. 
Чтобы увидеть, как это работает, измените один из приведенных выше тестов так, 
чтобы результат был неверным, например
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-4</span>0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Когда вы теперь нажмете кнопку 
<span class="emph">RUN</span>, появится дополнительное окно. 
Текст в окне объясняет, что один из трех тестов не прошел. 
Для неудавшегося теста в окне отображаются три части: вычисленное значение, 
результат вызова функции (<span class="RktVal"><span class="nobreak">-4</span>0</span>); 
ожидание (<span class="RktVal">40</span>); и гиперссылка на текст неудачного 
тестового примера. </div>

<p></p>

<blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">converts Fahrenheit temperatures to Celsius temperatures </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-4</span>0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-4</span>0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktVal">212</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f2c</span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5/9</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3atesting))" x-target-lift="Figure"></a>Рисунок&nbsp;17: </span>Тестирование в BSL</span></p>

</blockquote>

<p>Вы можете разместить спецификации <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span> над или 
под определениями функций, которые они тестируют. 
Когда вы нажимаете <span class="emph">RUN</span>, DrRacket собирает все спецификации <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span> и вычисляет их 
<span style="font-weight: bold">после</span> того, 
как все определения функций были добавлены в “словарь“ операций. 
На <a href="#%28counter._%28figure._fig~3atesting%29%29" data-pltdoc="x">Рисунке&nbsp;<span class="FigureRef">17</span></a> показано, как использовать эту свободу для объединения 
примера и шага тестирования. Вместо того, чтобы записывать примеры в виде комментариев, 
вы можете перевести их прямо в тесты. Когда вы закончите с разработкой функции, 
нажмите <span class="emph">RUN</span> для выполнения теста. 
И если вы когда-нибудь измените функцию по какой-либо причине, следующий щелчок приведет к повторной проверке функции. </p>

<p></p>

<div class="SIntrapara">И последнее, но не менее важное: 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span> также работает для изображений. 
То есть вы можете протестировать функции создания изображений. Предположим, 
вы хотите разработать функцию рендеринга(<span class="RktSym">render</span>), 
которая помещает изображение автомобиля, названное <span class="RktSym">CAR</span>, 
в фоновую сцену с именем <span class="RktSym">BACKGROUND</span>. 
Для разработки этой функции вы можете сформулировать следующие тесты: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_44.png" alt="image" width="306.0" height="35.0"><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_45.png" alt="image" width="306.0" height="35.0"><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">В качестве альтернативы вы можете написать их так:
<span class="refelem"><span class="refcolumn"><span class="refcontent">Дополнительные способы составления тестов см. В интермеццо 1.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CAR</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktSym">Y-CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CAR</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;</span><span class="RktSym">Y-CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Этот альтернативный подход помогает понять, как выразить тело функции, 
поэтому он предпочтительнее. Один из способов развить такие выражения - 
экспериментировать в области взаимодействий. </div>

<p></p>

<p>Поскольку DrRacket очень полезно проводить тесты, а не проверять все вручную, 
мы немедленно переключаемся на этот стиль тестирования для остальной части книги. 
Эта форма тестирования называется 
<a name="(idx._(gentag._70))"></a><span style="font-style: italic">unit testing</span>
(модульным тестированием), и структура модульного тестирования BSL специально 
предназначена для начинающих программистов. 
Однажды вы переключитесь на какой-нибудь другой язык программирования; 
Одна из ваших первых задач будет заключаться в разработке его фреймворка для модульного тестирования. </p>

<h4>3.6<tt>&nbsp;</tt><a name="(part._.D.K._sec~3adesign-world)"></a>Разработка программных
миров </h4>

<p>В то время как в предыдущей главе специально представлена 
<span class="sroman">библиотека <span class="Smaller"><span style="font-style: italic">2htdp/universe</span></span> </span>, в этом разделе показано, как рецепт разработки
 также помогает систематически создавать программные миры. Он начинается с краткого обзора
библиотеки <span class="sroman"> <span class="Smaller"><span style="font-style: italic">2htdp/universe</span></span> </span> на основе определений данных и сигнатур функций. 
Затем излагается рецепт создания программных миров. </p>

<p>Пакет обучения предполагает, что программист разработает определение данных, 
которое представляет состояние мира, и функцию отображения - 
<span class="RktSym">render</span>, которая знает, как создать изображение для 
каждого возможного состояния мира. В зависимости от потребностей программы программист 
должен затем разработать функции, которые реагируют на такты часов, нажатия клавиш и 
события мыши. Наконец, интерактивной программе может потребоваться остановка, когда ее 
текущий мир принадлежит специальному подклассу состояний; 
<span class="RktSym">end?</span> распознает эти 
<span style="font-style: italic">конечные состояния</span>. 
На <a href="#%28counter._.D.K._%28figure._fig~3aworld-signatures%29%29" data-pltdoc="x">Рисунке&nbsp;<span class="FigureRef">18</span></a> схематично и упрощенно 
представлена эта идея. 
</p>

<blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-style: italic">WorldState</span><span class="RktCmt">: data representing the current world (</span><span class="RktSym">cw</span><span class="RktCmt">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="stt">WorldState</span><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">when needed, </span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="RktCmt"> obtains the image of the current </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">state of the world by evaluating </span><span class="RktPn">(</span><span class="RktSym">render</span><span class="stt"> </span><span class="RktSym">cw</span><span class="RktPn">)</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="stt">WorldState</span><span class="RktCmt"> -&gt; </span><span class="stt">WorldState</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">for each tick of the clock, </span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="RktCmt"> obtains the next </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">state of the world from </span><span class="RktPn">(</span><span class="RktSym">clock-tick-handler</span><span class="stt"> </span><span class="RktSym">cw</span><span class="RktPn">)</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">clock-tick-handler</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="stt">WorldState</span><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> -&gt; </span><span class="stt">WorldState</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">for each keystroke, </span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="RktCmt"> obtains the next state </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">from </span><span class="RktPn">(</span><span class="RktSym">keystroke-handler</span><span class="stt"> </span><span class="RktSym">cw</span><span class="stt"> </span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="RktCmt">; </span><span class="RktSym">ke</span><span class="RktCmt"> represents the key</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">keystroke-handler</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="stt">WorldState</span><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> -&gt; </span><span class="stt">WorldState</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">for each mouse gesture, </span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="RktCmt"> obtains the next state</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">from </span><span class="RktPn">(</span><span class="RktSym">mouse-event-handler</span><span class="stt"> </span><span class="RktSym">cw</span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">y</span><span class="stt"> </span><span class="RktSym">me</span><span class="RktPn">)</span><span class="RktCmt"> where </span><span class="RktSym">x</span><span class="RktCmt"> and </span><span class="RktSym">y</span><span class="RktCmt"> are</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the coordinates of the event and </span><span class="RktSym">me</span><span class="RktCmt"> is its description </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mouse-event-handler</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="stt">WorldState</span><span class="RktCmt"> -&gt; </span><span class="stt">Boolean</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">after each event, </span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="RktCmt"> evaluates </span><span class="RktPn">(</span><span class="RktSym">end?</span><span class="stt"> </span><span class="RktSym">cw</span><span class="RktPn">)</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">end?</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._.D.K._(figure._fig~3aworld-signatures))" x-target-lift="Figure"></a>Рисунок&nbsp;18: </span>Список пожеланий для разработки программных миров </span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Предполагая, что у вас есть элементарное представление о 
работе <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, вы можете сосредоточиться 
на действительно важной проблеме разработки программных миров. 
Построим конкретный пример следующего рецепта разработки: 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример задачи</span> 
Создайте программу, которая перемещает машину слева направо на мировом холсте, 
по три пикселя за такт часов. </p>

</blockquote></div><div class="SIntrapara">Для этой постановки задачи легко представить 
сцены для домена:
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_46.png" alt="image" width="306.0" height="35.0"></p>

</blockquote></div><div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_47.png" alt="image" width="306.0" height="35.0"></p>

</blockquote></div><div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_48.png" alt="image" width="306.0" height="35.0"></p>

</blockquote></div><div class="SIntrapara">В этой книге мы часто называем сферу(домен)
интерактивной программы <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> “миром” и говорим о разработке 
”программных миров”.</div>

<p></p>

<p></p>

<div class="SIntrapara">Рецепт разработки программного мира, как и рецепт для функций, 
- это инструмент для систематического перехода от постановки задачи к работающей программе. 
Он состоит из трех больших ступеней и одной маленькой: 
</div><div class="SIntrapara"><ol><li>

<p></p>

<div class="SIntrapara">Для всех тех свойств мира, которые остаются неизменными 
с течением времени и необходимы для визуализации(отображения) их как 
<a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a>(изображения), введите константы. В BSL мы указываем такие константы 
через определения. Применительно к программным мирам мы различаем два 
вида констант: 
</div><div class="SIntrapara"><ol><li>

<p>“Физические“ константы описывают общие атрибуты объектов в мире, такие как 
скорость или скорость объекта, его цвет, высота, ширина, радиус и т. Д. 
Конечно, эти константы на самом деле не относятся к физическим фактам, но многие 
из них аналогичны физическим аспектам реального мира. </p>

<p></p>

<div class="SIntrapara">В контексте задачи нашего примера радиус колес автомобиля и расстояние между колесами являются такими “физическими“ константами: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH-OF-WORLD</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL-RADIUS</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL-DISTANCE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL-RADIUS</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Обратите внимание, как вторая константа вычисляется из первой.</div>

<p></p>

</li><li>

<p>Графические константы - это изображения предметов в мире. Программа объединяет 
их в изображения, которые представляют полное состояние мира. </p>

<p></p>

<div class="SIntrapara">Вот графические константы для изображений колес нашего автомобиля
из примера: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL-RADIUS</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"black"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="refelem"><span class="refcolumn"><span class="refcontent">Мы предлагаем вам поэкспериментировать в области взаимодействия DrRacket,
чтобы разработать такие графические константы. </span></span></span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">SPACE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL-RADIUS</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"white"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BOTH-WHEELS</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%29%29" class="RktValLink" data-pltdoc="x">beside</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL</span><span class="hspace">&nbsp;</span><span class="RktSym">SPACE</span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Графические константы обычно вычисляются, и вычисления, как правило, 
включают физические константы и другие изображения.</div>

<p></p>

</li></ol></div><div class="SIntrapara">Хорошая практика - аннотировать определения констант 
с помощью комментария, объясняющего, что они означают. </div>

<p></p>

</li><li>

<p>Те свойства, которые меняются со временем - в ответ на тиканье часов, 
нажатия клавиш или действия мыши - определяют текущее состояние мира. 
Ваша задача разработать <a name="(idx._.D.K._(gentag._72._.D.K))"></a>представление данных 
для всех возможных состояний мира. Результатом разработки является 
<a name="(idx._.D.K._(gentag._73._.D.K))"></a>определение данных, 
которое сопровождается комментарием, в котором читателям рассказывается, 
как представлять информацию о мире как данные и как интерпретировать данные 
как информацию о мире. </p>

<p>Выберите простые формы данных, чтобы представить состояние мира.</p>

<p>Для запущенного примера со временем изменяется расстояние автомобиля от левого края. 
Хотя расстояние до правого поля тоже меняется, очевидно, что для создания изображения 
нам нужен только одино или другое. Расстояние измеряется числами, поэтому следующее 
определение данных является адекватным: </p>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._.D.K._worldstate)"></a><span style="font-style: italic">WorldState</span><span class="RktCmt"> is a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> the number of pixels between</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the left border of the scene and the car</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Альтернативой является подсчет количества прошедших тактов часов и использование 
этого числа в качестве состояния мира. Этот вариант разработки оставляем в 
качестве упражнения.</div>

<p></p>

</li><li>

<p>Когда у вас есть представление данных о состоянии мира, вам необходимо 
разработать ряд функций, чтобы вы могли сформировать правильное выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>. </p>

<p></p>

<div class="SIntrapara">Для начала вам понадобится функция, которая отображает любое 
заданное состояние в изображение, чтобы <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> мог отображать последовательность 
состояний в виде изображений: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">render</span></p>

</blockquote></div><div class="SIntrapara">Затем вам нужно решить, 
какие события должны изменять какие-либо аспекты состояния мира. 
В зависимости от ваших решений вам необходимо разработать некоторые или 
все из следующих трех функций: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">clock-tick-handler</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">keystroke-handler</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">mouse-event-handler</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Наконец, если в постановке задачи предполагается, что программа 
должна остановиться, если мир имеет определенные свойства, вы должны спроектировать 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">end?</span></p>

</blockquote></div><div class="SIntrapara">Общие сигнатуры и предназначения
этих функций см. На <a href="#%28counter._.D.K._%28figure._fig~3aworld-signatures%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">18</span></a>. 
Адаптируйте эти общие предназначения(формулировки целей) к конкретным задачам, 
которые вы решаете, чтобы читатели знали, что они вычисляют. </div>

<p></p>

<p>Короче говоря, желание разработать интерактивную программу автоматически создает 
несколько начальных записей для вашего списка пожеланий. Работайте с ними одна за другой, 
и вы получите полный программный мир. </p>

<p></p>

<div class="SIntrapara">Давайте поработаем на этом этапе для примера программы. 
Хотя <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> диктует, что мы должны разработать 
функцию рендеринга(отображения), нам все же нужно выяснить, нужны ли нам какие-либо 
функции обработки событий. Поскольку машина должна двигаться слева направо, 
нам определенно нужна функция, которая работает с тактами часов. Таким образом, 
мы получаем такой список пожеланий:  <a name="(idx._.D.K._(gentag._74._.D.K))"></a> <a name="(idx._.D.K._(gentag._75._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">places the image of the car </span><span class="RktSym">x</span><span class="RktCmt"> pixels from </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the left margin of the </span><span class="RktSym">BACKGROUND</span><span class="RktCmt"> image </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktVal">3</span><span class="RktCmt"> to </span><span class="RktSym">x</span><span class="RktCmt"> to move the car right </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Обратите внимание на то, как мы адаптировали предназначения
(формулировки целей) к рассматриваемой проблеме, понимая, как <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> будет использовать эти функции. 
</div>

<p></p>

</li><li>

<p>Наконец, вам нужна основная(<span class="RktSym">main</span>) функция. 
В отличие от всех других функций, основная функция программного мира не требует 
проектирования или тестирования. Единственная причина её существования в том, 
чтобы вы могли легко запустить свой программный мир из области взаимодействия DrRacket. 
</p>

<p></p>

<div class="SIntrapara">Единственное решение, которое вы должны принять, 
касается аргументов <span class="RktSym">main</span>. В нашем примере задачи мы выбрали 
один аргумент: начальное состояние мира. Вот так:  <a name="(idx._.D.K._(gentag._76._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">launches the program from some initial state </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tock</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">render</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Следовательно, вы можете запустить эту интерактивную программу с помощью 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
чтобы увидеть, как автомобиль стартует с расстояния 13 пикселей от левого края. 
Он остановится, когда вы закроете окно <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>. 
Помните, что <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> возвращает текущее состояние мира, 
когда оценка прекращается. </div>

<p></p>

</li></ol></div>

<p></p>

<p>Естественно, вам не нужно использовать имя “WorldState” для класса данных, 
который представляет состояния мира. Подойдет любое имя, если вы последовательно 
используете его для сигнатур функций обработки событий. 
Кроме того, вам не обязательно использовать имена <span class="RktSym">tock</span>,
<span class="RktSym">end?</span> и <span class="RktSym">render</span>. 
Вы можете называть эти функции как хотите, при условии, что вы используете те же имена, 
когда записываете предложения выражения <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>. 
Наконец, вы, возможно, заметили, что вы можете перечислять предложения выражения <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> в любом порядке, если вы сначала указываете начальное состояние. </p>

<p>Давайте теперь проработаем оставшуюся часть процесса разработки программы, 
используя <a name="(idx._.D.K._(gentag._77._.D.K))"></a> рецепт разработки для функций и 
другие концепции разработки(проектирования), изложенные до сих пор. </p>

<p></p>

<div class="SIntrapara"><a name="(counter._.D.K._(exercise._design6))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;39. Хорошие программисты гарантируют, что изображение, 
такое как <span class="RktSym">CAR</span>, может быть увеличено или уменьшено путем 
однократного изменения  определения константы.

<span class="refelem"><span class="refcolumn"><span class="refcontent">
Хорошие программисты устанавливают единую точку контроля для всех аспектов своих программ, 
а не только для графических констант. Этому вопросу посвящено несколько глав.
</span></span></span>  
Мы начали разработку образа автомобиля с одного простого определения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WHEEL-RADIUS</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Определение <span class="RktSym">WHEEL-DISTANCE</span>
основано на радиусе колеса. Следовательно, изменение <span class="RktSym">WHEEL-RADIUS</span>
с <span class="RktVal">5</span> до  <span class="RktVal">10</span> увеличивает размер изображения автомобиля вдвое. Такого рода организацию программы называют <span style="font-style: italic">единой точкой контроля</span>, и хорошее проектирование максимально использует
эту идею.</div>

<p></p>

<p>Создайте своё любимое изображение автомобиля, так чтобы радиус колеса
(<span class="RktSym">WHEEL-RADIUS</span>) оставался единственной точкой контроля.
<a href="#%28counter._.D.K._%28exercise._design6%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Следующая запись в списке пожеланий - это функция обработки
такта часов: <a name="(idx._.D.K._(gentag._78._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">moves the car by </span><span class="RktVal">3</span><span class="RktCmt"> pixels for every clock tick</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Поскольку состояние мира представляет собой расстояние между левым краем холста(канвы) и
автомобилем, и поскольку автомобиль движется со скоростью три пикселя за такт часов,
краткое изложение предназначения объединяет эти два факта в один.
Оно также упрощает создание примеров и определение функции:
<a name="(idx._.D.K._(gentag._79._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">moves the car by </span><span class="RktVal">3</span><span class="RktCmt"> pixels for every clock tick</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">examples: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">given: 20, expect 23</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">given: 78, expect 81</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Последний этап проектирования требует подтверждения того,
что примеры работают должным образом. Итак, мы нажимаем кнопку  
<span class="emph">RUN</span> и вычисляем эти выражения: <a name="(idx._.D.K._(gentag._80._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">23</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">tock</span><span class="hspace">&nbsp;</span><span class="RktVal">78</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">81</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Поскольку результаты такие,
как и ожидалось, создание <span class="RktSym">tock</span> закончено.</div>

<p></p>

<p><a name="(counter._.D.K._(exercise._car-test))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;40. Сформулируйте примеры как тесты BSL, то есть используя
форму <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span>. Введите ошибку.
Повторно запустите тесты. 
<a href="#%28counter._.D.K._%28exercise._car-test%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Наша вторая запись в списке пожеланий определяет функцию,
которая преобразует состояние мира в изображение: 
<a name="(idx._.D.K._(gentag._81._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">places the car into the </span><span class="RktSym">BACKGROUND</span><span class="RktCmt"> scene,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">according to the given world state </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>Чтобы сделать <a name="(idx._.D.K._(gentag._82._.D.K))"></a>примеры для функции отрисовки(рендеринга), мы предлагаем организовать таблицу, как в верхней половине 
<a href="#%28counter._.D.K._%28figure._fig~3amoving-car%29%29" data-pltdoc="x">рисунка&nbsp;<span class="FigureRef">19</span></a>.  В ней перечислены заданные состояния мира
и желаемые сцены. Для ваших первых нескольких функций отображения вы можете
нарисовать эти изображения в ручную.
</p>

<blockquote class="Figure"><a name="(counter._.D.K._(figure._fig~3amoving-car))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote>

<p></p>

<div class="SIntrapara"><table style="border-collapse: collapse;" cellspacing="0" cellpadding="0"><tbody><tr><td style="border-bottom: 1px solid black;" align="right">

<p>cw</p>

</td><td style="border-bottom: 1px solid black;" align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p>это изображение</p>

</td></tr><tr><td align="right">

<p>50</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_49.png" alt="image" width="306.0" height="35.0"></p>

</td></tr><tr><td align="right">

<p>100</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_50.png" alt="image" width="306.0" height="35.0"></p>

</td></tr><tr><td align="right">

<p>150</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_51.png" alt="image" width="306.0" height="35.0"></p>

</td></tr><tr><td align="right">

<p>200</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_52.png" alt="image" width="306.0" height="35.0"></p>

</td></tr><tr><td align="right">

<p></p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left">

<p></p>

</td></tr></tbody></table></div><div class="SIntrapara"><table style="border-collapse: collapse;" cellspacing="0" cellpadding="0"><tbody><tr><td style="border-bottom: 1px solid black;" align="right">

<p>cw</p>

</td><td style="border-bottom: 1px solid black;" align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;" align="left">

<p>как выражение</p>

</td></tr><tr><td align="right">

<p>50</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CAR</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktSym">Y-CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span></td></tr><tr><td align="right">

<p>100</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CAR</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktSym">Y-CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span></td></tr><tr><td align="right">

<p>150</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CAR</span><span class="hspace">&nbsp;</span><span class="RktVal">150</span><span class="hspace">&nbsp;</span><span class="RktSym">Y-CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span></td></tr><tr><td align="right">

<p>200</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td align="left"><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CAR</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;</span><span class="RktSym">Y-CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span></td></tr></tbody></table></div>

<p></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Figure&nbsp;19: </span>Examples for a moving car program</span></p>

</blockquote>

<p>Хотя такая таблица изображений интуитивно понятна и объясняет, что будет отображать
запущенная функция — движущийся автомобиль —, она не объясняет
 <span style="font-weight: bold">как</span> функция получает этот результат. 
Чтобы добраться от сюда туда, мы рекомендуем записывать выражения, подобные тем,
что показаныв нижней половине 
 <a href="#%28counter._.D.K._%28figure._fig~3amoving-car%29%29" data-pltdoc="x">рисунка
&nbsp;<span class="FigureRef">19</span></a>, которые создают изображения в таблице.  
Имена с заглавной буквы относятся к очевидным константам: изображению автомобиля,
его фиксированной координате y и фоновой сцене, которая в настоящее время - пустак.
</p>

<p></p>

<div class="SIntrapara">Эта расширенная таблица пердлагает образец формулы,
которая входит в тело функции <span class="RktSym">render</span>: <a name="(idx._.D.K._(gentag._83._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">places the car into the </span><span class="RktSym">BACKGROUND</span><span class="RktCmt"> scene,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">according to the given world state </span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">cw</span><span class="hspace">&nbsp;</span><span class="RktSym">Y-CAR</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">И это почти все, что нужно
для разработки простого программного мира.</div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._.D.K._(exercise._design8))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;41. Завершите пример задачи и запустите программу.
То есть, если вы решили <a href="#%28counter._.D.K._%28exercise._design6%29%29" data-pltdoc="x">упражнение&nbsp;39</a>, определите константы <span class="RktSym">BACKGROUND</span>
и <span class="RktSym">Y-CAR</span>. Затем соберите все определения функций, включая их тесты.
Когда ваша программа удовлетворит вас, добавьте к сцене дерево.
Мы использовали
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tree</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._underlay%2Fxy%29%29" class="RktValLink" data-pltdoc="x">underlay/xy</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">9</span><span class="hspace">&nbsp;</span><span class="RktVal">15</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"brown"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">чтобы создать древовидную форму. Также добавьте предложение к
выражению <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>,
которое останавлливает анимацию, когда автомобиль исчезает с правой стороны. 
<a href="#%28counter._.D.K._%28exercise._design8%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p>Определившись с исходным представлениенм данных для состояний мира,
внимательному программисту, возможно, придется пересмотреть это фундаментальное
проектное решение в течении остальной части процессса проектирования. 
Например, определение данных для примера задачи представляет автомобиль как
точку. Но (изображение) автомобиля - это не просто математическая точка без ширины
и высоты. Следовательно, интерпретация утверждения - количество пикселей от левой
границы - является неоднозначным.  Это утверждение меряет расстояние между левым краем
и левым концом автомобиля?  Его центральной точкой? Или его правым концом?
Мы проигнорировали эту проблему здесь и предоставили примитивам изображений BSL принять
решение за нас. Если вам не нравится результат, вернитесь к приведенному выше определению
данных и измените его или его интерпретацию по своему вкусу.
</p>

<p><a name="(counter._.D.K._(exercise._design9a))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;42. Измените интерпретацию определения данных выборки так, чтобы состояние обозначило
x-координату самого правого края автомобиля. 
<a href="#%28counter._.D.K._%28exercise._design9a%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._.D.K._(exercise._design9))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;43. Давайте рассмотрим ту же постановку задачи с определением временных данных(зависящих от времени):
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._.D.K._animationstate)"></a><span style="font-style: italic">AnimationState</span><span class="RktCmt"> is a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> the number of clock ticks </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">since the animation started</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как и в исходном определении
данных, это также приравнивает состояния мира к классу чисел. Однако его интерпретация
объясняет, что число означает нечто совершенно иное.
</div>

<p></p>

<p>Разработайте функции <span class="RktSym">tock</span> и <span class="RktSym">render</span>.
Затем разработайте выражение
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, чтобы вы снова получили анимацию
автомобиля, движущегося слева направо по всей канве мира.
</p>

<p>Как вы думаете как эта программа отностся к <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._%28%28lib._2htdp%2Funiverse..rkt%29._animate%29%29" class="RktValLink" data-pltdoc="x">animate</a></span>(анимации) из
<a href="part_prologue.html" data-pltdoc="x">Пролога: Как Программировать</a>?</p>

<p>Используйте определение данных, чтобы разработать программу, которая перемещает автомобиль 
в соответствии с синусоидальной волной. (Но не пытайтесь так водить.) 
<a href="#%28counter._.D.K._%28exercise._design9%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Мы заканчиваем раздел иллюстрацией обработки событий мыши, 
которая также демонстрирует преимущества разделения представления и модели. 
</div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent">

<p>Иногда бывает сложно справиться с движениями мыши, потому что они не совсем такие, 
какими кажутся. Чтобы получить первое представление о том, почему это так, 
прочтите  <a href="https://htdp.org/2021-3-8/notes/note_mice-and-chars.html" data-pltdoc="x">
О Мышах и Ключах(клавишах)</a>.</p>

</blockquote></blockquote></blockquote></div><div class="SIntrapara"> Предположим, 
мы хотим позволить людям перемещать машину через “гиперпространство“:
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример задачи</span> 
Создайте программу, которая перемещает автомобиль по холсту мира слева направо со 
скоростью три пикселя за такт часов. <span style="font-weight: bold">Если щелкнуть мышью в любом месте холста, автомобиль будет помещен в координату x этого щелчка.</span></p>

</blockquote></div><div class="SIntrapara">Выделенная широким шрифтом часть - это расширение
примера задачи сверху.</div>

<p></p>

<p></p>

<div class="SIntrapara">Когда мы сталкиваемся с измененной проблемой, мы используем 
процесс проектирования, чтобы внести необходимые изменения. При правильном использовании 
этот процесс естественным образом определяет, что нам нужно добавить к нашей существующей
программе, чтобы справиться с расширением формулировки проблемы. Итак, начнем: 
</div><div class="SIntrapara"><ol><li>

<p>Нет новых свойств, то есть нам не нужны новые константы. </p>

</li><li>

<p>Программа по-прежнему занимается только одним свойством, которое изменяется 
со временем, - x-координатой  автомобиля. Следовательно, представление данных - 
достаточное.</p>

</li><li>

<p></p>

<div class="SIntrapara">Пересмотренная постановка задачи требует обработчик событий мыши, 
не отказываясь от движения автомобиля по тактам часов. Поэтому мы высказываем соответствующее
пожелание:  <a name="(idx._.D.K._(gentag._84._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">places the car at </span><span class="RktSym">x-mouse</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if the given </span><span class="RktSym">me</span><span class="RktCmt"> is </span><span class="RktVal">"button-down"</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hyper</span><span class="hspace">&nbsp;</span><span class="RktSym">x-position-of-car</span><span class="hspace">&nbsp;</span><span class="RktSym">x-mouse</span><span class="hspace">&nbsp;</span><span class="RktSym">y-mouse</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">x-position-of-car</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

</li><li>

<p></p>

<div class="SIntrapara">Наконец, нам нужно изменить <span class="RktSym">main</span>, 
чтобы заботиться о событиях мыши. Все, что для этого требуется, - это добавление предложения 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-mouse%29%29" class="RktStxLink" data-pltdoc="x">on-mouse</a></span>, которое относится к новой записи 
в нашем списке пожеланий:   <a name="(idx._.D.K._(gentag._85._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ws</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tock</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-mouse%29%29" class="RktStxLink" data-pltdoc="x">on-mouse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">hyper</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">render</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В конце концов, модифицированная проблема требует обработки щелчков мышью, 
а все остальное остается прежним. </div>

<p></p>

</li></ol></div><div class="SIntrapara">Остальное - это просто вопрос разработки еще одной
 функции, и для этого мы используем рецепт разработки для функций. </div>

<p></p>

<p></p>

<div class="SIntrapara">Запись в списке пожеланий охватывает первые два шага 
рецепта проектирования функций. Следовательно, наш следующий шаг - разработать 
несколько функциональных примеров:  <a name="(idx._.D.K._(gentag._86._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">places the car at </span><span class="RktSym">x-mouse</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if the given </span><span class="RktSym">me</span><span class="RktCmt"> is </span><span class="RktVal">"button-down"</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: </span><span class="RktVal">21</span><span class="RktCmt"> </span><span class="RktVal">10</span><span class="RktCmt"> </span><span class="RktVal">20</span><span class="RktCmt"> </span><span class="RktVal">"enter"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">wanted: </span><span class="RktVal">21</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: </span><span class="RktVal">42</span><span class="RktCmt"> </span><span class="RktVal">10</span><span class="RktCmt"> </span><span class="RktVal">20</span><span class="RktCmt"> </span><span class="RktVal">"button-down"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">wanted: </span><span class="RktVal">10</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">given: </span><span class="RktVal">42</span><span class="RktCmt"> </span><span class="RktVal">10</span><span class="RktCmt"> </span><span class="RktVal">20</span><span class="RktCmt"> </span><span class="RktVal">"move"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">wanted: </span><span class="RktVal">42</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hyper</span><span class="hspace">&nbsp;</span><span class="RktSym">x-position-of-car</span><span class="hspace">&nbsp;</span><span class="RktSym">x-mouse</span><span class="hspace">&nbsp;</span><span class="RktSym">y-mouse</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">x-position-of-car</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В примерах говорится, что если строковый аргумент равен <span class="RktVal">"button-down"</span>, функция возвращает <span class="RktSym">x-mouse</span>; в противном случае она возвращает <span class="RktSym">x-position-of-car</span>.</div>

<p></p>

<p><a name="(counter._.D.K._(exercise._car-test-again))"></a><span style="font-weight: bold"> Упражнение</span>&nbsp;44. Сформулируйте примеры как тесты BSL. Нажмите 
<span class="emph">RUN</span> и посмотрите, как они терпят неудачу. 
<a href="#%28counter._.D.K._%28exercise._car-test-again%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Чтобы завершить определение функции, мы должны обратиться к вашим
приятным воспоминаниям из <a href="part_prologue.html" data-pltdoc="x">Пролога: 
Как программировать</a>,
<span class="refelem"><span class="refcolumn"><span class="refcontent">В следующей главе мы подробно расскажем о проектировании с помощью <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> </span></span></span> 
особенно к воспоминаниям об условной форме. Используя <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, <span class="RktSym">hyper</span> - это двухстрочное определение:<a name="(idx._.D.K._(gentag._87._.D.K))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._.D.K._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">places the car at </span><span class="RktSym">x-mouse</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if the given </span><span class="RktSym">me</span><span class="RktCmt"> is </span><span class="RktVal">"button-down"</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">hyper</span><span class="hspace">&nbsp;</span><span class="RktSym">x-position-of-car</span><span class="hspace">&nbsp;</span><span class="RktSym">x-mouse</span><span class="hspace">&nbsp;</span><span class="RktSym">y-mouse</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"button-down"</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x-mouse</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x-position-of-car</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Если вы решили <a href="#%28counter._.D.K._%28exercise._car-test-again%29%29" data-pltdoc="x">упражнение&nbsp;44</a>, запустите программу еще раз и проследите, 
чтобы все тесты прошли успешно. Предполагая, что тесты прошли успешно, вычислите 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">в области взаимодействия DrRacket и перебросьте 
свой автомобиль через гиперпространство. </div>

<p></p>

<p>Вы можете спросить, почему эта модификация программы так проста. На самом деле 
есть две причины. Во-первых, эта книга и ее программное обеспечение строго разделяют 
данные, которые отслеживает программа -  <span style="font-style: italic">модель</span> - 
и изображение, которое она показывает - <span style="font-style: italic">вид</span>. 
В частности, функции, которые имеют дело с событиями, не имеют ничего общего с тем, 
как отображается состояние. Если мы хотим изменить способ визуализации состояния, 
мы можем сосредоточиться на функции, указанной в предложении <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span>. 
Во-вторых, рецепты разработки программ и функций правильно организуют программы. 
Если что-то изменится в постановке проблемы, повторное следование рецепту проектирования естественным образом укажет, где необходимо изменить исходное решение проблемы. 
Хотя это может показаться очевидным для простых проблем, с которыми мы сейчас имеем дело, 
это критически важно для тех проблем, с которыми программисты сталкиваются в реальном мире.
</p>

<h4>3.7<tt>&nbsp;</tt><a name="(part._sec~3azoo1)"></a>Миры виртуальных питомцев</h4>

<p>В этом разделе упражнений представлены первые два элемента игры с виртуальным питомцем. 
Все начинается с изображения кошки, которая продолжает перемещатся по холсту. 
Конечно, все прогулки делают кошку несчастной, и ее несчастье проявляется. 
Как и в случае со всеми домашними животными, вы можете попробовать погладить, 
что некоторым помогает, или вы можете попробовать кормить, что помогает намного больше. 
</p>

<p></p>

<div class="SIntrapara">Итак, давайте начнем с изображения нашей любимой кошки: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cat1</span><span class="hspace">&nbsp;</span><img src="part_one_files/cat1.png" alt="" width="75" height="117"><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Скопируйте изображение кошки и вставьте его в 
DrRacket, затем дайте изображению имя с помощью <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span>, как указано выше.</div>

<p></p>

<p><a name="(counter._(exercise._design12))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;45. Разработайте программный мир - “виртуальный кот“, который непрерывно 
перемещает кошку слева направо. Назовем его <span class="RktSym">cat-prog</span> и 
предположим, что она принимает(использует) начальную позицию кота. 
Кроме того, заставьте кошку перемещаться на три пикселя за такт часов. 
Когда кошка исчезает справа, она снова появляется слева. Вы можете прочитать о функции 
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._modulo%29%29" class="RktValLink" data-pltdoc="x">modulo</a></span>. 
<a href="#%28counter._%28exercise._design12%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._design13))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;46. Улучшите анимацию кота с помощью немного другого изображения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cat2</span><span class="hspace">&nbsp;</span><img src="part_one_files/cat2.png" alt="" width="75" height="117"><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Настройте функцию отрисовки из 
<a href="#%28counter._%28exercise._design12%29%29" data-pltdoc="x">упражнения&nbsp;45</a> 
так, чтобы она использовала то одно изображение кошки, то другое в зависимости от того, 
является ли координата x нечетной. Читать об <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._odd~3f%29%29" class="RktValLink" data-pltdoc="x">odd?</a></span> 
в HelpDesk и используйте выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> для выбора изображения кошки.  
<a href="#%28counter._%28exercise._design13%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._(exercise._design14))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;47. Разработайте программный мир, который поддерживает и отображает 
“шкалу счастья“. Назовем его <span class="RktSym">gauge-prog</span> и согласимся, 
что программа принимает максимальный уровень счастья. Индикация шкалы начинается с 
максимального количества очков, и с каждым тактом часов счастье уменьшается на 
<span class="RktVal"><span class="nobreak">-0</span>.1</span>; она никогда не опускается 
ниже <span class="RktVal">0</span> - минимального балла счастья. Каждый раз, 
когда нажимается клавиша со стрелкой вниз, счастье уменьшается на 
<span class="RktVal">1/5</span>; каждый раз, когда нажимается стрелка вверх, счастье
увеличивается на  <span class="RktVal">1/3</span>.
</p>

<p>Чтобы показать уровень счастья, мы используем сцену со сплошным красным прямоугольником 
с черной рамкой. Если уровень счастья равен 0, красная полоса должна исчезнуть; 
для максимального уровня счастья 100 шкала должна проходить через всю сцену. </p>

<p><span style="font-weight: bold">Примечание</span>. 
Когда вы будете знать достаточно, мы объясним, как совместить программу с указателем счастья,
с решением <a href="#%28counter._%28exercise._design12%29%29" data-pltdoc="x">упражнения
&nbsp;45</a>. Тогда мы сможем помочь кошке, потому что, пока вы ее игнорируете, она становится
менее счастливой. Если погладить кошку, она станет счастливее. Если вы покормите кошку, 
она станет намного счастливее. Итак, вы понимаете, почему вы хотите знать о разработке 
программных миров гораздо больше, чем могут рассказать вам первые три главы.  
<a href="#%28counter._%28exercise._design14%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h3>4<tt>&nbsp;</tt><a name="(part._ch~3aintervals-enums)"></a>Интервалы, перечисления и детализации</h3>

<p>На данный момент у вас есть четыре варианта представления информации в виде данных: 
числа, строки, изображения и логические значения. Для многих задач этого достаточно, 
но есть много других, для которых этих четырех наборов данных на BSL (или других языках
программирования) недостаточно. Настоящим разработчикам нужны дополнительные способы 
представления информации в виде данных. </p>

<p>Как минимум, хорошие программисты должны научиться разрабатывать программы 
с ограничениями на эти встроенные коллекции. Один из способов ограничения - 
перечислить кучу элементов из коллекции и сказать, что они единственные(т.е. только они), 
которые будут использоваться для решения какой-либо проблемы. 
Перечисление элементов работает только тогда, когда их конечное число. 
Чтобы разместить коллекции с “бесконечным“ количеством элементов, 
мы вводим интервалы, которые представляют собой наборы элементов, удовлетворяющих 
определенному свойству. </p>

<p><span class="refelem"><span class="refcolumn"><span class="refcontent">Бесконечный может 
просто означать ”настолько большой, что перечислять элементы совершенно непрактично”</span></span></span></p>

<p>Определение перечислений и интервалов означает различение элементов разных типов. 
Чтобы различать в коде, требуются условные функции, то есть функции, которые выбирают 
разные способы вычисления результатов в зависимости от значения некоторого аргумента. 
Оба и <a href="part_prologue.html#%28part._pro-cond%29" data-pltdoc="x">Множество способов 
вычисления</a>, и  <a href="#%28part._sec~3aboolean-if%29" data-pltdoc="x">Смешивание их с логическими значениями</a> иллюстрируются на примерах того, как писать такие функции. 
Однако ни один из разделов не использует разработку. Оба просто представляют новую конструкцию 
на вашем любимом языке программирования (это BSL) и предлагают несколько примеров того, 
как ее использовать. </p>

<p>В этой главе мы обсуждаем общее проектирование перечислений и интервалов, 
новые формы описания данных. Начнем со второго взгляда на выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
Затем мы рассмотрим три различных типа описаний данных: перечисления, интервалы и 
детализации. Перечисление перечисляет каждую отдельную часть данных, которая ему принадлежит, 
а интервал определяет диапазон данных. Последний, детализация, смешивает первые два, 
указывая диапазоны в одном пункте своего определения и конкретные фрагменты данных в другом.
Глава заканчивается общей стратегией проектирования для таких ситуаций. </p>

<h4>4.1<tt>&nbsp;</tt><a name="(part._sec~3acond)"></a>Программирование с условными выражениями(COND)
</h4>

<p></p>

<div class="SIntrapara">Вспомните краткое введение в условные выражения в 
<a href="part_prologue.html" data-pltdoc="x">Прологе: Как программировать</a>. 
Поскольку <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> - самая сложная форма выражения в этой книге, 
давайте внимательно рассмотрим ее общую форму: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVar">ConditionExpression1</span><span class="hspace">&nbsp;</span><span class="RktVar">ResultExpression1</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVar">ConditionExpression2</span><span class="hspace">&nbsp;</span><span class="RktVar">ResultExpression2</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="refelem"><span class="refcolumn"><span class="refcontent">Прямоугольные скобки просто
выделяют <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> строки. Можно использовать <span class="stt">( ... )</span> вместо <span class="stt">[ ... ]</span>.</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVar">ConditionExpressionN</span><span class="hspace">&nbsp;</span><span class="RktVar">ResultExpressionN</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>
<div class="SIntrapara">Выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> начинается с <span class="stt">(cond</span>,
его ключевого слова и заканчивается на <span class="stt">)</span>. 
Следом за ключевым словом, программист записывает столько <span style="font-style: italic"><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> строк</span>, столько сколько необходимо; 
каждая строка <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> состоит из <span style="font-weight: bold">двух</span> выражений,
заключенных в открывающую и закрывающую скобки: <span class="stt">[</span> и <span class="stt">]</span>.</div>

<p></p>

<p>Строка <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> также известна как 
<span style="font-style: italic">условие cond</span>.</p>

<p></p>

<div class="SIntrapara">Вот определение функции, в которой используется условное выражение: 
 <a name="(idx._(gentag._88))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">next</span><span class="hspace">&nbsp;</span><span class="RktSym">traffic-light-state</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="hspace">&nbsp;</span><span class="RktSym">traffic-light-state</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="hspace">&nbsp;</span><span class="RktSym">traffic-light-state</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="hspace">&nbsp;</span><span class="RktSym">traffic-light-state</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как и математический пример в 
<a href="part_prologue.html" data-pltdoc="x">Прологе: Как программировать</a>, 
этот пример иллюстрирует удобство использования выражений <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
Во многих контекстах проблемы функция должна различать несколько различных ситуаций. 
С помощью выражения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> вы можете использовать одну строку для каждой возможности и,
таким образом, напоминать читателю о коде для различных ситуаций из постановки задачи. </div>

<p></p>

<p>Замечание о прагматике: сравните выражения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> с выражениями 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span> из <a href="#%28part._sec~3aboolean-if%29" data-pltdoc="x">Смешаем всё вышесказанное с логическими значениями</a>. 
Последние отличают одну ситуацию от всех остальных. Таким образом, выражения 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span> гораздо менее подходят для контекстов с несколькими ситуациями; 
их лучше всего использовать, когда все, что мы хотим сказать, - “одно или другое“. 
Поэтому мы всегда используем <span style="font-weight: bold">always</span> use
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> для ситуаций, когда мы хотим напомнить читателю нашего кода, 
что некоторые отдельные ситуации возникают непосредственно из определений данных. 
Для других фрагментов кода мы используем любую наиболее удобную конструкцию. </p>

<p>Когда условия становятся слишком сложными в выражении <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, 
вы иногда хотите сказать что-то вроде "во всех других случаях". 
Для такого рода проблем выражения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> позволяют использовать ключевое слово 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span> для самой последней строки <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>: </p>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVar">ConditionExpression1</span><span class="hspace">&nbsp;</span><span class="RktVar">ResultExpression1</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVar">ConditionExpression2</span><span class="hspace">&nbsp;</span><span class="RktVar">ResultExpression2</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVar">DefaultResultExpression</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Если вы допустили ошибку, используя <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span> в какой-либо другой строке <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, BSL в DrRacket сигнализирует об ошибке:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr><tr><td>

<p><span class="RktErr">cond:found an else clause that isn't the last clause in its cond expression</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">То есть BSL 
отвергает грамматически неправильные фразы, потому что нет смысла выяснять, 
что такая фраза может означать. </div>

<p></p>

<p></p>

<div class="SIntrapara">Представьте себе разработку функции, которая как часть 
игровой программы вычисляет некоторую награду в конце игры. 
Вот его заголовок: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._positivenumber)"></a><span style="font-style: italic">PositiveNumber</span><span class="RktCmt"> is a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> greater than/equal to </span><span class="RktVal">0</span><span class="RktCmt">. </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._positivenumber%29" class="techoutside" data-pltdoc="x"><span class="techinside">PositiveNumber</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the reward level from the given score </span><span class="RktSym">s</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">А вот два варианта для параллельного сравнения:  <a name="(idx._(gentag._89))"></a>
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reward</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reward</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Вариант слева использует <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> с тремя полноценными условиями; справа функция поставляется 
с предложением <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span>. 
Чтобы сформулировать последнее условие для функции слева, вы должны вычислить, что <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="stt"> </span><span class="RktVal">20</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span> выполняется, потому что 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym">s</span> входит в <a href="#%28tech._positivenumber%29" class="techoutside" data-pltdoc="x"><span class="techinside">PositiveNumber</span></a></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="stt"> </span><span class="RktVal">0</span><span class="stt"> </span><span class="RktSym">s</span><span class="stt"> </span><span class="RktVal">10</span><span class="RktPn">)</span> это <span class="RktVal">#false</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="stt"> </span><span class="RktVal">10</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="stt"> </span><span class="RktSym">s</span><span class="stt"> </span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span> также вычисляется в <span class="RktVal">#false</span>.</p>

</li></ul></div><div class="SIntrapara">Хотя в данном случае расчет выглядит простым, 
легко сделать небольшие ошибки и внести ошибки в вашу программу. 
Поэтому лучше сформулировать определение функции, как показано справа,
 <span style="font-weight: bold">если</span> вы знаете, 
что вам нужна полная противоположность - называемая <span style="font-style: italic">complement(дополнением)</span> - всех предыдущих условий в <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>.</div>

<p></p>

<h4>4.2<tt>&nbsp;</tt><a name="(part._sec~3aworks)"></a>Условные вычисления</h4>

<p></p>

<div class="SIntrapara">Из прочитанных 
<a href="part_prologue.html#%28part._pro-cond%29" data-pltdoc="x">Множество путей вычисления</a>
и <a href="#%28part._sec~3aboolean-if%29" data-pltdoc="x">Смешаем все вышесказанное с 
логическими значениями</a>, вы примерно знаете, как DrRacket вычисляет условные выражения.
Давайте более подробно рассмотрим идею выражений <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
Взгляните еще раз на это определение: <a name="(idx._(gentag._90))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reward</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Эта функция использует 
числовой отсчет - положительное число - и производит(выдает) цвет. </div>

<p></p>

<p>Просто глядя на выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, вы не можете предсказать, какое из трех предложений 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> будет использоваться. И в этом суть функции. 
Функция имеет дело со многими различными входами, например, <span class="RktVal">2</span>, <span class="RktVal">3</span>, <span class="RktVal">7</span>, <span class="RktVal">18</span>,
 <span class="RktVal">29</span>. 
Для каждого из этих входов может потребоваться действовать по-разному. Цель выражения 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> - различать различные классы входных данных. </p>

<p></p>

<div class="SIntrapara">Взять, например, 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym">reward</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Вы знаете, что DrRacket заменяет применение функции
телом функции после подстановки аргумента для параметра. Следовательно, 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">reward</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">say </span><span class="RktCmt">“</span><span class="RktCmt">equals</span><span class="RktCmt">”</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">На этом этапе DrRacket вычисляет одно условие за раз.
Для <span style="font-weight: bold">первогоt</span>, получившего значение 
<span class="RktVal">#true</span>, он продолжает с результатом выражения:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">reward</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">#true</span><span class="hspace">&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktVal">"bronze"</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Здесь первое условие выполняется, потому что 
<span class="RktVal">3</span> находится между  <span class="RktVal">0</span> и
<span class="RktVal">10</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Вот второй пример: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">reward</span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktVal">"bronze"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Обратите внимание, что первое условие на этот раз
вычисляется как <span class="RktVal">#false</span>, и, как упоминалось в разделе 
<a href="part_prologue.html#%28part._pro-cond%29" data-pltdoc="x">Многие способы вычисления</a>,
предложение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> полностью отбрасывается. 
Остальные вычисления выполняются, как и ожидалось: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">21</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktVal">"silver"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktVal">"gold"</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как и первое условие, 
второе условие также вычисляется как <span class="RktVal">#false</span>, и, таким образом,
вычисление переходит к третьей строке span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span> указывает DrRacket заменить все выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> ответом из этого предложения. </div>

<p></p>

<p><a name="(counter._(exercise._cond1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;48. Введите определение <span class="RktSym">reward</span>(вознаграждения), 
за которым следует <span class="RktPn">(</span><span class="RktSym">reward</span><span class="stt"> </span><span class="RktVal">18</span><span class="RktPn">)</span>, 
в область определений DrRacket и используйте степпер, чтобы узнать, 
<span style="font-weight: bold">как</span> DrRacket 
вычисляет применение функции. 
 <a href="#%28counter._%28exercise._cond1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._cond1-nested))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;49. Выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> на 
самом деле является просто выражением и поэтому может появиться в середине другого выражения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Используйте степпер, чтобы вычислить выражение для 
<span class="RktSym">y</span> как <span class="RktVal">100</span> и 
<span class="RktVal">210</span>.
<a name="(idx._(gentag._91))"></a></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3av5-from-prologue))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">60</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MTSCN</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><img src="part_one_files/rocket.png" alt="" width="28" height="42"><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET-CENTER-TO-TOP</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">create-rocket-scene.v5</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET-CENTER-TO-TOP</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktSym">MTSCN</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">h</span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET-CENTER-TO-TOP</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET-CENTER-TO-TOP</span><span class="hspace">&nbsp;</span><span class="RktSym">MTSCN</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;20: </span>Напомним из <a href="part_prologue.html#%28part._pro-many-def%29" data-pltdoc="x">Одна Программа, Много Определений</a></span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Вложенные выражения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> могут устранить общие выражения. 
Рассмотрим функцию запуска ракеты, повторенную на <a href="#%28counter._%28figure._fig~3av5-from-prologue%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">20</span></a>. 
Обе ветви выражения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> имеют одинаковую форму, за исключением того, что обозначено 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktSym">X</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MTSCN</span><span class="RktPn">)</span></p>

</blockquote></div>

<p></p>

<p>Переформулируйте <span class="RktSym">create-rocket-scene.v5</span>, чтобы использовать
<span class="RktSym">вложенное</span> выражение; результирующая функция упоминает 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span> только один раз.   
<a href="#%28counter._%28exercise._cond1-nested%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>4.3<tt>&nbsp;</tt><a name="(part._sec~3aenums)"></a>Перечисления</h4>

<p></p>

<div class="SIntrapara">Не все строки представляют события мыши. Если вы заглянули в HelpDesk, когда последний раздел знакомил с предложением <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-mouse%29%29" class="RktStxLink" data-pltdoc="x">on-mouse</a></span> для 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, вы могли видеть, что только шесть строк используются для уведомления программ о событиях мыши:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mouseevt)"></a><span style="font-style: italic">MouseEvt</span><span class="RktCmt"> is one of these </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt">s:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"button-down"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"button-up"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"drag"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"move"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"enter"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"leave"</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara"> Интерпретация этих строк довольно очевидна. Одна из первых двух строк
появляется, когда пользователь компьютера нажимает кнопку мыши или отпускает ее. 
Напротив, третья и четвертая - о перемещении мыши и, возможно, об одновременном 
удерживании кнопки мыши. Наконец, последние две строки представляют события, 
когда мышь перемещается по краю холста: либо заходит на холст(канву) извне, либо выходит 
с холста. </div>

<p></p>

<p></p>

<div class="SIntrapara">Что еще более важно, определение данных для представления 
событий мыши в виде строк сильно отличается от определений данных, которые мы видели 
до сих пор. Оно называется <span style="font-style: italic">enumeration(перечислением)</span>,
и это представление данных, в котором перечислены все возможности. Неудивительно, что перечисления являются обычным явлением. Вот простой случай: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._trafficlight)"></a><span style="font-style: italic">TrafficLight</span><span class="RktCmt"> is one of the following </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt">s:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"red"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"green"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"yellow"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> the three strings represent the three </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">possible states that a traffic light may assume </span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Это упрощенное 
<span class="refelem"><span class="refcolumn"><span class="refcontent">Мы называем его “упрощенным“, потому что оно не включает состояние
“(off)выключено“, состояние “blinking red(мигающий красный)” или “blinking
yellow(мигающий желтый)”. </span></span></span> 
представление состояний, которые может принимать светофор. В отличие от других, 
это определение данных также использует несколько иную фразу, чтобы объяснить, 
что означает термин <a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>, но это несущественная разница.</div>

<p></p>

<p></p>

<div class="SIntrapara">Программирование с помощью перечислений в основном несложно. 
Когда входные данные функции представляют собой класс данных, в описании которых 
описываются его элементы для каждого конкретного случая, функция должна различать 
только эти случаи и вычислять результат для каждого случая. Например, если вы хотите 
определить функцию, которая вычисляет следующее состояние светофора, учитывая 
текущее состояние как элемент <a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>, вы придумали бы 
такое определение: <a name="(idx._(gentag._92))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">yields the next state given current state </span><span class="RktSym">s</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">traffic-light-next</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">traffic-light-next</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Поскольку определение данных 
для <a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a> состоит из трех отдельных элементов, 
функция <span class="RktSym">traffic-light-next</span> естественным образом различает 
три разных случая. Для каждого случая результирующее выражение - это просто другая строка,
соответствующая следующему случаю. </div>

<p></p>

<p><a name="(counter._(exercise._cond2))"></a><span style="font-weight: bold">Упражнение/span>&nbsp;50. Если вы скопируете и вставите указанное выше определение функции в 
область определений DrRacket и нажмете <span class="emph">RUN</span>, DrRacket выделит 
две из трех <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> линий. Эта раскраска скажет вам, что ваши тестовые примеры 
не охватывают полное условие <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. Добавьте достаточно проверок, 
чтобы DrRacket был доволен.
 <a href="#%28counter._%28exercise._cond2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._cond3))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;51. Разработайте программу <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, которая имитирует светофор
в течении заданного времени. Программа отображает состояние светофора в виде
сплошного круга соответствующего цвета и меняет состояние при каждом такте часов.
<span style="font-weight: bold">Подсказка</span> Прочтите документацию по
 <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>; есть причина, по которой все
эти “слова” связаны с их документацией. Какое начальное состояние наиболее
подходяще? Спросите своих друзей-инженеров. 
<a href="#%28counter._%28exercise._cond3%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>Основная идея Перечисления состоит в том, что оно определяет набор данных
как  <span style="font-weight: bold">конечное</span> число фрагментов данных. 
Каждый элемент явно указывает, какая часть данных принадлежит к классу данных,
который мы определяем. Обычно часть данных отображается как есть; 
в некоторых случаях элемент перечисления представляет собой предложение на английском
языке, которое описывает конечное число элементов данных с помощью одной фразы.
</p>

<p></p>

<div class="SIntrapara">Вот важный пример:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._1string)"></a><span style="font-style: italic">1String</span><span class="RktCmt"> is a </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> of length </span><span class="RktVal">1</span><span class="RktCmt">, </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">including</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"\\"</span><span class="RktCmt"> (the backslash),</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">" "</span><span class="RktCmt"> (the space bar), </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"\t"</span><span class="RktCmt"> (tab),</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"\r"</span><span class="RktCmt"> (return), and </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"\b"</span><span class="RktCmt"> (backspace).</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> represents keys on the keyboard</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Вы знаете, что такое
определение данных является правильным, если вы можете описать все его элементы с
помощью теста BSL. В случае <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>, вы можете узнать,
принадлежит ли некоторая строка <span class="RktSym">s</span> коллекции с помощью
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Альтернативный способ проверить, что вы 
преуспели, это перечислить все элементы коллекции данных, которые вы хотите описать:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><span style="font-style: italic">1String</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"q"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"w"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"e"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"r"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span>...</td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"\t"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"\r"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"\b"</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Если вы посмотрите на клавиатуру, вы найдете <span class="RktInBG"><span class="hspace"></span><span class="RktIn">←</span><span class="hspace"></span></span>, <span class="RktInBG"><span class="hspace"></span><span class="RktIn">↑</span><span class="hspace"></span></span>, и другие аналогичные обозначения.
Выбранный нами язык программирования BSL использует собственное определение данных для
представления этой информации:<span class="refelem"><span class="refcolumn"><span class="refcontent">Вы знаете, где найти полное определение.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._keyevent)"></a><span style="font-style: italic">KeyEvent</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"left"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"right"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"up"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span>...</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Первый элемент в этом перечислении
описывает ту же группу строк, которую описывает <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>. Следующие предложения перечисляют
строки для событий специальных клавиш, таких как нажатие одной из четырех клавиш
со стрелками или отпускание клавиши.</div>

<p></p>

<p></p>

<div class="SIntrapara">На этом этапе мы действительно можем систематически спроектировать
обработчик клавиатурных событий.
Вот набросок:  <a name="(idx._(gentag._93))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> </span><a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a><span class="RktCmt"> -&gt; </span>...</td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">handle-key-events</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"left"</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"right"</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"up"</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"down"</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Эта функция обработки событий использует
выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, и для каждой строки в перечислении есть одна строка
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. Условие в первой строке <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> 
идентифицирует <a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a>, идентифицированное в первой строке перечисления,
второе предложение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> соответствует второй строке перечисления данных и
так далее.
<a name="(idx._(gentag._94))"></a></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3acond-enum))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._position)"></a><span style="font-style: italic">Position</span><span class="RktCmt"> is a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> distance between the left margin and the ball </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._position%29" class="techoutside" data-pltdoc="x"><span class="techinside">Position</span></a><span class="RktCmt"> </span><a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._position%29" class="techoutside" data-pltdoc="x"><span class="techinside">Position</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the next location of the ball </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">keh</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="hspace">&nbsp;</span><span class="RktVal">"left"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">keh</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="hspace">&nbsp;</span><span class="RktVal">"right"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">18</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">keh</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span></td></tr></tbody></table><table cellspacing="0" cellpadding="0"><tbody><tr><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">keh</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-length%29%29" class="RktValLink" data-pltdoc="x">string-length</a></span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">p</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"left"</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"right"</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td><td>

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">keh</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"left"</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"right"</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;21: </span>Условные функции и специальные перечисления
</span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Когда программы полагаются на определения данных, которые
поставлялются с выбранным языком программирования (таким как BSL) или его библиотеками
(таким как <span class="sroman"> библиотека <span class="Smaller"><span style="font-style: italic">2htdp/universe</span></span></span>),
 обычно они используют только часть перечисления.
Чтобы проилюстрировать этот момент, давайте рассмотрим типичную проблему.
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример проблемы</span> Создайте обработчик
событий нажатия клавиш, который перемещает красную точку влево или вправо
по горизонтальной линии в ответ на нажатие клавиш со стрелками влево и вправо.
</p>

</blockquote></div><div class="SIntrapara">На <a href="#%28counter._%28figure._fig~3acond-enum%29%29" data-pltdoc="x">Рисунке&nbsp;<span class="FigureRef">21</span></a> представлены <span style="font-weight: bold">два</span> решения этой проблемы.
 Функция с лева организована в соответствии с основной идеей использования одного предложения
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> для одной строки в определении входных данных
 <a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a>. Напротив, с правой стороны отображена версия,
в которой имеются три основные строки: для для клавиш, которые имеют значение, и одна
для всего остального. Переупорядочивание уместно потому что только две строки
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> являются релевантными, и их можно четко отделить от других строк.
Естественно, такая перестановка происходит  <span style="font-weight: bold">после</span> 
того, как функция спроектирована должным образом.</div>

<p></p>

<h4>4.4<tt>&nbsp;</tt><a name="(part._sec~3aintervals)"></a>Интервалы</h4>

<p></p>

<div class="SIntrapara">Представьте, что вы отвечаете на следующий пример задачи по разработке:
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> Создайте программу, 
имитирующую спуск НЛО.</p>

</blockquote></div><div class="SIntrapara">Поразмыслив, можно придумать что-то вроде 
<a href="#%28counter._%28figure._fig~3aufo%29%29" data-pltdoc="x">рисунка&nbsp;<span class="FigureRef">22</span></a>. Стоп! Изучите определения и замените точки, 
прежде чем читать дальше.  
<a name="(idx._(gentag._95))"></a> <a name="(idx._(gentag._96))"></a> <a name="(idx._(gentag._97))"></a></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3aufo))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._worldstate)"></a><span style="font-style: italic">WorldState</span><span class="RktCmt"> is a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt">.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> number of pixels between the top and the UFO</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktVal">300</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">distances in terms of pixels </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MTSCN</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">UFO</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">nxt</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">render</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes next location of </span><span class="RktSym">UFO</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nxt</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">14</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nxt</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">places </span><span class="RktSym">UFO</span><span class="RktCmt"> at given height into the center of </span><span class="RktSym">MTSCN</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">UFO</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktSym">MTSCN</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">UFO</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">MTSCN</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;22: </span>Спускающийся НЛО</span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Однако перед выпуском этой "игровой" программы вы можете добавить
отображение строки состояния на холст:
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> Добавьте строку состояния. 
Она говорит <span class="RktVal">"спуск"</span>, когда высота НЛО превышает одну треть высоты холста. Ниже она переключается на <span class="RktVal">"приближаемся"</span>. И, наконец, 
когда НЛО достигает нижней части холста, статус уведомляет игрока о том, что НЛО 
<span class="RktVal">"приземлился"</span>. Вы можете использовать соответствующие цвета 
для строки состояния. </p>

</blockquote></div>

<p></p>

<p>В этом случае у нас нет конечного перечисления отдельных элементов или 
отдельных подклассов данных. В конце концов, теоретически интервал между 
<span class="RktVal">0</span> и <span class="RktSym">HEIGHT</span> (для некоторого числа 
больше 0) содержит бесконечное количество чисел и большое количество целых чисел. 
Поэтому мы используем интервалы, чтобы наложить некоторую организацию на 
определение общих данных, которая просто использует “числа“ для описания 
класса координат. </p>

<p><span style="font-style: italic">Интервал</span> - это описание класса чисел 
через границы. Самый простой интервал имеет две границы: левую и правую. 
Если левую границу нужно включить в интервал, мы говорим, что он 
<span style="font-style: italic">закрыт</span> слева. 
Точно так же закрытый справа интервал включает свою правую границу. Наконец, 
если интервал не включает границу, он называется 
<span style="font-style: italic">открытым</span> на этой границе. 
</p>

<p></p>

<div class="SIntrapara">В изображениях и обозначениях интервалов используются 
квадратные скобки для закрытых границ и круглые скобки для открытых границ. 
Вот четыре таких интервала: 
</div><div class="SIntrapara"><ul><li>

<p><span style="font-style: italic"></span>[<span style="font-style: italic"></span>3<span style="font-style: italic">,</span>5<span style="font-style: italic"></span>]<span style="font-style: italic"></span> это закрытый интервал:</p>

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_53.png" alt="image" width="258.0" height="51.2390625"></p>

</li><li>

<p><span style="font-style: italic"></span>(<span style="font-style: italic"></span>3<span style="font-style: italic">,</span>5<span style="font-style: italic"></span>]<span style="font-style: italic"></span> это открытый с лева интервал:</p>

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_54.png" alt="image" width="258.0" height="51.2390625"></p>

</li><li>

<p><span style="font-style: italic"></span>[<span style="font-style: italic"></span>3<span style="font-style: italic">,</span>5<span style="font-style: italic"></span>)<span style="font-style: italic"></span> это открытый с права интервал:</p>

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_55.png" alt="image" width="258.0" height="51.2390625"></p>

</li><li>

<p>and <span style="font-style: italic"></span>(<span style="font-style: italic"></span>3<span style="font-style: italic">,</span>5<span style="font-style: italic"></span>)<span style="font-style: italic"></span> это открытый интервал:</p>

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_56.png" alt="image" width="258.0" height="51.2390625"></p>

</li></ul></div>

<p></p>

<p><a name="(counter._(exercise._cond4))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;52.  Какие целые числа содержатся в четырех указанных выше интервалах? <a href="#%28counter._%28exercise._cond4%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Концепция интервала помогает нам сформулировать определение данных,
которое лучше отражает пересмотренную постановку задачи, чем определение, 
основанное на “числах“: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A WorldState falls into one of three intervals: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> between </span><span class="RktVal">0</span><span class="RktCmt"> and </span><span class="RktSym">CLOSE</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> between </span><span class="RktSym">CLOSE</span><span class="RktCmt"> and </span><span class="RktSym">HEIGHT</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> below </span><span class="RktSym">HEIGHT</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>В частности, есть три интервала, которые мы можем изобразить следующим образом: </p>

<p></p>

<div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: -1.5px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_57.png" alt="image" width="91.891845703125" height="123.36328125"></p>

</blockquote></div><div class="SIntrapara">Вы видите стандартную числовую линию(ось), 
повернутую вертикально и разбитую на интервалы. Каждый интервал начинается с угловой скобки,
(<img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_58.png" alt="image" width="28" height="11">) указывающей вниз, и заканчивается скобкой, указывающей вверх
(<img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_59.png" alt="image" width="28.0" height="11.0">). На картинке таким образом выделены три интервала: 
</div><div class="SIntrapara"><ul><li>

<p>верхний интервал идет от <span class="RktVal">0</span> до <span class="RktSym">CLOSE</span>;</p>

</li><li>

<p>средний начинается с <span class="RktSym">CLOSE</span> и достигает
<span class="RktSym">HEIGHT</span>;
<span class="refelem"><span class="refcolumn"><span class="refcontent">На простой числовой 
оси последний интервал начинается с <span class="RktSym">HEIGHT</span> и 
продолжается бесконечно. </span></span></span> и </p>

</li><li>

<p>нижний, невидимый интервал - это всего лишь одна линия на уровне
<span class="RktSym">HEIGHT</span>.</p>

</li></ul></div>

<p></p>

<p>Визуализация определения данных таким образом помогает при разработке 
функций двумя способами. Во-первых, сразу подсказывает, как подбирать примеры. 
Естественно, что мы хотим, чтобы функция работала внутри всех интервалов, 
и мы хотим, чтобы функция работала правильно в конце каждого интервала. 
Во-вторых, изображение говорит нам, что нам нужно сформулировать условие, 
которое определяет, находится ли некоторая “точка“ в пределах одного из интервалов. 
</p>

<p>Соединение их вместе также поднимает вопрос, а именно, как именно функция работает с 
конечными точками. В контексте нашего примера две точки на числовой прямой относятся к 
двум интервалам: <span class="RktSym">CLOSE</span> принадлежит как верхнему интервалу, 
так и среднему, а <span class="RktSym">HEIGHT</span>, кажется, попадает как в средний, 
так и в нижний интервал. Такие совпадения обычно вызывают проблемы для программ, 
и их следует избегать.</p>

<p></p>

<div class="SIntrapara">Функции BSL избегают их естественным образом из-за способа 
вычисления выражений <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
Рассмотрим эту естественную организацию функции, которая потребляет(принимает) элементы 
<span class="RktSym">WorldState</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">f</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Три <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> линии 
соответствуют трем интервалам. Каждое условие определяет те значения 
<span class="RktSym">y</span>, которые находятся в пределах интервалов. Однако из-за способа, которым линии <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> проверяются одна за другой, значение 
<span class="RktSym">y</span>, равное <span class="RktSym">CLOSE</span>, заставляет BSL выбирать первую строку <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, а значение <span class="RktSym">y</span>, равное 
<span class="RktSym">HEIGHT</span>, запускает вычисление второго 
<span class="RktVar">ResultExpression</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Если бы мы хотели сделать этот выбор очевидным и незамедлительным 
для каждого читателя нашего кода, мы бы использовали другие условия: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Обратите внимание на то, как во второй строке <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> используется 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span> для объединения строго меньшей проверки с проверкой 
"меньше или равно" вместо <span class="RktSym">f</span>’s <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span> 
тремя аргументами. 
<a name="(idx._(gentag._98))"></a></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3arender-status))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds a status line to the scene created by </span><span class="RktSym">render</span><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render/status</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"descending"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render/status</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"descending"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"closing in"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"orange"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"landed"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Figure&nbsp;23: </span>Rendering with a status line</span></p>

</blockquote>

<p>Учитывая все это, мы можем завершить определение функции, которая добавляет 
запрошенную строку состояния к нашей анимации НЛО; см. <a href="#%28counter._%28figure._fig~3arender-status%29%29" data-pltdoc="x">рисунок&nbsp;<span class="FigureRef">23</span></a> для полного определения. Функция использует выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, чтобы различать три интервала. В каждом предложении 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> <span class="RktVar">ResultExpression</span> использует 
<span class="RktSym">render</span> (из <a href="#%28counter._%28figure._fig~3aufo%29%29" data-pltdoc="x">рисунка&nbsp;<span class="FigureRef">22</span></a>) для создания изображения 
с опускающимся НЛО, а затем помещает соответствующий текст в позицию 
<span style="font-style: italic"></span>(<span style="font-style: italic"></span>1<span style="font-style: italic"></span>0<span style="font-style: italic">,</span>1<span style="font-style: italic"></span>0<span style="font-style: italic"></span>)<span style="font-style: italic"></span> с 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span>.</p>

<p></p>

<div class="SIntrapara">Чтобы запустить эту версию, вам нужно немного изменить 
<span class="RktSym">main</span> с  
<a href="#%28counter._%28figure._fig~3aufo%29%29" data-pltdoc="x">рисунка&nbsp;<span class="FigureRef">22</span></a>: 
<a name="(idx._(gentag._99))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">nxt</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">render/status</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Один аспект этого определения функции может вас беспокоить, 
и чтобы прояснить, почему, давайте немного уточним приведенный выше пример задачи: 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример задачи</span> Добавьте строку состояния в 
<span style="font-weight: bold">позицию <span style="font-style: italic"></span>(<span style="font-style: italic"></span>2<span style="font-style: italic"></span>0<span style="font-style: italic">,</span>2<span style="font-style: italic"></span>0<span style="font-style: italic"></span>)<span style="font-style: italic"></span></span>, в которой написано 
“descending(нисходящий)”, когда высота НЛО превышает одну треть высоты канвы(холста).  ...</p>

</blockquote></div><div class="SIntrapara">Это может быть ответ клиента, 
который впервые посмотрел вашу анимацию.  
<a name="(idx._(gentag._100))"></a></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3arender-status2))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._worldstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">WorldState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds a status line to the scene created by </span><span class="RktSym">render</span><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render/status</span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"closing in"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"orange"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render/status</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"descending"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSE</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"closing in"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"orange"</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e%29%29" class="RktValLink" data-pltdoc="x">&gt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"landed"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">render</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;24: </span>Отрисовка со строкой состояния, исправленная</span></p>

</blockquote>

<p>На этом этапе у вас нет другого выбора, кроме как изменить функцию отображения статуса 
<span class="RktSym">render/status</span> в <span style="font-weight: bold">шести</span> 
разных местах, потому что у вас есть три копии одной внешней части информации: 
местоположения строки состояния. Чтобы избежать многократных изменений одного элемента,
программисты стараются избегать копий. У вас есть два варианта решения этой проблемы. 
Первый - использовать определения констант, которые вы, возможно, помните из первых глав. 
Второй - думать о выражении <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> как о выражении, которое может появляться где угодно в функции, 
в том числе в середине некоторого другого выражения; см. 
<a href="#%28counter._%28figure._fig~3arender-status2%29%29" data-pltdoc="x">рисунок&nbsp;<span class="FigureRef">24</span></a> и сравните с 
a href="#%28counter._%28figure._fig~3arender-status%29%29" data-pltdoc="x">рисунком&nbsp;<span class="FigureRef">23</span></a>. В этом пересмотренном определении 
<span class="RktSym">render/status</span> выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> является 
первым аргументом для <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span>. Как видите, результатом всегда является изображение
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span>(текста), которое помещается в позицию 
<span style="font-style: italic"></span>(<span style="font-style: italic"></span>2<span style="font-style: italic"></span>0<span style="font-style: italic">,</span>2<span style="font-style: italic"></span>0<span style="font-style: italic"></span>)<span style="font-style: italic"></span> в изображение, созданное с помощью 
 <span class="RktPn">(</span><span class="RktSym">render</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span>.</p>

<h4>4.5<tt>&nbsp;</tt><a name="(part._itemization._sec~3aitemization)"></a>Детализации</h4>

<p>Интервал выделяет разные подклассы чисел, что в принципе является бесконечно 
большим классом. Перечисление определяет элемент для элемента полезных элементов 
существующего класса данных. Некоторые определения данных должны включать элементы 
из них обоих. Они используют <span style="font-style: italic">детализации</span>, 
которые обобщают интервалы и перечисления. Они позволяют комбинировать любые уже 
определенные классы данных друг с другом и с отдельными частями данных. </p>

<p>Рассмотрим следующий пример - переписывание важного определения данных из
<a href="#%28part._sec~3aenums%29" data-pltdoc="x">Перечисления</a>:</p>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._itemization._keyevent)"></a><span style="font-style: italic">KeyEvent</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"left"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"right"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"up"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span>...</td></tr></tbody></table></blockquote></div><div class="SIntrapara">В этом случае определение данных <span class="RktSym">KeyEvent</span> относится к определению данных 
<a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>. Поскольку функции, которые имеют дело с 
<a href="#%28tech._itemization._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a>s, часто имеют дело с <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>s отдельно 
от остальных и делают это с вспомогательными функциями, теперь у нас есть удобный способ 
выразить сигнатуры и для этих функций. </div>

<p></p>

<p></p>

<div class="SIntrapara">Описание примитива <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span> использует идею детализации сложным образом. 
Его сигнатура <a name="(idx._itemization._(gentag._101._itemization))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._itemization._norf%29" class="techoutside" data-pltdoc="x"><span class="techinside">NorF</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">converts the given string into a number;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">produces </span><span class="RktVal">#false</span><span class="RktCmt"> if impossible </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">означает, что сигнатура результата именует простой класс данных: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._itemization._norf)"></a><span style="font-style: italic">NorF</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">#false</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Эта детализация объединяет один фрагмент данных 
(<span class="RktVal">#false</span>) с большим и отличным классом данных (Number). 
</div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь представьте функцию, которая принимает результат 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span> и добавляет <span class="RktVal">3</span>,
обрабатывая <span class="RktVal">#false</span>, как если бы это было <span class="RktVal">0</span>:
<a name="(idx._itemization._(gentag._102._itemization))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._itemization._norf%29" class="techoutside" data-pltdoc="x"><span class="techinside">NorF</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktVal">3</span><span class="RktCmt"> to the given number; </span><span class="RktVal">3</span><span class="RktCmt"> otherwise</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add3</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add3</span><span class="hspace">&nbsp;</span><span class="RktVal">0.12</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3.12</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">add3</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._false~3f%29%29" class="RktValLink" data-pltdoc="x">false?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Как и выше, тело функции состоит из выражения  <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> с таким количеством предложений, 
сколько имеется элементов в перечислении определения данных. 
Первое предложение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> распознает, когда функция применяется к 
<span class="RktVal">#false</span>; соответствующий результат - по запросу <span class="RktVal">3</span>. Второе предложение касается чисел и добавляет 
 <span class="RktVal">3</span> по мере необходимости. </div>

<p></p>

<p>Давайте изучим несколько более целенаправленную задачу разработки: </p>

<blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> Разработайте программу, 
которая запускает ракету, когда пользователь вашей программы нажимает клавишу пробела. 
Программа сначала отображает ракету, стоящую внизу холста. После запуска она перемещается 
вверх со скоростью три пикселя за такт. </p>

</blockquote>

<p></p>

<div class="SIntrapara">Эта исправленная версия предлагает представление с двумя классами состояний:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._itemization._lr)"></a><span style="font-style: italic">LR</span><span class="RktCmt"> (short for </span><span style="font-style: italic">launching rocket</span><span class="RktCmt">) is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"resting"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._nonnegativenumber%29" class="techoutside" data-pltdoc="x"><span class="techinside">NonnegativeNumber</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktVal">"resting"</span><span class="RktCmt"> represents a grounded rocket</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">a number denotes the height of a rocket in flight</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Хотя толкование <span class="RktVal">"resting"</span> очевидно, 
толкование чисел неоднозначно в своем понятии высоты: 
</div><div class="SIntrapara"><ol><li>

<p>слово “высота“ может относиться к расстоянию между землей и точкой отсчета ракеты, 
скажем, ее центром; или же </p>

</li><li>

<p>оно может означать расстояние между верхом холста и точкой отсчета. </p>

</li></ol></div><div class="SIntrapara">Каждое работает нормально. 
Во втором используется обычное компьютерное значение слова “высота“. 
Таким образом, это немного удобнее для функций, которые переводят состояние мира 
в изображение, и поэтому мы предпочитаем интерпретировать число в этом духе.</div>

<p></p>

<p>Чтобы убедить вас в этом выборе, в <a href="#%28counter._itemization._%28exercise._interpret-height%29%29" data-pltdoc="x">упражнении&nbsp;57</a> ниже вам предлагается выполнить 
упражнения из этого раздела, используя первую интерпретацию высоты.</p>

<p><a name="(counter._itemization._(exercise._cond5))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;53. Рецепт проектирования программных миров требует, 
чтобы вы переводили информацию в данные и наоборот, чтобы гарантировать полное понимание
определения данных. Лучше всего нарисовать какие-то мировые сценарии и представить их 
данными и, наоборот, выбрать несколько примеров данных и нарисовать картинки, 
которые им соответствуют. Сделайте это для определения 
<a href="#%28tech._itemization._lr%29" class="techoutside" data-pltdoc="x"><span class="techinside">LR</span></a>, включая как минимум <span class="RktSym">HEIGHT</span> и 
<span class="RktVal">0</span> в качестве примеров.  
<a href="#%28counter._itemization._%28exercise._cond5%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">На самом деле запуски ракет идут с обратным отсчетом:
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> 
Разработайте программу, которая запускает ракету, когда пользователь нажимает клавишу пробела. 
В этот момент симуляция запускает обратный отсчет в течение трех тиков, 
прежде чем отобразить вид взлетающей ракеты. 
Ракета должна двигаться вверх со скоростью три пикселя за такт часов. </p>

</blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Следуя рецепту разработки программы, сначала собираем константы: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">300</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">distances in pixels </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">YDELTA</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">В то время как 
<span class="RktSym">WIDTH</span> и <span class="RktSym">HEIGHT</span> описывают размеры 
холста и фоновой сцены, <span class="RktSym">YDELTA</span> описывает, насколько быстро ракета движется по оси Y, как указано в формулировке задачи. Константа <span class="RktSym">CENTER</span>
- это <span style="font-weight: bold">вычисленный</span> центр ракеты. </div>

<p></p>

<p></p>

<div class="SIntrapara">Далее мы переходим к разработке определения данных. 
Этот пересмотр проблемы явно требует выделения трех различных подклассов состояний:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._itemization._lrcd)"></a><span style="font-style: italic">LRCD</span><span class="RktCmt"> (for </span><span style="font-style: italic">launching rocket countdown</span><span class="RktCmt">) is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"resting"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> between </span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktCmt"> and </span><span class="RktVal"><span class="nobreak">-1</span></span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><a href="#%28tech._nonnegativenumber%29" class="techoutside" data-pltdoc="x"><span class="techinside">NonnegativeNumber</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> a grounded rocket, in countdown mode,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">a number denotes the number of pixels between the</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">top of the canvas and the rocket (its height)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Второй, новый подкласс данных - три отрицательных числа - 
представляют мир после того, как пользователь нажал клавишу пробела и до взлета ракеты. </div>

<p></p>

<p></p>

<div class="SIntrapara">На этом этапе мы записываем наш список пожеланий для функции, 
которая отображает состояния в виде изображений, и для любых функций обработки событий, 
которые могут нам понадобиться: 
<a name="(idx._itemization._(gentag._103._itemization))"></a> <a name="(idx._itemization._(gentag._104._itemization))"></a> <a name="(idx._itemization._(gentag._105._itemization))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">renders the state as a resting or flying rocket </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a><span class="RktCmt"> </span><a href="#%28tech._itemization._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">starts the countdown when space bar is pressed, </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if the rocket is still resting </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">raises the rocket by </span><span class="RktSym">YDELTA</span><span class="RktCmt">,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt"> if it is moving already </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Помните, что рецепт проектирования программных миров диктует эти сигнатуры,
хотя выбор имен для сбора данных и обработчиков событий остается за нами. 
Кроме того, мы разработали формулировки целей, чтобы они соответствовали нашей 
постановке задачи.</div>

<p></p>

<p></p>

<div class="SIntrapara">Отсюда мы используем рецепт разработки для функций, чтобы 
создать полные определения для всех трех из них, начиная с примеров для первой: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktVal">"resting"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-2</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"-2"</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3/4</span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktVal">53</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">53</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как и раньше в этой главе, 
мы проводим по одному тесту для каждого подкласса в определении данных. 
Первый пример показывает состояние покоя, второй - середину обратного отсчета, 
а последний - ракету в полете. Кроме того, мы выражаем ожидаемые значения в виде выражений, которые рисуют соответствующие изображения. 
Для создания этих изображений мы использовали область взаимодействия DrRacket; 
Чтобы сделал ты? </div>

<p></p>

<p>Внимательный взгляд на примеры показывает, что создание примеров также означает выбор. 
Ничто в постановке задачи на самом деле не требует, как именно отображается ракета перед 
запуском, но это естественно. Точно так же ничего не говорится об отображении числа 
во время обратного отсчета, но это добавляет приятный штрих. Наконец, если вы решили 
<a href="#%28counter._itemization._%28exercise._cond5%29%29" data-pltdoc="x">упражнение&nbsp;53</a>, вы также знаете, что <span class="RktVal">0</span> и <span class="RktSym">HEIGHT</span>
 - особые точки для третьего предложения определения данных. </p>

<p></p>

<div class="SIntrapara">В общем, интервалы заслуживают особого внимания, 
когда вы составляете примеры, то есть они заслуживают как минимум трех видов примеров: 
по одному с каждого конца, и другму - внутри. Поскольку второй подкласс 
<a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a> представляет собой (конечный) интервал, 
а третий - полуоткрытый интервал, давайте посмотрим на их конечные точки: 
</div><div class="SIntrapara"><ul><li>

<p>Ясно, что <span class="RktPn">(</span><span class="RktSym">show</span><span class="stt"> </span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span>
 и <span class="RktPn">(</span><span class="RktSym">show</span><span class="stt"> </span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span>
 должны создавать изображения, подобные изображению для <span class="RktPn">(</span><span class="RktSym">show</span><span class="stt"> </span><span class="RktVal"><span class="nobreak">-2</span></span><span class="RktPn">)</span>. 
В конце концов, ракета все еще лежит на земле, даже если числа обратного отсчета различаются. </p>

</li><li>

<p></p>

<div class="SIntrapara">Случай для <span class="RktPn">(</span><span class="RktSym">show</span><span class="stt"> </span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span>
другой. Согласно нашему соглашению, значение <span class="RktSym">HEIGHT</span> представляет
состояние, когда ракета только что была запущена. Графически это означает, что ракета все еще стоит на земле. Основываясь на последнем тестовом примере выше, вот тестовый пример, который выражает это понимание: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">За исключением того, 
что если вы вычислите выражение “ожидаемое значение“ само по себе в области взаимодействия
DrRacket, вы увидите, что ракета находится на полпути под землей. Это, конечно, не должно быть так, а это означает, что нам нужно скорректировать этот тестовый пример и приведенный выше: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktVal">53</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">53</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

</li><li>

<p>Наконец, определите результат, который вы теперь ожидаете от
<span class="RktPn">(</span><span class="RktSym">show</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">)</span>. Это простое, 
но показательное упражнение. </p>

</li></ul></div>

<p></p>

<p></p>

<div class="SIntrapara">Следуя прецедентам в этой главе, <span class="RktSym">show</span> 
использует выражение
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> для работы с тремя предложениями определения данных:
 <a name="(idx._itemization._(gentag._107._itemization))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Каждое предложение идентифицирует соответствующий подкласс с точным условием: 
<span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span> выбирает первый подкласс, который состоит
только из одного элемента, строки <span class="RktVal">"resting"(отдыхает)</span>; <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="stt"> </span><span class="RktVal"><span class="nobreak">-3</span></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span>
 полностью описывает второй подкласс данных; и <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">)</span>  это проверка для
всех неотритцательных чисел.
</div>

<p></p>

<p><a name="(counter._itemization._(exercise._cond6))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;54. Почему было бы  <span style="font-weight: bold">неправильно</span> использовать <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="stt"> </span><span class="RktVal">"resting"</span><span class="stt"> </span><span class="RktSym">x</span><span class="RktPn">)</span>
в качестве первого условия в  <span class="RktSym">show</span>? И наоборот, сформулируйте
полностью точное условие, то есть <a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Логическое(булевое)</span></a> выражение,
которое вычисляется в <span class="RktVal">#true</span> именно тогда, когда
 <span class="RktSym">x</span> принадлежит первому подклассу
<a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a>. <a href="#%28counter._itemization._%28exercise._cond6%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Объединение примеров и приведенного выше скелета
функции <span class="RktSym">show</span> дает достаточно
простое полное определение:
<a name="(idx._itemization._(gentag._108._itemization))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number-~3estring%29%29" class="RktValLink" data-pltdoc="x">number-&gt;string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3/4</span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Действительно, такой способ определения функций
очень эффективен и является важным элементом полноценного подхода к проектированию,
описанному в этой книге.</div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._itemization._(exercise._cond-draw-rocket))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;55. Еще раз взгляните на 
<span class="RktSym">show</span>. Она содержит три экземпляра выражения приблизительной
формы:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ROCKET</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKG</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Это выражение появляется в функции трижды:
дважды для рисования покоящейся ракеты и один раз для рисования летающей ракеты. 
Определите вспомогательную функцию, которая выполнит эту работу, и тем
самым сократит <span class="RktSym">show</span>. Почему это хорошая идея? 
Вы можете перечитать <a href="part_prologue.html" data-pltdoc="x">Пролог: Как Программировать</a>. <a href="#%28counter._itemization._%28exercise._cond-draw-rocket%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara">Перейдем ко второй функции, которая касается клавиатурного
события запуска ракеты. У нас есть её заголовочный материал, поэтому мы сформулируем
примеры в виде тестов:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktVal">"resting"</span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktVal">"resting"</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"resting"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">33</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Изучение этих шести примеров показывает, что
первые два относятся к первому подклассу 
<a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a>, третий и четвертый относятся к обратному отсчету,
а последние два относятся к клавиатурным событиям, когда ракета уже находиться в воздухе.
</div>

<p></p>

<p></p>

<div class="SIntrapara">Поскольку запись эскиза выражения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> 
хорошо работала при разработке функции <span class="RktSym">show</span>, 
мы создадим его снова: <a name="(idx._itemization._(gentag._109._itemization))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Оглядываясь на примеры, можно предположить, что ничего не меняется, когда мир находится
в состоянии, которое представлено вторым или третьим подклассом данных.
Это означает, что <span class="RktSym">launch</span>(запуск) должен возвращать <span class="RktSym">x</span>, когда это произойдет:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Наконец, первый пример идентифицирует точный случай, когда фунция
 <span class="RktSym">launch</span>(запуск) создает новое состояние мира:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">launch</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В частности, когда состояние мира это <span class="RktVal">"resting"</span>(покой) и
пользователь нажимает пробел, функция начинает обратный отсчет с 
<span class="RktVal"><span class="nobreak">-3</span></span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Скопируйте код в область определений DrRacket и убедитесь,
что приведенные выше определения работают. На этом этапе вы можете добавить функцию
для запуска программы:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main1</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">show</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span><span class="hspace">&nbsp;</span><span class="RktSym">launch</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Эта функция <span style="font-weight: bold">не</span> указывает, что делать, когда
часы тикают; В конце концов, мы еще не создали <span class="RktSym">fly</span>. 
Тем не менее с помощью <span class="RktSym">main1</span> можно запустить эту
неполную версию программы и проверить, можно ли запустить обратный отсчет.
Что бы вы использовали в качестве аргумента при вызове <span class="RktSym">main1</span>?
</div>

<p></p>

<blockquote class="Figure"><a name="(counter._itemization._(figure._fig~3acountdown))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._itemization._lrcd%29" class="techoutside" data-pltdoc="x"><span class="techinside">LRCD</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">raises the rocket by </span><span class="RktSym">YDELTA</span><span class="RktCmt"> if it is moving already </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktVal">"resting"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"resting"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-2</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-2</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktSym">YDELTA</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktSym">YDELTA</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fly</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">YDELTA</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;25: 
</span>Запуск обратного отсчета и отрыв</span></p>

</blockquote>

<p><a name="(idx._itemization._(gentag._110._itemization))"></a>
Разработка <span class="RktSym">fly</span>— обработчика тактов часов — 
выполняется так же, как и разработка двух предыдущих функций, а на 
<a href="#%28counter._itemization._%28figure._fig~3acountdown%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">25</span></a> показан
результат <a name="(idx._itemization._(gentag._111._itemization))"></a>процесса проектирования.
Ещё раз, ключ состоит в том, чтобы покрыть пространство возможных входных данных
хорошим набором примеров, особенно для двух интервалов. 
Эти примеры гарантируют, что обратный отсчет и переход от обратного отсчета к
старту работают правильно.</p>

<p><a name="(counter._itemization._(exercise._cond7))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;56. Определите <span class="RktSym">main2</span> так, чтобы
вы могли запустить ракету и посмотреть как она взлетает. 
Прочтите предложение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span>, чтобы определить длину одного
такта и как её изменить.</p>

<p>Если вы посмотрите весь запуск, то заметите, что как только
ракета достигает вершины, происходит нечто любопытное. Объясните. 
Добавьте предложение
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span> в <span class="RktSym">main2</span>,
чтобы симуляция взлета изящно прекращалась, когда ракета скрывается из поля зрения. 
<a href="#%28counter._itemization._%28exercise._cond7%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>Решение  <a href="#%28counter._itemization._%28exercise._cond7%29%29" data-pltdoc="x">упражениния&nbsp;56</a> дает законченную рабочую программу,
но ведет себя несколько странно. Опытные программисты говорят вам, что
использование отритцательных чисел для обозначения фазы обратного
отсчета слишком “непросто.” В следующей главе представлены средства,
позволяющие дать хорошее определение данных для этой проблемы.
Однако прежде чем мы перейдем к ней, в следующем разделе мы опишем,
как разрабатывать программы, которые потребляют(принимают) данные,
описанные с помощью детализации.</p>

<p><a name="(counter._itemization._(exercise._interpret-height))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;57. Напомним, что слово “высота” заставило нас
выбрать одно из двух возможных толкований(интерпретаций). 
Теперь, когда вы выполнили упражнения из этого раздела, решите их еще раз, используя
первое толкование слова. Сравните и сопоставьте решения.
<a href="#%28counter._itemization._%28exercise._interpret-height%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>4.6<tt>&nbsp;</tt><a name="(part._sec~3adesign-itemization)"></a>Разработка с использованием Детализации</h4>

<p>В предыдущих трех разделах разъяснялось, что при разработке функций может и должна
использоваться организация определений данных. В частности, если определение данных 
выделяет определенные фрагменты данных или указывает диапазоны данных, то создание 
примеров и организация функции отражают эти случаи и диапазоны.
</p>

<p></p>

<div class="SIntrapara">В этом разделе мы уточняем <a name="(idx._(gentag._112))"></a>
рецепт проектирования <a href="#%28part._sec~3adesign%29" data-pltdoc="x">
От функций к программам</a>, чтобы вы могли действовать систематически, 
когда сталкиваетесь с проблемами, связанными с функциями, которые используют детализации, 
включая перечисления и интервалы. Чтобы пояснение было обоснованным, мы проиллюстрируем 
шесть этапов проектирования следующим, несколько упрощенным, примером: 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> Штат Tax Land ввел 
трехступенчатый налог с продаж, чтобы справиться с дефицитом бюджета. 
Недорогие товары стоимостью менее 1000 долларов не облагаются налогом. 
Предметы роскоши, стоимость которых превышает 10 000 долларов, облагаются налогом 
по ставке восемь процентов (8,00%). Все, что находится между ними, имеет наценку 
в пять процентов (5,00%). </p>

<p>Разработайте функцию для кассового аппарата, которая вычисляет налог с продаж 
по цене товара.</p>

</blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Помните об этой проблеме, когда мы будем пересматривать 
шаги рецепта разработки: 
</div><div class="SIntrapara"><ol><li>

<p>Когда в постановке задачи выделяются разные классы входной информации, 
вам нужны тщательно сформулированные определения данных.</p>

<p>В <a name="(idx._(gentag._113))"></a>определении данных должны использоваться 
отдельные <span style="font-style: italic">предложения</span> для каждого подкласса данных 
или, в некоторых случаях, только отдельные части данных. Каждое предложение определяет
<a name="(idx._(gentag._114))"></a>представление данных для определенного подкласса информации.
Ключевым моментом является то, что каждый подкласс данных отличается от любого другого класса,
поэтому наша функция может работать, анализируя непересекающиеся случаи. </p>

<p>В нашем примере проблема связана с ценами и налогами, которые обычно 
являются положительными числами. Также здесь четко различаются три диапазона:</p>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._price)"></a><span style="font-style: italic">Price</span><span class="RktCmt"> falls into one of three intervals: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">0</span><span class="RktCmt"> through </span><span class="RktVal">1000</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">1000</span><span class="RktCmt"> through </span><span class="RktVal">10000</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">10000</span><span class="RktCmt"> and above.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> the price of an item</span><span class="hspace">&nbsp;&nbsp;</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Вы понимаете, как эти диапазоны соотносятся с исходной проблемой? </div>

<p></p>

</li><li>

<p>Что касается сигнатуры, предназначении и заголовка функции, 
вы действуете так же, как и раньше. </p>

<p></p>

<div class="SIntrapara">Вот материал для нашего рабочего примера: 
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Разработчики в реальном мире не используют простые числа в выбранном языке 
программирования для обозначения денежных сумм. 
См. Интермеццо 4 для ознакомления с некоторыми проблемами использования чисел. 
</span></span></span>
<a name="(idx._(gentag._115))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._price%29" class="techoutside" data-pltdoc="x"><span class="techinside">Price</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the amount of tax charged for </span><span class="RktSym">p</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sales-tax</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

</li><li>

<p>Однако для функциональных примеров необходимо выбрать хотя бы один пример 
из каждого подкласса в определении данных. Кроме того, если подкласс - 
это конечный диапазон, не забудьте выбрать примеры из границ диапазона и 
из его внутренней части. </p>

<p>Поскольку в нашем примере определения данных используются три различных 
интервала, давайте выберем все примеры границ и одну цену внутри каждого 
интервала и определим сумму налога для каждого: <span class="RktVal">0</span>, 
<span class="RktVal">537</span>, <span class="RktVal">1000</span>,
 <span class="RktVal">1282</span>, <span class="RktVal">10000</span>
 и <span class="RktVal">12017</span>.</p>

<p>Стоп! Попробуйте рассчитать налог для каждой из этих цен. </p>

<p></p>

<div class="SIntrapara">Вот наша первая попытка с округленными суммами налогов: 
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right">

<p>0</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>537</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>1000</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>1282</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>10000</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>12017</p>

</td></tr><tr><td align="right">

<p>0</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>0</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>????</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>64</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>?????</p>

</td><td align="right">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td align="right">

<p>961</p>

</td></tr></tbody></table></div><div class="SIntrapara">
Знаки вопроса указывают на то, что в постановке задачи используются расплывчатые фразы 
“те, которые стоят менее 1000 долларов США“ и “более 10 000 долларов США“, 
чтобы указать таблицу налогов. В то время как программист может прийти к выводу, 
что эти слова означают “строго меньше“ или “строго больше“, законодатели, возможно, 
имели в виду сказать “меньше или равно“ или “больше или равно“ соответственно. 
Будучи скептически настроенными, мы решаем здесь, что законодатели Tax Land всегда 
хотят тратить больше денег, поэтому ставка налога для 1000 долларов составляет 5%, 
а ставка для 10 000 долларов - 8%. Программист налоговой компании должен будет спросить специалиста по налоговому праву. </div>

<p></p>

<p>Теперь, когда мы выяснили, как должны интерпретироваться границы в домене,
мы можем уточнить определение данных. Мы надеемся, что вы сможете сделать 
это самостоятельно. </p>

<p></p>

<div class="SIntrapara">Прежде чем мы продолжим, давайте превратим некоторые примеры 
в тестовые случаи: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sales-tax</span><span class="hspace">&nbsp;</span><span class="RktVal">537</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sales-tax</span><span class="hspace">&nbsp;</span><span class="RktVal">1000</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.05</span><span class="hspace">&nbsp;</span><span class="RktVal">1000</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sales-tax</span><span class="hspace">&nbsp;</span><span class="RktVal">12017</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.08</span><span class="hspace">&nbsp;</span><span class="RktVal">12017</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Присмотритесь. Вместо того, чтобы просто записывать ожидаемый результат, мы записываем, 
как вычислить ожидаемый результат. Это упрощает дальнейшую формулировку определения функции.
</div>

<p></p>

<p>Стоп! Запишите оставшиеся тестовые случаи. Подумайте, почему вам может 
понадобиться больше тестовых примеров, чем подклассов в определении данных. </p>

</li><li>

<p></p>

<div class="SIntrapara">Самая большая новинка - 
<a name="(idx._(gentag._116))"></a>шаблон условия. В общем, 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-style: italic">шаблон отражает организацию подклассов с 
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>.</span></p>

</blockquote></div><div class="SIntrapara">Этот лозунг означает две конкретные вещи. 
Во-первых, тело функции должно быть условным выражением с таким количеством предложений, 
сколько различных подклассов в определении данных. Если в определении данных упоминаются 
три отдельных подкласса входных данных, вам понадобятся три предложения  <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>; 
если у него семнадцать подклассов, выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> содержит семнадцать предложений. 
Во-вторых, вы должны сформулировать по одному выражению условия для каждого предложения 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
Каждое выражение включает параметр функции и определяет один из подклассов данных в определении данных: <a name="(idx._(gentag._117))"></a></div>

<p></p>

<blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sales-tax</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">1000</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1000</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">10000</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">10000</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></li><li>

<p>Когда вы закончите шаблон, вы готовы определить функцию. Учитывая, что 
тело функции уже содержит схематическое выражение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, 
естественно начать с различных строк <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
Для каждой строки <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> вы можете предположить, что входной параметр 
удовлетворяет условию, и поэтому вы используете соответствующие тестовые примеры. 
Чтобы сформулировать соответствующее результирующее выражение, вы запишите вычисление 
для этого примера как выражение, которое включает параметр функции. 
Игнорируйте все другие возможные типы входных данных, когда вы работаете с одной строкой; 
другие условия <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> позаботятся о них. <a name="(idx._(gentag._118))"></a></p>

<blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sales-tax</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">1000</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1000</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">10000</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.05</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;=</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktVal">10000</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0.08</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></li><li>

<p>Наконец, запустите тесты и убедитесь, что они охватывают все условия(предложения) 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>.</p>

<p>Что вы будете делать, если один из ваших тестовых примеров не сработает? 
Просмотрите конец раздела <a href="#%28part._sec~3adesign-func%29" data-pltdoc="x">
Проектирование Функции</a> посвященный ошибкам тестирования. </p>

</li></ol></div>

<p></p>

<p><a name="(counter._(exercise._cond9))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;58. Ввести постоянные определения, которые отделяют интервалы низких цен и 
цен на предметы роскоши от других, чтобы законодатели в Tax Land могли легко поднять налоги 
еще больше.  <a href="#%28counter._%28exercise._cond9%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>4.7<tt>&nbsp;</tt><a name="(part._sec~3aworlds-more)"></a>Миры конечных состояний</h4>

<p>Обладая знаниями в области проектирования, описанными в этой главе, вы сможете 
разработать полную симуляцию американских светофоров. Когда такой свет горит зеленым 
и пора останавливать движение, он загорается желтым, а затем красным. 
Когда горит красный свет и пора начинать движение, он просто переключается на зеленый. </p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3atraffic-light))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_60.png" alt="image" width="331.08281250000005" height="222.0"></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;26: </span> Как работает светофор </span></p>

</blockquote>

<p>Левая часть  <a href="#%28counter._%28figure._fig~3atraffic-light%29%29" data-pltdoc="x">Рисунка&nbsp;<span class="FigureRef">26</span></a> объединяет это описание
в виде <span style="font-style: italic">диаграммы переходов между состояниями</span>. 
Такая диаграмма состоит из
 <span style="font-style: italic">состояний(states)</span> и стрелок, соединяющих эти
состояния. Каждое состояние изображает светофор в одной конкретной конфигурации: 
красного, желтого или зеленого. 
Каждая стрелка показывает, как мир может измениться, из какого состояния он может 
 <span style="font-style: italic">перейти(transition)</span> в другое состояние.
В нашем примере диаграммы есть три стрелки, потому что есть три возможных способа изменения
светофора. Метки(ярлыки) на стрелках указывают причину изменений; светофор переходит из одного
состояния в другое с течением времени.
</p>

<p>Во многих ситуациях диаграммы переходов состояний содержат только конечное число состояний
и стрелок. Ученые-информатики называют такие диаграммы 
<span style="font-style: italic">машинами с конечным числом состояний</span> 
(finite state machines - FSM), также известными как 
<span style="font-style: italic">автоматом с кончным числом состояний, или конечным автоматом</span> (FSA - finite state automata). Несмотря на свою простоту, FSMs/FSAs играют важную роль в
информатике.</p>

<p>Чтобы создать программный мир для FSA, мы должны сначала выбрать представление данных
для возможных “состояний мира”, которое, согласно
<a href="#%28part._.D.K._sec~3adesign-world%29" data-pltdoc="x">Разработке Программных Миров</a>,
представляет те аспекты мира, которые могут некоторым образом измениться, в отличии от тех,
которые остаются прежними. В случае с нашим светофором меняется цвет света, т.е. какая лампа
включена. Размер лампочек, их расположение (горизонтальное или вертикальное) и другие аспекты
не меняются. Поскольку существует только три состояния, мы повторно используем определение
данных <a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>, приведенное выше.</p>

<p>Правая часть  <a href="#%28counter._%28figure._fig~3atraffic-light%29%29" data-pltdoc="x">рисунка&nbsp;<span class="FigureRef">26</span></a> представляет собой
схематическую интерпретацию определения данных
 <a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>. Как и диаграмма на 
 <a href="#%28counter._%28figure._fig~3atraffic-light%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">26</span></a>, она состоит из трех состояний, расположенных таким образом,
что каждый элемент данных легко рассматривать как представление конкретной конфигурации.
Кроме того, стрелки теперь помечены <span style="font-weight: bold">tick(такт)</span>, 
что указывает на то, что наш программный мир использует течение времени в качестве тригера,
который изменяет состояние светофора. Если бы мы хотели смоделировть управление светом в 
ручную, мы могли бы выбрать переходы на основе нажатия клавиш.</p>

<p></p>

<div class="SIntrapara">Теперь, когда мы знаем как пердставить состояния нашего мира,
как переходить от одного к другому и что состояние меняется при каждом такте часов, мы можем
записать сигнатуру, предназначение и заглушку для двух функций, которые мы должны
разработать: <a name="(idx._(gentag._119))"></a> <a name="(idx._(gentag._120))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">yields the next state, given current state </span><span class="RktSym">cs</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-next</span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">renders the current state </span><span class="RktSym">cs</span><span class="RktCmt"> as an image</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-render</span><span class="hspace">&nbsp;</span><span class="RktSym">current-state</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">90</span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В предыдущих разделах используются имена <span class="RktSym">render</span> и 
<span class="RktSym">next</span> для имен функций, которые преобразуют состояние
мира в изображение и имеют дело с тактами часов. Here we prefix these names
 with some syllable that suggests to which world the functions belong.
 Because the specific functions have appeared before, we leave them as
 exercises.</div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._cond11))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;59. Завершите разработку программного мира, моделирующего светофор
FSA. Вот основная функция: <a name="(idx._(gentag._121))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">simulates a clock-based American traffic light</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">traffic-light-simulation</span><span class="hspace">&nbsp;</span><span class="RktSym">initial-state</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">initial-state</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tl-render</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tl-next</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Аргументом функции является начальное состояние для выражения 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>, которое сообщает DrRacket 
перерисовка состояния мира проводиться с помощью  <span class="RktSym">tl-render</span> и
обработка тактов часов с помощью <span class="RktSym">tl-next</span>. 
Также обратите внимание, что она сообщает компьютеру, что часы должны идти раз в секунду.
</div>

<p></p>

<p>Завершите разработку <span class="RktSym">tl-render</span> и <span class="RktSym">tl-next</span>.  Начните с копирования 
<a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>, <span class="RktSym">tl-next</span> и <span class="RktSym">tl-render</span> в область определений DrRacket.</p>

<p></p>

<div class="SIntrapara">Вот несколько тестовых примеров для разработки последней:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-render</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_61.png" alt="image" width="56" height="26"><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-render</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_62.png" alt="image" width="56" height="26"><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Ваша функция может напрямую использовать эти изображения. Если вы решили создать изображения
с помощью функций из <span class="sroman">библиотеки <span class="Smaller"><span style="font-style: italic">2htdp/image</span></span> </span>, разработайте вспомогательную функцию
для создания одноцветной лампочки. Затем ознакомьтесь с функцией
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span>, которая позволяет размещать лампочки на заднем фоне
сцены. 
<a href="#%28counter._%28exercise._cond11%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._ex~3aalternative-data-design))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;60. Альтернативное представление данных 
для программы светофора может использовать числа вместо строк:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._n._trafficlight)"></a><span style="font-style: italic">N-TrafficLight</span><span class="RktCmt"> is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">0</span><span class="RktCmt"> </span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> the traffic light shows red</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">1</span><span class="RktCmt"> </span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> the traffic light shows green</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">2</span><span class="RktCmt"> </span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> the traffic light shows yellow</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Это значительно упрощает определение  <span class="RktSym">tl-next</span>:  
<a name="(idx._(gentag._122))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._n._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">N-TrafficLight</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._n._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">N-TrafficLight</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">yields the next state, given current state </span><span class="RktSym">cs</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-next-numeric</span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._modulo%29%29" class="RktValLink" data-pltdoc="x">modulo</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Переформулируйте тесты  <span class="RktSym">tl-next</span> на  
<span class="RktSym">tl-next-numeric</span>.</div>

<p></p>

<p>Передает ли функция <span class="RktSym">tl-next</span> свое намерение более ясно, 
чем функция <span class="RktSym">tl-next-numeric</span>? Если да, то почему? Если нет, то почему?
<a href="#%28counter._%28exercise._ex~3aalternative-data-design%29%29" class="ex-end" data-pltdoc="x"></a> </p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._ex~3aalternative-data-design2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;61. 
Как говорится в <a href="#%28part._sec~3adesign%29" data-pltdoc="x">От функций к программам</a>,
программы должны определять константы и использовать имена вместо фактических констант. 
В этом духе определение данных для светофора также должно использовать константы: 
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Эту форму определения данных использовал бы опытный разработчик. </span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">RED</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">GREEN</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">YELLOW</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._s._trafficlight)"></a><span style="font-style: italic">S-TrafficLight</span><span class="RktCmt"> is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">RED</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">GREEN</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">YELLOW</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Если имена выбраны правильно, определение данных не требует инструкции по интерпретации. 
<a name="(idx._(gentag._123))"></a></div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3aex~3aalternative))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0"><tbody><tr><td colspan="3" valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._s._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">S-TrafficLight</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._s._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">S-TrafficLight</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">yields the next state, given current state </span><span class="RktSym">cs</span></td></tr></tbody></table></td></tr><tr><td valign="top">

<p></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p></p>

</td></tr><tr><td colspan="3" valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-next-</span><span class="hspace">&nbsp;</span>...<span class="hspace">&nbsp;</span><span class="RktSym">RED</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">YELLOW</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-next-</span><span class="hspace">&nbsp;</span>...<span class="hspace">&nbsp;</span><span class="RktSym">YELLOW</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">GREEN</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr><tr><td valign="top">

<p></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p></p>

</td></tr><tr><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-next-numeric</span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._modulo%29%29" class="RktValLink" data-pltdoc="x">modulo</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tl-next-symbolic</span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._equal~3f%29%29" class="RktValLink" data-pltdoc="x">equal?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="hspace">&nbsp;</span><span class="RktSym">RED</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">GREEN</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._equal~3f%29%29" class="RktValLink" data-pltdoc="x">equal?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="hspace">&nbsp;</span><span class="RktSym">GREEN</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">YELLOW</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._equal~3f%29%29" class="RktValLink" data-pltdoc="x">equal?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cs</span><span class="hspace">&nbsp;</span><span class="RktSym">YELLOW</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">RED</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;27: </span>Символический светофор</span></p>

</blockquote>

<p></p>

<div class="SIntrapara">На <a href="#%28counter._%28figure._fig~3aex~3aalternative%29%29" data-pltdoc="x">Рисунке&nbsp;<span class="FigureRef">27</span></a> 
показаны две разные функции, которые переключают состояние светофора в программе моделирования.
Какая из двух правильно спроектирована с использованием рецепта создания для детализации? 
Какая из двух продолжит работать, если вы измените константы на следующие 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">RED</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">GREEN</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">YELLOW</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Это поможет вам ответить на вопросы?</div>

<p></p>

<p><span style="font-weight: bold">Отступление</span> Функция span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._equal~3f%29%29" class="RktValLink" data-pltdoc="x">equal?</a></span> на 
<a href="#%28counter._%28figure._fig~3aex~3aalternative%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">27</span></a> сравнивает два произвольных значения, независимо от того, 
что это за значения. Равенство - сложная тема в мире программирования.
 <span style="font-weight: bold">Конец</span> <a href="#%28counter._%28exercise._ex~3aalternative-data-design2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Вот еще одна задача с конечным числом состояний, 
которая привносит несколько дополнительных сложностей: 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример задачи</span> 
Создайте универсальную программу, которая имитирует работу двери с автоматическим доводчиком. 
Если такая дверь заперта, вы можете открыть ее ключом. Незапертая дверь закрывается, 
но кто-то толкает ее, открывает. Как только человек проходит через дверь и отпускает ее,
автоматическа берет дверь на себя и снова закрывает дверь. 
Когда дверь закрыта, ее можно снова запереть. </p>

</blockquote></div>

<p></p>

<p>Чтобы выделить основные элементы, мы снова рисуем диаграмму переходов; 
см. левую часть a href="#%28counter._%28figure._fig~3adoor-closer%29%29" data-pltdoc="x">рисунка&nbsp;<span class="FigureRef">28</span></a>. 
Как и у светофора, дверь имеет три различных состояния: заперто(locked), закрыто(closed) 
и открыто(open). Запирание и отпирание - это действия, которые заставляют дверь 
переходить из запертого в закрытое состояние и наоборот. 
Что касается открытия незапертой двери, мы говорим, что нужно толкнуть
(<span style="font-weight: bold">push</span>) дверь. Оставшийся переход отличается от других,
потому что не требует каких-либо действий со стороны кого-либо или чего-либо еще. 
Вместо этого дверь со временем закрывается автоматически. Соответствующая стрелка перехода помечена *time*(время), чтобы подчеркнуть это. </p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3adoor-closer))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_63.png" alt="image" width="133.0576171875" height="204.234375"> <span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span> <img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_64.png" alt="image" width="142.9697265625" height="204.234375"></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;28: </span>
Схема переходов двери с автоматическим доводчиком </span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Следуя нашему рецепту, мы начнем с преобразования трех состояний 
реального мира в данные BSL:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">LOCKED</span><span class="hspace">&nbsp;</span><span class="RktVal">"locked"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktVal">"closed"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">OPEN</span><span class="hspace">&nbsp;</span><span class="RktVal">"open"</span><span class="RktPn">)</span></td></tr></tbody></table></td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._doorstate)"></a><span style="font-style: italic">DoorState</span><span class="RktCmt"> is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">LOCKED</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">CLOSED</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">OPEN</span></td></tr></tbody></table></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Мы также напомним урок из <a href="#%28counter._%28exercise._ex~3aalternative-data-design2%29%29" data-pltdoc="x">упражнения&nbsp;61</a>, 
а именно, что лучше всего определять символические константы и формулировать 
определения данных в терминах таких констант. </div>

<p></p>

<p>Следующий шаг разработки мира требует, чтобы мы преобразовали выбранные действия 
из нашей области - стрелки на левой диаграмме - во взаимодействия с компьютером, 
с которыми может справиться 
<span class="sroman">библиотека <span class="Smaller"><span style="font-style: italic">2htdp/universe</span></span> </span>. Наше графическое изображение состояний и переходов двери, 
в частности стрелка от <span class="stt">open</span>(открыто) к 
<span class="stt">closed</span>(закрыто), предполагает использование тактов часов. 
Для других стрелок мы можем использовать либо нажатия клавиш, либо щелчки мышью. 
Давайте воспользуемся тремя нажатиями клавиш: <span class="RktVal">"u"</span> 
для отпирания двери, <span class="RktVal">"l"</span> для ее запирания и 
пробел <span class="RktVal">" "</span> для ее открытия. 
На диаграмме справой стороны на <a href="#%28counter._%28figure._fig~3adoor-closer%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">28</span></a> 
эти варианты представлены графически; она переводит диаграмму конечного автомата из 
мира информации в мир данных в BSL.</p>

<p></p>

<div class="SIntrapara">Как только мы решили использовать время для одного действия и 
нажатия клавиш для других, мы должны разработать функции, которые отображают 
текущее состояние мира, представленное как 
<a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a>, и которые преобразуют его в следующее состояние мира. 
И они, конечно же, составляют список желаемых функций 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span>: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym">door-closer</span>, которая закрывает дверь за один тик;</p>

</li><li>

<p><span class="RktSym">door-action</span>, которая действует на него в ответ на нажатие клавиши; а также</p>

</li><li>

<p><span class="RktSym">door-render</span>, которая переводит текущее состояние в изображение.</p>

</li></ul></div><div class="SIntrapara">Стоп! Сформулируйте соответствующие сигнатуры.</div>

<p></p>

<p></p>

<div class="SIntrapara">Начнем с <span class="RktSym">door-closer</span>(доводчика). 
Поскольку <span class="RktSym">door-closer</span> действует как обработчик 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span>, 
мы получаем его сигнатуру, выбирая <a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a> в качестве набора состояний мира: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">closes an open door over the period of one tick </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-closer</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Придумывать примеры тривиально, когда мир может находиться только в одном из трех состояний.
Здесь мы используем таблицу, чтобы выразить основную идею, как и в некоторых математических
примерах, приведенных выше: 
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td>

<p>given state</p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p>desired state</p>

</td></tr><tr><td>

<p><span class="RktSym">LOCKED</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktSym">LOCKED</span></p>

</td></tr><tr><td>

<p><span class="RktSym">CLOSED</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktSym">CLOSED</span></p>

</td></tr><tr><td>

<p><span class="RktSym">OPEN</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktSym">CLOSED</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Стоп! Выразите эти примеры как тесты BSL.</div>

<p></p>

<p></p>

<div class="SIntrapara">Шаг шаблона требует условного выражения с тремя предложениями: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-closer</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">LOCKED</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">OPEN</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">и процесс превращения этого шаблона в определение функции продиктован примерами: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-closer</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">LOCKED</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">LOCKED</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">OPEN</span><span class="hspace">&nbsp;</span><span class="RktSym">state-of-door</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Не забывайте проводить тесты. </div>

<p></p>

<p></p>

<div class="SIntrapara">Вторая функция, <span class="RktSym">door-action</span>, 
обрабатывает оставшиеся три стрелки на диаграмме. Функции, которые имеют дело с 
событиями клавиатуры, используют как мировое, так и клавиатурное событие, то есть 
сигнатура выглядит следующим образом: 
<a name="(idx._(gentag._124))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a><span class="RktCmt"> </span><a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">turns key event </span><span class="RktSym">k</span><span class="RktCmt"> into an action on state </span><span class="RktSym">s</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-action</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Еще раз представим примеры в табличной форме: 
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td>

<p>данное состояние</p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p>данное клавиатурное событие </p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p>желаемое состояние</p>

</td></tr><tr><td>

<p><span class="RktSym">LOCKED</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktVal">"u"</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktSym">CLOSED</span></p>

</td></tr><tr><td>

<p><span class="RktSym">CLOSED</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktVal">"l"</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktSym">LOCKED</span></p>

</td></tr><tr><td>

<p><span class="RktSym">CLOSED</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktVal">" "</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktSym">OPEN</span></p>

</td></tr><tr><td>

<p><span class="RktSym">OPEN</span></p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p>— </p>

</td><td>

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td>

<p><span class="RktSym">OPEN</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Примеры объединяют информацию из нашего рисунка с выбранными нами вариантами 
сопоставления действий с событиями клавиатуры. В отличие от таблицы примеров 
для светофора эта таблица неполная. Подумайте о некоторых других примерах; 
затем подумайте, почему нашей таблицы достаточно. </div>

<p></p>

<p></p>

<div class="SIntrapara">Отсюда легко создать законченную разработку:  
<a name="(idx._(gentag._125))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-action</span><span class="hspace">&nbsp;</span><span class="RktSym">LOCKED</span><span class="hspace">&nbsp;</span><span class="RktVal">"u"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-action</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktVal">"l"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">LOCKED</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-action</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">OPEN</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-action</span><span class="hspace">&nbsp;</span><span class="RktSym">OPEN</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">OPEN</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-action</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-action</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">LOCKED</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"u"</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">CLOSED</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"l"</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">LOCKED</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">" "</span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">OPEN</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Обратите внимание на использование <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span> для объединения двух условий: 
одно относится к текущему состоянию двери, а другое - к данному клавиатурному событию. 
</div>

<p></p>

<p></p>

<div class="SIntrapara">Наконец, нам нужно отобразить состояние мира как сцену: <a name="(idx._(gentag._126))"></a> <a name="(idx._(gentag._127))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">translates the state </span><span class="RktSym">s</span><span class="RktCmt"> into a large text image</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-render</span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CLOSED</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-render</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Эта упрощенная функция использует крупный текст. Вот как мы все это запускаем:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._doorstate%29" class="techoutside" data-pltdoc="x"><span class="techinside">DoorState</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">simulates a door with an automatic door closer</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">door-simulation</span><span class="hspace">&nbsp;</span><span class="RktSym">initial-state</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">initial-state</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">door-closer</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span><span class="hspace">&nbsp;</span><span class="RktSym">door-action</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">door-render</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Теперь пришло время собрать кусочки и запустить их в DrRacket, чтобы увидеть, все ли работает. 
</div>

<p></p>

<p><a name="(counter._(exercise._cond12))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;62. Во время моделирования двери  состояния “open”(открыто) практически не видно.
Измените <span class="RktSym">door-simulation</span> так, чтобы часы тикали каждые три секунды. Перезапустите симуляцию.  
<a href="#%28counter._%28exercise._cond12%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h3>5<tt>&nbsp;</tt><a name="(part._ch~3astructure)"></a>Добавление структуры</h3>

<p>Предположим, вы хотите разработать программный мир, который имитирует мяч, 
прыгающий вперед и назад по прямой вертикальной линии между полом и потолком какой-то 
воображаемой идеальной комнаты. Предположим, что он всегда перемещается на два пикселя 
за такт часов. Если вы будете следовать рецепту проектирования, ваша первая цель - 
разработать <a name="(idx._(gentag._128))"></a>представление данных для того, 
что меняется с течением времени. Здесь положение и направление мяча меняются со временем, 
но это <span style="font-weight: bold">два</span> значения, в то время как 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> отслеживает только одно. 
Таким образом, возникает вопрос, как одна часть данных может представлять два изменяющихся количества информации. </p>

<blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent">

<p>Математикам известны уловки, которые “объединяют“ два числа в одно число, 
так что можно получить исходные числа. Программисты считают такие уловки злом, 
потому что они скрывают истинные намерения программы. </p>

</blockquote></blockquote></blockquote>

<p>Вот еще один сценарий, который поднимает тот же вопрос. Ваш мобильный телефон 
в основном состоит из нескольких миллионов строк кода, завернутых в пластик. 
Помимо прочего, он управляет вашими контактами. У каждого контакта есть имя, 
номер телефона, адрес электронной почты и, возможно, другая информация. 
Когда у вас много контактов, каждый отдельный контакт лучше всего представить как 
единый фрагмент данных; в противном случае части могут случайно перепутаться. </p>

<p>Из-за таких проблем программирования каждый язык программирования предоставляет 
некоторый механизм для объединения нескольких фрагментов данных в единый фрагмент 
<span style="font-style: italic">compound data/составных данных</span> и способы получения составляющих значений, когда это необходимо. 
Эта глава знакомит с механизмами BSL, так называемыми определениями структурных типов, 
и знакомит с тем, как разрабатывать программы, работающие с составными данными. </p>

<h4>5.1<tt>&nbsp;</tt><a name="(part._sec~3aposn-structures)"></a>
От Позиций к Структурам <span class="RktSym">posn</span> </h4>

<p>Положение на мировом холсте однозначно определяется двумя частями данных: 
расстоянием от левого поля и расстоянием от верхнего поля. Первая называется координатой x
(<span style="font-style: italic">x-coordinate</span>), а вторая - координатой y 
 <span style="font-style: italic">y-coordinate</span>.</p>

<p></p>

<div class="SIntrapara">DrRacket, который, по сути, представляет собой программу BSL, 
представляет такие позиции  структурой <span class="RktSym">posn</span>. 
Структура <span class="RktSym">posn</span> объединяет два числа в одно значение. 
Мы можем создать структуру <span class="RktSym">posn</span> с помощью операции
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span>, которая потребляет два числа и создает 
<span class="RktSym">posn</span>. Например, 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">- это выражение, которое создает структуру 
<span class="RktSym">posn</span>, координата x которой равна <span class="RktVal">3</span>, 
а координата y равна  <span class="RktVal">4</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Структура <span class="RktSym">posn</span> имеет тот же статус, 
что и число, логическое значение или строка. В частности, как примитивные операции, 
так и функции могут потреблять и создавать структуры. Также программа может именовать
(присвоить имя) структуру <span class="RktSym">posn</span>: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">one-posn</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Стоп! Опишите <span class="RktSym">one-posn</span>
 в координатах.</div>

<p></p>

<p>Прежде чем делать что-либо еще, давайте взглянем на законы вычислений для структур 
<span class="RktSym">posn</span>. Таким образом, мы можем как создавать функции, 
обрабатывающие структуры <span class="RktSym">posn</span>, так и предсказывать, 
что они вычисляют. </p>

<h4>5.2<tt>&nbsp;</tt><a name="(part._sec~3aeval-posns)"></a>Вычисления с <span class="RktSym">posn</span></h4>

<p>Хотя функции и законы функций полностью знакомы из предалгебры, 
<span class="RktSym">posn</span>-структуры кажутся новой идеей. С другой стороны, 
концепция <span class="RktSym">posn</span> должна выглядеть как декартовы точки или 
позиции на плоскости, с которыми вы, возможно, сталкивались раньше. </p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3acartesian-point))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered">

<p><img src="part_one_files/pict_65.png" alt="image" width="250" height="250"></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисонок&nbsp;29: </span>Декартова точка</span></p>

</blockquote>

<p>Выбор частей декартовой точки - тоже знакомый процесс. Например,<span class="refelem"><span class="refcolumn"><span class="refcontent">Мы благодарим Нила Торонто за библиотеку 
<span class="RktSym">plot</span>.</span></span></span>  когда учитель говорит: “Взгляните на график на a href="#%28counter._%28figure._fig~3acartesian-point%29%29" data-pltdoc="x">рисунке
&nbsp;<span class="FigureRef">29</span></a> и скажите мне, чему равны &nbsp;<span class="FigureRef">29</span></a> и <span style="font-style: italic">p</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">y</span></span><span style="font-style: italic"></span>”, вы, скорее всего, ответите <span style="font-style: italic"></span>3<span style="font-style: italic"></span>1<span style="font-style: italic"></span> и 
<span style="font-style: italic"></span>2<span style="font-style: italic"></span>6<span style="font-style: italic"></span> соответственно, потому что знаете, 
что вам нужно считать значения. где вертикальные и горизонтальные линии, исходящие из 
<span style="font-style: italic">p</span>, касаются осей.</p>

<p></p>

<div class="SIntrapara">Мы можем выразить эту идею в BSL. Предположим, вы добавили
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">31</span><span class="hspace">&nbsp;</span><span class="RktVal">26</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">в область определений, щелкните 
<span class="emph">RUN</span> и выполните следующие действия: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">31</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">26</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Определение 
<span class="RktSym">p</span> похоже на отметку точки на декартовой плоскости; 
использование <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span> и 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span> похоже на индексирование <span class="RktSym">p</span>
с индексами:  <span style="font-style: italic">p</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">x</span></span><span style="font-style: italic"></span> и <span style="font-style: italic">p</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic">y</span></span><span style="font-style: italic"></span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">С точки зрения вычислений, <span class="RktSym">posn</span>-структуры имеют два уравнения: 
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktSym">x0</span><span class="stt"> </span><span class="RktSym">y0</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">==</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">x0</span></p>

</td></tr><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktSym">x0</span><span class="stt"> </span><span class="RktSym">y0</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">==</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">y0</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">
DrRacket использует эти уравнения во время вычислений. Вот пример вычисления с 
использованием структур <span class="RktSym">posn</span>: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> replaces </span><span class="RktSym">p</span><span class="RktCmt"> with </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktVal">31</span><span class="stt"> </span><span class="RktVal">26</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">31</span><span class="hspace">&nbsp;</span><span class="RktVal">26</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> uses the law for </span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktVal">31</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Стоп! Подтвердите второе взаимодействие выше своим собственным расчетом. Также используйте
пошаговый исполнитель DrRacket, чтобы перепроверить. </div>

<p></p>

<h4>5.3<tt>&nbsp;</tt><a name="(part._sec~3aprogramming-posn)"></a>Программирование
с <span class="RktSym">posn</span></h4>

<p></p>

<div class="SIntrapara">Теперь рассмотрим разработку функции, которая вычисляет расстояние от некоторого местоположения до начала холста: 
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_66.png" alt="image" width="160.0" height="129.2"></p>

</blockquote></div><div class="SIntrapara">
Изображение поясняет, что “distance”(расстояние) означает длину самого прямого пути - 
“по прямой“ - от обозначенной точки до верхнего левого угла холста. 
</div>

<p></p>

<p></p>

<div class="SIntrapara">Вот предназначение и заголовок: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the distance of </span><span class="RktSym">ap</span><span class="RktCmt"> to the origin </span><a name="(idx._(gentag._129))"></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Ключ в том, что 
<span class="RktSym">distance-to-0</span> потребляет одно значение, некоторое 
<span class="RktSym">posn</span>. Она выдает единственное значение - расстояние от 
местоположения до начала координат. 
</div>

<p></p>

<p></p>

<div class="SIntrapara">Чтобы составить примеры, нам нужно знать, как вычислить это расстояние.
Для точек с <span class="RktVal">0</span> в качестве одной из координат результатом 
будет другая координата: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В общем случае мы могли бы попытаться вычислить формулу самостоятельно или вспомнить 
формулу из наших курсов геометрии. Как вы знаете, это знания в предметной области, 
которые у вас могут быть, но если вы этого не знаете, мы их предоставим; в конце концов, 
это не компьютерные науки. Итак, вот формула расстояния для 
<span style="font-style: italic"></span>(<span style="font-style: italic">x,y</span>)<span style="font-style: italic"></span>: 
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img src="part_one_files/pict_67.png" alt="image" width="52" height="15"></p>

</blockquote></div><div class="SIntrapara">Используя эту формулу, мы легко можем составить 
еще несколько функциональных примеров: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktVal">12</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
На всякий случай, если вам интересно, мы подстроили примеры так, чтобы результаты 
было легко понять. Это не относится ко всем структурам <span class="RktSym">posn</span>.
</div>

<p></p>

<p>Стоп! Подставьте координаты x и y из примеров в формулу. Подтвердите ожидаемые 
результаты для всех пяти примеров.</p>

<p></p>

<div class="SIntrapara">
Теперь мы можем обратить внимание на определение функции. Примеры подразумевают, что при 
разработке <span class="RktSym">distance-to-0</span> не требуется различать разные ситуации; 
она всегда просто вычисляет расстояние от координат x и y внутри данной структуры 
<span class="RktSym">posn</span>. Но функция должна выбирать эти координаты из заданной 
структуры <span class="RktSym">posn</span>. И для этого она использует примитивы 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span> и <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span>. В частности, функции необходимо 
вычислить <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="stt"> </span><span class="RktSym">ap</span><span class="RktPn">)</span> и 
<span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="stt"> </span><span class="RktSym">ap</span><span class="RktPn">)</span>, потому что <span class="RktSym">ap</span>
 - это имя данной неизвестной структуры <span class="RktSym">posn</span>: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Используем этот шаблон и примеры, остальное просто: <a name="(idx._(gentag._130))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqrt%29%29" class="RktValLink" data-pltdoc="x">sqrt</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqr%29%29" class="RktValLink" data-pltdoc="x">sqr</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqr%29%29" class="RktValLink" data-pltdoc="x">sqr</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Функция квадратов 
<span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="stt"> </span><span class="RktSym">ap</span><span class="RktPn">)</span> и
<span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="stt"> </span><span class="RktSym">ap</span><span class="RktPn">)</span>, которые представляют координаты x и y,
суммирует результаты и извлекает квадратный корень. 
С DrRacket мы также можем быстро проверить, что наша новая функция дает правильные результаты 
для наших примеров. </div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._struct1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;63. Вычислите вручную следующие выражения: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktVal">3</span><span class="stt"> </span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktVal">6</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">distance-to-0</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktVal">12</span><span class="stt"> </span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">10</span><span class="RktPn">)</span></p>

</li></ul></div><div class="SIntrapara">Покажите все шаги. Предположим, что 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._sqr%29%29" class="RktValLink" data-pltdoc="x">sqr</a></span> выполняет свои вычисления за один шаг. 
Проверьте результаты с помощью пошагового исполнителя DrRacket. 
 <a href="#%28counter._%28exercise._struct1%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._struct2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;64. 
Манхэттенское расстояние от точки до начала координат учитывает путь, который следует 
по прямоугольной сетке улиц Манхэттена. Вот два примера: 
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_68.png" alt="image" width="167.70000000000002" height="136.9"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_69.png" alt="image" width="167.70000000000002" height="136.9"></p>

</blockquote></div><div class="SIntrapara">Левый показывает “прямую“ стратегию, 
идущую как можно дальше влево, за которой следует столько шагов вверх, сколько необходимо. 
Для сравнения, правый показывает стратегию “случайного блуждания“, когда на несколько 
кварталов влево, на несколько кварталов вверх и так далее, пока не будет достигнут пункт 
назначения - здесь это начало координат. </div>

<p></p>

<p>Стоп! Имеет ли значение, какой стратегии вы придерживаетесь? </p>

<p>Разработайте функцию <span class="RktSym">manhattan-distance</span>, которая измеряет
манхэттенское расстояние от заданной <span class="RktSym">posn</span> точки до 
начала координат.  <a href="#%28counter._%28exercise._struct2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>5.4<tt>&nbsp;</tt><a name="(part._sec~3astructures)"></a>Определение структурных типов </h4>

<p>В отличие от чисел или логических значений, такие структуры, как 
<span class="RktSym">posn</span>, обычно не поставляются с языком программирования.
Предоставляется только механизм определения структурных типов; остальное остается 
на усмотрение программиста. Это также верно и для BSL. </p>

<p></p>

<div class="SIntrapara">
<span style="font-style: italic">Определение структурного типа</span> - это еще одна форма
определения, отличная от определений констант и функций. Вот как создатель DrRacket 
определил структурный тип <span class="RktSym">posn</span> в BSL: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">posn</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">
В общем, определение типа структуры имеет такую форму: 
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Использование скобок в определении типа структуры является условностью, а не необходимостью. 
Они выделяют имена полей. Замена квадратных скобок круглыми скобками вполне приемлема. 
</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktVar">StructureName</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">FieldName</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Ключевое слово 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span> сигнализирует о введении нового 
структурного типа. За ним следует название структуры. Третья часть определения структурного 
типа - это последовательность имен, заключенная в скобки; эти имена - 
<span style="font-style: italic">полей</span>. </div>

<p></p>

<p></p>

<div class="SIntrapara">Определение структурного типа фактически определяет функции. 
Но, в отличие от обычного определения функции, <span style="font-weight: bold">
определение структурного типа одновременно определяет несколько функций</span>. 
В частности, оно определяет три вида функций: 
</div><div class="SIntrapara"><ul><li>

<p>одна <span style="font-style: italic">конструктор</span>, функция, которая создает 
<span style="font-style: italic">экземпляры структуры</span>. Принимает столько значений, 
сколько полей; как уже упоминалось, <span style="font-style: italic">структура</span> - 
это короткое имя от экземпляра структуры. Фраза <span style="font-style: italic">структурный
тип</span> - это общее имя для набора всех возможных экземпляров; </p>

</li><li>

<p>по одному <span style="font-style: italic">селектору</span> на поле, который извлекает 
значение поля из экземпляра структуры; а также </p>

</li><li>

<p>один <span style="font-style: italic">предикат структуры</span>, который, как и 
обычные предикаты, отличает экземпляры структурного типа от всех других типов значений. </p>

</li></ul></div><div class="SIntrapara">Программа может использовать их, как если бы они были функциями или встроенными примитивами. </div>

<p></p>

<p>Любопытно, что определение типа структуры дает имена для различных новых операций, 
которые оно создает. Для имени конструктора оно ставит перед именем структуры префикс 
“make-” а для имен селекторов оно добавляет после имени структуры имена полей. 
Наконец, предикат - это просто имя структуры с “?” добавлено, произносится как “huh” 
при чтении вслух. </p>

<p>Это соглашение об именах выглядит сложным и, возможно, даже сбивающим с толку. 
Но, немного попрактиковавшись, вы научитесь этому. Оно также объясняет функции, 
которые поставляются со структурами <span class="RktSym">posn</span>: 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span> - конструктор, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span> и 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span> - селекторы. Пока мы не сталкивались с <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span> тем не менее, теперь мы знаем, что она существует; 
в следующей главе подробно объясняется роль этих предикатов. </p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._struct3))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;65. Взгляните на следующие определения структурных типов: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">movie</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">title</span><span class="stt"> </span><span class="RktSym">producer</span><span class="stt"> </span><span class="RktSym">year</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">person</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">name</span><span class="stt"> </span><span class="RktSym">hair</span><span class="stt"> </span><span class="RktSym">eyes</span><span class="stt"> </span><span class="RktSym">phone</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">pet</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">name</span><span class="stt"> </span><span class="RktSym">number</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">CD</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">artist</span><span class="stt"> </span><span class="RktSym">title</span><span class="stt"> </span><span class="RktSym">price</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">sweater</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">material</span><span class="stt"> </span><span class="RktSym">size</span><span class="stt"> </span><span class="RktSym">producer</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li></ul></div><div class="SIntrapara">
Запишите имена функций (конструкторов, селекторов и предикатов), которые каждое из них вводит.
<a href="#%28counter._%28exercise._struct3%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara">
На время хватит <span class="RktSym">posn</span>-структур. Давайте посмотрим на определение типа структуры, которое мы могли бы использовать для отслеживания контактов, например, 
в вашем мобильном телефоне: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">entry</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">phone</span><span class="hspace">&nbsp;</span><span class="RktSym">email</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Вот названия функций, которые вводит это определение: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktSym">make-entry</span>, которая использует три значения и 
создает экземпляр  <span class="RktSym">entry</span>;</p>

</li><li>

<p><span class="RktSym">entry-name</span>, <span class="RktSym">entry-phone</span> и <span class="RktSym">entry-email</span>, которые используют один экземпляр 
<span class="RktSym">entry</span> и выбирают одно из трех значений поля; а также</p>

</li><li>

<p><span class="RktSym">entry?</span>, предикат.</p>

</li></ul></div><div class="SIntrapara">Поскольку каждая <span class="RktSym">entry</span>
(запись) объединяет три значения, выражение 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym">make-entry</span><span class="hspace">&nbsp;</span><span class="RktVal">"Al Abe"</span><span class="hspace">&nbsp;</span><span class="RktVal">"666-7771"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lee@x.me"</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">создает структуру  <span class="RktSym">entry</span>
 с <span class="RktVal">"Al Abe"</span> в поле <span class="RktSym">name</span>, 
<span class="RktVal">"666-7771"</span> в поле <span class="RktSym">phone</span> и 
<span class="RktVal">"lee@x.me"</span> в поле <span class="RktSym">email</span>.</div>

<p></p>

<p><a name="(counter._(exercise._struct3b))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;66. Вернитесь к определениям структурных типов в 
<a href="#%28counter._%28exercise._struct3%29%29" data-pltdoc="x">упражнении&nbsp;65</a>. 
Сделайте разумные предположения относительно того, какие значения соответствуют каким полям. 
Затем создайте хотя бы один экземпляр для каждого определения типа структуры.  
<a href="#%28counter._%28exercise._struct3b%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>Каждое определение типа структуры вводит новый вид структуры, отличный от всех остальных.
Программистам нужна такая выразительная сила, потому что они хотят передать 
<span style="font-weight: bold">намерение</span> с помощью имени структуры. 
Где бы ни была создана, выбрана или протестирована структура, текст программы явно 
напоминает читателю об этом намерении. Если бы не эти будущие читатели кода, программисты 
могли бы использовать одно определение структуры для структур с одним полем, 
другое для структур с двумя полями, третье для структур с тремя и так далее. </p>

<p></p>

<div class="SIntrapara">В этом контексте давайте изучим еще одну задачу программирования:
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> Разработайте определение структурного
типа для программы, которая имеет дело с “прыгающими мячами“(bouncing balls), о чем кратко
упоминалось в самом начале этой главы. Местоположение мяча - это одно число, 
а именно расстояние в пикселях от верха. Его постоянная 
<span style="font-style: italic">speed</span>(значение скорости) - это количество пикселей, 
на которые он перемещается за такт часов. Его <span style="font-style: italic">velocity</span>(скорость) - это значение скорости <span style="font-weight: bold">плюс</span> направление, 
в котором он движется. </p>

</blockquote></div><div class="SIntrapara">Поскольку мяч движется по прямой вертикальной линии,
число является вполне адекватным представлением данных для его скорости: 
</div><div class="SIntrapara"><ul><li>

<p>Положительное число означает, что мяч движется вниз. </p>

</li><li>

<p>Отрицательное число означает, что он движется вверх. </p>

</li></ul></div><div class="SIntrapara">Мы можем использовать это знание предметной области, 
чтобы сформулировать определение структурного типа: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ball</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">location</span><span class="hspace">&nbsp;</span><span class="RktSym">velocity</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Оба поля будут содержать числа,
поэтому <span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="stt"> </span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span> хороший пример данных.
Он представляет собой шар, который находится на расстоянии <span class="RktVal">10</span> 
пикселей от верха и  перемещается со скоростью <span class="RktVal">3</span> пикселя за
такт часов.</div>

<p></p>

<p>Обратите внимание, как в принципе структура <span class="RktSym">ball</span>(шар) просто
объединяет два числа, как и структура <span class="RktSym">posn</span>. 
Когда программа содержит выражение <span class="RktPn">(</span><span class="RktSym">ball-velocity</span><span class="stt"> </span><span class="RktSym">a-ball</span><span class="RktPn">)</span>, оно  немедленно сообщает, что эта программа имеет дело с представлением шара и
его скорости. Напротив, если вместо этого программа использовала бы структуры 
<span class="RktSym">posn</span>,
 <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="stt"> </span><span class="RktSym">a-ball</span><span class="RktPn">)</span> это могло бы ввести читателя кода
в заблуждение, так что он могбы подумать, что выражение относится к координате y.</p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._struct4))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;67. Вот еще один способ представить прыгающие мячи:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">SPEED</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">balld</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">location</span><span class="hspace">&nbsp;</span><span class="RktSym">direction</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">make-balld</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">"up"</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Интерпретируйте этот фрагмент кода и создайте другие экземпляры
 <span class="RktSym">balld</span>. <a href="#%28counter._%28exercise._struct4%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p>Поскольку структуры являются значениями, как числа, логические значения или
строки, логично, что один экземпляр структуры находиться внутри другого экземпляра. 
Рассмотрим игровые объекты. В отличии от прыгающих мячей, такие объекты не всегда
движутся по вертикальным линиям. Вместо этого они движутся по холсту “наклонно(oblique)”.
Для описания местоположения и скорости мяча, движущегося по двумерному мировому
холсту требуется два числа: по одному для каждого направления.
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Это физика, которая говорит вам добавить скорость объекта к его
местоположению, чтобы определить его следующее местоположение. 
РАзработчикам необходимо узнать, кого спрашивать о какой области знаний.
</span></span></span>  
Для части местоположения два числа пердставляют координаты x и y. 
Скорость описывает <span style="font-style: italic">изменения</span> 
в горизонтальном и вертикальном направлении; другими словами, эти
 “числа изменений” должны быть добавлены к соответствующим координатам,
чтобы узнать следующее местоположение объекта.
</p>

<p></p>

<div class="SIntrapara">Ясно, что <span class="RktSym">posn</span> структуры
могут представлять местополжения. Для скоростей определим структурный тип 
<span class="RktSym">vel</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">vel</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">deltax</span><span class="hspace">&nbsp;</span><span class="RktSym">deltay</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Она имеет два поля: 
<span class="RktSym">deltax</span> и <span class="RktSym">deltay</span>.  
Слово “delta” обычно используется для обозначения изменений, когда речь идет
о моделирвоании физической активности, а части x и y указывают, какая ось задействована.
</div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь мы можем использовать экземпляры 
<span class="RktSym">ball</span> для объединения структуры 
<span class="RktSym">posn</span> со структурой <span class="RktSym">vel</span> 
для представления мячей, которые двигаются по прямым линиям, но обязательно
только по вертикальным(или горизонтальным) линиям:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ball1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>0</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Один из способов интерпретации этого экземпляра -
представить мяч, расположенный на <span class="RktVal">30</span> пикселей слева и
 <span class="RktVal">40</span> пикселей от верха. Он перемещается на
<span class="RktVal">10</span> пикселей влево за один такт часов, потоу что вычитание
10 пикселей из координаты x приближает его к левому краю. 
Что касается вертикального направления, мяч падает со скоростью
<span class="RktVal">5</span> пикселей за такт часов, потому что добавление положительных
чисел к координате увеличивает расстояние от верха.
</div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._struct5))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;68. Альтернатива вложенному представлению данных о мячах использует
четыре поля для отслеживания четырех свойств:
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Еще одна альтернатива использует <span style="font-style: italic">комплексные числа</span>. 
Если вы знаете о них, подумайте о представлении данных в котором они используются для
определения местоположения, так и для определения скорости. 
Например в BSL, <span class="RktVal">4-3i</span>  комплексное число, которое может использоваться
для обозначения местоположения или скорости <span style="font-style: italic"></span>(<span style="font-style: italic"></span>4<span style="font-style: italic">,-</span>3<span style="font-style: italic"></span>)<span style="font-style: italic"></span>.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ballf</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">deltax</span><span class="hspace">&nbsp;</span><span class="RktSym">deltay</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Программисты называют его <span style="font-style: italic">плоским(flat) представлением</span>. Создайте экземпляры
 instance of <span class="RktSym">ballf</span> интерпретируемы также, как
<span class="RktSym">ball1</span>. 
<a href="#%28counter._%28exercise._struct5%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara">В качестве второго примера вложенных структур давайте
кратко рассмотрим пример списка контактов. многие сотовые телефоны поддерживают
списки контактов, которые позволяют использовать несколько телефонных номеров для
каждого имени: один для домашнего телефона, один для офиса, один для номера 
сотвого телефона. Для телефонных номеров мы хотим указать код города, так и местный 
номер. Поскольку при этом информация вложена, лучше всего также создавать
вложенное представление данных:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">centry</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">home</span><span class="hspace">&nbsp;</span><span class="RktSym">office</span><span class="hspace">&nbsp;</span><span class="RktSym">cell</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">phone</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">area</span><span class="hspace">&nbsp;</span><span class="RktSym">number</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">make-centry</span><span class="hspace">&nbsp;</span><span class="RktVal">"Shriram Fisler"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">207</span><span class="hspace">&nbsp;</span><span class="RktVal">"363-2421"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">101</span><span class="hspace">&nbsp;</span><span class="RktVal">"776-1099"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">208</span><span class="hspace">&nbsp;</span><span class="RktVal">"112-9981"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Намерение состоит в том, что запись в списке контактов имеет четыре поля: 
имя и три телефонных записи. Последние представлены экземпляром
 <span class="RktSym">phone</span>, который отделяет код города от местного номера
телефона.
</div>

<p></p>

<p>В общем, вложенность информации естественна. Лучший способ представить
такую информацию в данных - отразить вложенность с помощью экземпляров
вложенных структур. Это упрощает интерпретацию данных в прикладной области
программы, а также упрощает переход от примеров информации к данным.
Конечно, на самом деле задача определения данных состоит в том, чтобы указать,
как перемещаться между информацией и данными. Однако прежде чем изучать
определения данных для определений типов структур, мы сначала рассмотрим
вычисления и размышления о структурах.</p>

<h4>5.5<tt>&nbsp;</tt><a name="(part._sec~3aeval-structs)"></a>Вычисления со Структурами</h4>

<p>Структурные типы обобщают декартовы точки двумя способами.
Во-первых, структурный тип может указывать произвольное количество полей:
ноль, одно, два, три и так далее.
Во-вторых, структурные типы именуют поля, а не нумеруют их.
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Большинство языков программирования также поддерживают структуро-подобные данные,
которые используют числовые имена полей.</span></span></span> 
Это помогает программистам читать код, потому что гораздо легче запомнить, что
фамилия доступна в поле с именем  <span class="RktSym">last-name</span>, 
чем в <span style="font-style: italic"></span>7<span style="font-style: italic"></span>-ом поле.
</p>

<p></p>

<div class="SIntrapara">В том же духе вычисления с экземплярами структур обобщают
манипуляции с декартовыми точками. Чтобы оценить эту идею, давайте сначала рассмотрим
схематический представления экземпляров структуры как ящиков(lockboxes) с таким
количеством отсеков, сколько имеется полей. Вот представление
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-entry</span><span class="hspace">&nbsp;</span><span class="RktVal">"Al Abe"</span><span class="hspace">&nbsp;</span><span class="RktVal">"666-7771"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lee@x.me"</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">в виде такой диаграммы:
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_70.png" alt="image" width="206.388671875" height="53.861328125"></p>

</blockquote></div><div class="SIntrapara">Обведенная курсивна метка блока указывает на то,
что он является экземпляром определенного типа структуры; каждый отсек тоже промаркирован.
Вот еще один экземпляр:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym">make-entry</span><span class="hspace">&nbsp;</span><span class="RktVal">"Tara Harp"</span><span class="hspace">&nbsp;</span><span class="RktVal">"666-7770"</span><span class="hspace">&nbsp;</span><span class="RktVal">"th@smlu.edu"</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">соответствующий аналогичной прямоугольной диаграмме, но отличающийся по содержанию:
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_71.png" alt="image" width="243.0361328125" height="53.861328125"></p>

</blockquote></div>

<p></p>

<p>Неудивительно, что экземпляры вложенных структур имеют диаграмму блоков, вложенных в
блоки. Таким образом, <span class="RktSym">ball1</span> определенный выше эквивалентен
этой диаграмме:
</p>

<p></p>

<div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_72.png" alt="image" width="123.921875" height="85.64453125"></p>

</blockquote></div><div class="SIntrapara">В этом случае внешний блок содержит два блока,
по одному на поле.</div>

<p></p>

<p><a name="(counter._(exercise._struct3a))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;69. Нарисуйте блок представляющий решение из 
<a href="#%28counter._%28exercise._struct3%29%29" data-pltdoc="x">упражнения&nbsp;65</a>. <a href="#%28counter._%28exercise._struct3a%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">В контексте этого изображения селектор похож на ключ. 
Он открывает специальное отделение для определенного типа блока и, таким образом,
позволяет держателю ключа извлекать его содержимое. Следовательно, применение 
<span class="RktSym">entry-name</span> к <span class="RktSym">pl</span>
 из выше указанного дает строку:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">entry-name</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">"Al Abe"</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Но 
<span class="RktSym">entry-name</span> примененное к структуре
<span class="RktSym">posn</span> сигнализирует об ошибке:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">entry-name</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">entry-name:expects an entry, given (posn 42 5)</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara"> Если отделение содержит
блок, может потребоваться два селектора подряд, чтобы перейти к желаемому числу:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">ball-velocity</span><span class="hspace">&nbsp;</span><span class="RktSym">ball1</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">(make-vel -10 5)</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Применение <span class="RktSym">ball-velocity</span> к <span class="RktSym">ball1</span> извлекает значение
поля velocity(скорости), которое является экземпляром <span class="RktSym">vel</span>. 
Чтобы перейти от скорости к скорости по оси x, мы применяем селектор к результату первого
выбора(selection):
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">vel-deltax</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-velocity</span><span class="hspace">&nbsp;</span><span class="RktSym">ball1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">-10</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Поскольку
внутреннее выражение извлекает скорость(velocity) из <span class="RktSym">ball1</span>, 
внешнее выражение извлекает значение поля <span class="RktSym">deltax</span>, 
которое в данном случае равно 
<span class="RktVal"><span class="nobreak">-1</span>0</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Взаимодействия также показывают, что экземпляры структуры являются
значениями.DrRacket печатает их точно так, как они были введены, как и для простых значений,
таких как числа:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>0</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">(make-vel -10 5)</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">make-entry</span><span class="hspace">&nbsp;</span><span class="RktVal">"Tara Harp"</span><span class="hspace">&nbsp;</span><span class="RktVal">"666-7770"</span><span class="hspace">&nbsp;</span><span class="RktVal">"th@smlu.edu"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">(make-entry "Tara Harp" "666-7770" "th@smlu.edu")</span></p>

</td></tr><tr><td><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">make-centry</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">"Shriram Fisler"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">207</span><span class="hspace">&nbsp;</span><span class="RktVal">"363-2421"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">101</span><span class="hspace">&nbsp;</span><span class="RktVal">"776-1099"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">208</span><span class="hspace">&nbsp;</span><span class="RktVal">"112-9981"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr><tr><td>

<p><span class="RktRes">(make-centry ...)</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Стоп! 
Попробуйте это последнее взаимодействия дома, чтобы увидеть правильный результат.
</div>

<p></p>

<p>Вообще говоря, определение типа структуры не только создает новые функции
и новые способы создания значений, но также добавляет новые законы вычислений
к знаниям DrRacket. Эти законы являются обобщением для структур
 <span class="RktSym">posn</span>  в <a href="#%28part._sec~3aeval-posns%29" data-pltdoc="x">Вычисления с  <span class="RktSym">posn</span>s</a>, и их лучше всего
понять на примере.</p>

<p></p>

<div class="SIntrapara">Когда  DrRacket встречает определение типа структуры с двумя
полями,
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ball</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">location</span><span class="hspace">&nbsp;</span><span class="RktSym">velocity</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">он вводит два закона, по одному для каждого 
селектора:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym">ball-location</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="stt"> </span><span class="RktSym">l0</span><span class="stt"> </span><span class="RktSym">v0</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">==</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">l0</span></p>

</td></tr><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym">ball-velocity</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="stt"> </span><span class="RktSym">l0</span><span class="stt"> </span><span class="RktSym">v0</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">==</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">v0</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Для других(отличных) определений структурных типов вводятся аналогичные законы.
Таким образом,
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">vel</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">deltax</span><span class="hspace">&nbsp;</span><span class="RktSym">deltay</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">DrRacket добавляет к своим знаниям эти два закона:
</div><div class="SIntrapara"><blockquote><table cellspacing="0" cellpadding="0"><tbody><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym">vel-deltax</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="stt"> </span><span class="RktSym">dx0</span><span class="stt"> </span><span class="RktSym">dy0</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">==</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">dx0</span></p>

</td></tr><tr><td valign="top">

<p><span class="RktPn">(</span><span class="RktSym">vel-deltay</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="stt"> </span><span class="RktSym">dx0</span><span class="stt"> </span><span class="RktSym">dy0</span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">==</span></p>

</td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top">

<p><span class="RktSym">dy0</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Используя эти законы, мы можем теперь объяснить взаимодействия описанное
выше:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">vel-deltax</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-velocity</span><span class="hspace">&nbsp;</span><span class="RktSym">ball1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> replaces </span><span class="RktSym">ball1</span><span class="RktCmt"> with its value </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">vel-deltax</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ball-velocity</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">40</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>0</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> uses the law for </span><span class="RktSym">ball-velocity</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">vel-deltax</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>0</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktSym">==</span><span class="hspace">&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">DrRacket</span><span class="RktCmt"> uses the law for </span><span class="RktSym">vel-deltax</span></td></tr><tr><td><span class="RktVal"><span class="nobreak">-1</span>0</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._ex~3acompute-struct1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;70. Объясните законы для этих определений
структурынх типов:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">centry</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">home</span><span class="hspace">&nbsp;</span><span class="RktSym">office</span><span class="hspace">&nbsp;</span><span class="RktSym">cell</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">phone</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">area</span><span class="hspace">&nbsp;</span><span class="RktSym">number</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Используйте пошаговый исполнитель
DrRacket, чтобы подтвердить <span class="RktVal">101</span> как значение этого выражения:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">phone-area</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">centry-office</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-centry</span><span class="hspace">&nbsp;</span><span class="RktVal">"Shriram Fisler"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">207</span><span class="hspace">&nbsp;</span><span class="RktVal">"363-2421"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">101</span><span class="hspace">&nbsp;</span><span class="RktVal">"776-1099"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-phone</span><span class="hspace">&nbsp;</span><span class="RktVal">208</span><span class="hspace">&nbsp;</span><span class="RktVal">"112-9981"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><a href="#%28counter._%28exercise._ex~3acompute-struct1%29%29" class="ex-end" data-pltdoc="x"></a></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Предикаты  - это последняя идея, которую мы должны обсудить,
чтобы понять определения структурных типов. Как уже упоминалось, каждое определение
структурного типа вводит новый предикат. DrRacket использует эти предикаты, чтобы
определить, применен ли селектор к нужному типу значения; в следующей главе эта
идея подробно объясняется. Здесь мы просто хотим показать, что эти предикаты похожи на
предикаты из “африфметики.”
 Пока <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span> распознает числа и 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span> распознает строки, такие предикаты как
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span> и <span class="RktSym">entry?</span> распознают структуры
 <span class="RktSym">posn</span> и структуры <span class="RktSym">entry</span>. 
Мы можем подтвердить наши представления о том, как они работают с экспериментами в области
взаимодействия. Предположим, что область определений содержит следующие определения:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-entry</span><span class="hspace">&nbsp;</span><span class="RktVal">"Al Abe"</span><span class="hspace">&nbsp;</span><span class="RktVal">"666-7771"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lee@x.me"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Если <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span> это предикат, который отличает
 <span class="RktSym">posn</span> от всех других значений, мы должны ожидать, что он даст
 <span class="RktVal">#false</span> для чисел и <span class="RktVal">#true</span> для 
<span class="RktSym">ap</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ap</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Также, <span class="RktSym">entry?</span> отличает структуры <span class="RktSym">entry</span> от
всех других значений:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">entry?</span><span class="hspace">&nbsp;</span><span class="RktSym">pl</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#true</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">entry?</span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">entry?</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">В общем, предикат
распознает именно те значения, которые созданы с помощью конструктора с тем же именем.
<a href="i1-2.html" data-pltdoc="x">Интермеццо 1: Язык начинающих студентов(Beginning Student Language)</a> подробно объясняет этот закон, а также собирает законы вычислений
для BSL в одном месте.</div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._ex~3acompute-struct2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;71. Поместите следующее в область
определений DrRacket:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">distances in terms of pixels:</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MIDDLE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._quotient%29%29" class="RktValLink" data-pltdoc="x">quotient</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">400</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._quotient%29%29" class="RktValLink" data-pltdoc="x">quotient</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">game</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">left-player</span><span class="hspace">&nbsp;</span><span class="RktSym">right-player</span><span class="hspace">&nbsp;</span><span class="RktSym">ball</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">game0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-game</span><span class="hspace">&nbsp;</span><span class="RktSym">MIDDLE</span><span class="hspace">&nbsp;</span><span class="RktSym">MIDDLE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="hspace">&nbsp;</span><span class="RktSym">CENTER</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Нажмите <span class="emph">RUN</span> и вычислите следующие выражения:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">game-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">game0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">game-ball</span><span class="hspace">&nbsp;</span><span class="RktSym">game0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">game-left-player</span><span class="hspace">&nbsp;</span><span class="RktSym">game0</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Объясните результаты с помощью пошаговых вычислений. Еще раз проверьте свои вычисления с
помощью пошагового исполнителя DrRacket. 
<a href="#%28counter._%28exercise._ex~3acompute-struct2%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<h4>5.6<tt>&nbsp;</tt><a name="(part._sec~3aprogstructs)"></a>Программирование со Структурами</h4>

<p></p>

<div class="SIntrapara">Правильное программирование требует определения данных.
С введением структурных типов определения данных становятся интересными.
Помните, что определение данных обеспечивает способ представления информации в
данных и интерпретации этих данных как информации. Для структурных типов это требует
описания того, какие данные в какое поле входят. Для некоторых определений
структурных типов сформулировать такие описания легко и очевидно:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">posn</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._posn)"></a><span style="font-style: italic">Posn</span><span class="RktCmt"> is a structure: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> a point </span><span class="RktSym">x</span><span class="RktCmt"> pixels from left, </span><span class="RktSym">y</span><span class="RktCmt"> from top</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">It doesn’t make any sense to use other kinds of data to create a
 <span class="RktSym">posn</span>. Similarly, all fields of <span class="RktSym">entry</span>— our structure type
 definition for entries on a contact list— are clearly supposed to be
 strings, according to our usage in the preceding section:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">entry</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">phone</span><span class="hspace">&nbsp;</span><span class="RktSym">email</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._entry)"></a><span style="font-style: italic">Entry</span><span class="RktCmt"> is a structure: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-entry</span><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> a contact</span><span class="RktCmt">'</span><span class="RktCmt">s name, phone#, and email </span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">For both <span class="RktSym">posn</span> and <span class="RktSym">entry</span>, a reader can easily interpret
 instances of these structures in the application domain.</div>

<p></p>

<p></p>

<div class="SIntrapara">Сравните эту простоту с определением структурного типа для 
<span class="RktSym">ball</span>, которое, очевидно, допускает как минимум две различные
интерпретации: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ball</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">location</span><span class="hspace">&nbsp;</span><span class="RktSym">velocity</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._ball._1d)"></a><span style="font-style: italic">Ball-1d</span><span class="RktCmt"> is a structure:</span><span class="hspace">&nbsp;&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation 1</span><span class="RktCmt"> distance to top and velocity </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation 2</span><span class="RktCmt"> distance to left and velocity </span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Какую бы из них мы ни
использовали в программе, мы должны постоянно ее придерживаться. Однако, как показывает 
<a href="#%28part._sec~3astructures%29" data-pltdoc="x">Определение структурных типов</a>,
можно также использовать структуры <span class="RktSym">ball</span> совершенно по-другому: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._ball._2d)"></a><span style="font-style: italic">Ball-2d</span><span class="RktCmt"> is a structure: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ball</span><span class="stt"> </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="stt"> </span><a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> a 2-dimensional position and velocity</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">vel</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">deltax</span><span class="hspace">&nbsp;</span><span class="RktSym">deltay</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._vel)"></a><span style="font-style: italic">Vel</span><span class="RktCmt"> is a structure: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="stt"> </span><span class="RktSym">dx</span><span class="stt"> </span><span class="RktSym">dy</span><span class="RktPn">)</span><span class="RktCmt"> means a velocity of </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">dx</span><span class="RktCmt"> pixels [per tick] along the horizontal and</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">dy</span><span class="RktCmt"> pixels [per tick] along the vertical direction</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>Здесь мы именуем вторую коллекцию данных <a href="#%28tech._ball._2d%29" class="techoutside" data-pltdoc="x"><span class="techinside">Ball-2d</span></a>, отличную от 
<a href="#%28tech._ball._1d%29" class="techoutside" data-pltdoc="x"><span class="techinside">Ball-1d</span></a>, для описания представлений данных для мячей, 
которые движутся по прямым линиям по мировому холсту. 
Короче говоря, можно использовать <span style="font-weight: bold">один и тот же</span>
 структурный тип <span style="font-weight: bold">двумя разными способами</span>. 
Конечно, в рамках одной программы лучше придерживаться одного и только одного использования; 
в противном случае вы создаете себе проблемы. </p>

<p>Кроме того, <a href="#%28tech._ball._2d%29" class="techoutside" data-pltdoc="x"><span class="techinside">Ball-2d</span></a> ссылается на другое из наших определений данных, 
а именно на определение <a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a>. Хотя все другие определения данных до сих пор относились 
к встроенным коллекциям данных (<a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>, <a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a>, <a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>), вполне приемлемо и на самом деле часто, что одно из ваших определений 
данных ссылается на другое. </p>

<p><a name="(counter._(exercise._struct6))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;72. Сформулируйте определение данных для приведенного выше определения 
структурного типа <span class="RktSym">phone</span>, которое соответствует приведенным 
примерам. </p>

<p></p>

<div class="SIntrapara">Затем сформулируйте определение данных для телефонных номеров, 
используя это определение структурного типа: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">phone#</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">area</span><span class="hspace">&nbsp;</span><span class="RktSym">switch</span><span class="hspace">&nbsp;</span><span class="RktSym">num</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Исторически сложилось так, что первые три 
цифры составляют код города, следующие три - код телефонного коммутатора (телефонной станции)
вашего района, а последние четыре - телефонного номера района. 
Опишите содержимое трех полей как можно точнее с интервалами.
 <a href="#%28counter._%28exercise._struct6%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p>На этом этапе вам может быть интересно, что на самом деле означают определения данных. 
Этот вопрос и ответ на него - тема следующего раздела. А пока мы указываем, как 
использовать определения данных для разработки программ. 
</p>

<p></p>

<div class="SIntrapara">Вот постановка задачи для настройки контекста: 
</div><div class="SIntrapara"><blockquote>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">Пример задачи</span> 
Ваша команда разрабатывает интерактивную игровую программу, которая перемещает 
красную точку по холсту <img src="part_one_files/pict_73.png" alt="image" width="51" height="9">
 и позволяет игрокам использовать мышь для сброса точки. 
Вот как далеко вы продвинулись вместе:<a name="(idx._(gentag._131))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MTS</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">DOT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">"solid"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> represents the state of the world.</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">p0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x+</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-mouse%29%29" class="RktStxLink" data-pltdoc="x">on-mouse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">reset-dot</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;</span><span class="RktSym">scene+dot</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Ваша задача - разработать <span class="RktSym">scene+dot</span>, функцию, которая 
добавляет красную точку на пустой холст в указанной позиции.</div>

<p></p>

</blockquote></div><div class="SIntrapara">Контекст проблемы диктует сигнатуру 
вашей функции:<a name="(idx._(gentag._132))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds a red spot to </span><span class="RktSym">MTS</span><span class="RktCmt"> at </span><span class="RktSym">p</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">scene+dot</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">MTS</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Добавить предназначение несложно. Как упоминается в 
<a href="#%28part._sec~3adesign-func%29" data-pltdoc="x">Разработка Функций</a>, она 
использует параметр функции, чтобы выразить то, что функция вычисляет. </div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь проработаем пару примеров и сформулируем их в виде тестов:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">scene+dot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">DOT</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktSym">MTS</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">scene+dot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">88</span><span class="hspace">&nbsp;</span><span class="RktVal">73</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">DOT</span><span class="hspace">&nbsp;</span><span class="RktVal">88</span><span class="hspace">&nbsp;</span><span class="RktVal">73</span><span class="hspace">&nbsp;</span><span class="RktSym">MTS</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Учитывая, что функция потребляет 
<a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>, мы знаем, что функция может извлекать значения полей  <span class="RktSym">x</span> и <span class="RktSym">y</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">scene+dot</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Как только мы увидим эти дополнительные части в теле функции, остальное определение 
будет простым. Используя <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span>, функция помещает <span class="RktSym">DOT</span> 
в <span class="RktSym">MTS</span> в координатах, содержащихся в
  <span class="RktSym">p</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">scene+dot</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">DOT</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">MTS</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Функция может создавать структуры. Давайте вернемся 
к нашему примеру задачи сверху, потому что он включает в себя именно такую задачу:
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> Коллегу просят определить
<span class="RktSym">x+</span>, функцию, которая потребляет <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a> и 
увеличивает координату x на <span class="RktVal">3</span>.</p>

</blockquote></div><div class="SIntrapara">
Напомним, что функция <span class="RktSym">x+</span> обрабатывает такты часов. </div>

<p></p>

<p></p>

<div class="SIntrapara">Мы можем адаптировать первые несколько шагов разработки
  <span class="RktSym">scene+dot</span>:	<a name="(idx._(gentag._133))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">increases the x-coordinate of </span><span class="RktSym">p</span><span class="RktCmt"> by </span><span class="RktVal">3</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x+</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Сигнатура, цель(предназначение) и пример - все вытекает из постановки задачи. 
Вместо заголовка - функции с результатом по умолчанию - наш набросок содержит 
два выражения селектора для  <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>s. В конце концов, информация для результата 
должна поступать из входных данных, а входные данные представляют собой структуру, 
содержащую два значения. </div>

<p></p>

<p></p>

<div class="SIntrapara">
Завершить определение теперь легко. Поскольку желаемый результат - <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>, функция 
использует <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span> для объединения частей: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x+</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p><a name="(counter._(exercise._ex~3aupdater1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;73. Создайте функцию <span class="RktSym">posn-up-x</span>, которая использует 
<a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a> <span class="RktSym">p</span> и Number <span class="RktSym">n</span>. 
Она создает <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a> как <span class="RktSym">p</span> с 
<span class="RktSym">n</span> в поле <span class="RktSym">x</span>. </p>

<p></p>

<div class="SIntrapara">Замечательное наблюдение: мы можем определить 
<span class="RktSym">x+</span> с помощью  <span class="RktSym">posn-up-x</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x+</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">posn-up-x</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
<span style="font-weight: bold">Примечание</span> 
Такие функции, как <span class="RktSym">posn-up-x</span>, часто называют 
<span style="font-style: italic">updaters</span> или  <span style="font-style: italic">функциональными установщиками</span>. Они чрезвычайно полезны при написании 
больших программ.  
<a href="#%28counter._%28exercise._ex~3aupdater1%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara">Функция также может создавать экземпляры из атомарных данных. 
Хотя <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span> является встроенным примитивом, 
который делает это, наша текущая задача дает еще одну подходящую иллюстрацию: 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> 
Другому коллеге поручено разработать функцию <span class="RktSym">reset-dot</span>, 
которая сбрасывает(в начальное положение) точку(dot) при щелчке мышью. </p>

</blockquote></div><div class="SIntrapara">
Чтобы решить эту проблему, вам нужно вспомнить из 
<a href="#%28part._.D.K._sec~3adesign-world%29" data-pltdoc="x">Проектирование программных миров</a>, что обработчики событий мыши используют четыре значения: текущее состояние мира, x- и y-координаты щелчка мыши и <a href="#%28tech._mouseevt%29" class="techoutside" data-pltdoc="x"><span class="techinside">MouseEvt</span></a>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Добавляя знания из примера проблемы в рецепт разработки программы, 
мы получаем сигнатуру, формулировку цели(предназначение) и заголовок: 
<a name="(idx._(gentag._134))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span><a href="#%28tech._mouseevt%29" class="techoutside" data-pltdoc="x"><span class="techinside">MouseEvt</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">for mouse clicks, </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktCmt">; otherwise </span><span class="RktSym">p</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reset-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">В примерах для обработчиков событий мыши требуется 
<a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>, два числа и <a href="#%28tech._mouseevt%29" class="techoutside" data-pltdoc="x"><span class="techinside">MouseEvt</span></a>, который представляет собой просто особый вид 
<a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a>. Например, щелчок мыши представлен одной из двух строк: <span class="RktVal">"button-down"</span> и  <span class="RktVal">"button-up"</span>. Первая
сигнализирует, что пользователь щелкнул кнопку мыши, вторая сигнализирует о ее отпускании. 
Имея это в виду, вот два примера, которые вы, возможно, захотите изучить и интерпретировать: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reset-dot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">29</span><span class="hspace">&nbsp;</span><span class="RktVal">31</span><span class="hspace">&nbsp;</span><span class="RktVal">"button-down"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">29</span><span class="hspace">&nbsp;</span><span class="RktVal">31</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reset-dot</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">29</span><span class="hspace">&nbsp;</span><span class="RktVal">31</span><span class="hspace">&nbsp;</span><span class="RktVal">"button-up"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Хотя функция использует только атомарные формы данных, 
ее цель и примеры предполагают, что она различает два вида <a href="#%28tech._mouseevt%29" class="techoutside" data-pltdoc="x"><span class="techinside">MouseEvt</span></a>: 
<span class="RktVal">"button-down"</span> и все остальные. 
Такое разделение вариантов предполагает выражение cond: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reset-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._mouse~3d~3f%29%29" class="RktValLink" data-pltdoc="x">mouse=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"button-down"</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Следуя рецепту разработки, этот набросок упоминает параметры, чтобы напомнить вам, 
какие данные доступны.</div>

<p></p>

<p></p>

<div class="SIntrapara">Остальное снова просто, потому что предназначение определяет, 
что функция вычисляет в каждом из двух случаев: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">reset-dot</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._mouse~3d~3f%29%29" class="RktValLink" data-pltdoc="x">mouse=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">me</span><span class="hspace">&nbsp;</span><span class="RktVal">"button-down"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как и выше, мы могли бы упомянуть, что 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span> создает экземпляры <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>, но вы это знаете, 
и нам не нужно постоянно вам это напоминать. </div>

<p></p>

<p><a name="(counter._(exercise._ex~3arun-mouse-program))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;74. Скопируйте все соответствующие определения констант и 
функций в область определений DrRacket. Добавьте тесты и убедитесь, что они прошли. 
Затем запустите программу и с помощью мыши разместите красную точку.  
<a href="#%28counter._%28exercise._ex~3arun-mouse-program%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">
Многие программы имеют дело с вложенными структурами. Проиллюстрируем этот момент 
еще одним небольшим отрывком из программного мира: 
</div><div class="SIntrapara"><blockquote>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">Пример Задачи</span> 
Ваша команда разрабатывает игровую программу, которая отслеживает объект, 
перемещающийся по холсту с изменяющейся скоростью. 
Выбранное представление данных требует двух определений данных: 
<span class="refelem"><span class="refcolumn"><span class="refcontent">Помните, это о физике.</span></span></span>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ufo</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">loc</span><span class="hspace">&nbsp;</span><span class="RktSym">vel</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._ufo)"></a><span style="font-style: italic">UFO</span><span class="RktCmt"> is a structure: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="stt"> </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="stt"> </span><a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="stt"> </span><span class="RktSym">p</span><span class="stt"> </span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktCmt"> is at location</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktSym">p</span><span class="RktCmt"> moving at velocity </span><span class="RktSym">v</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Ваша задача разработать <span class="RktSym">ufo-move-1</span>.
 Функция вычисляет местоположение данного <a href="#%28tech._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a> после прохождения одного такта часов. 
</div>

<p></p>

</blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Давайте начнем с нескольких примеров, которые немного исследуют
определения данных: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-vel</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-5</span></span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="refelem"><span class="refcolumn"><span class="refcontent">Порядок этих определений имеет значение. См. <a href="i1-2.html" data-pltdoc="x">Intermezzo 1: язык для начинающих студентов.</a>.</span></span></span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktVal">80</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">30</span><span class="hspace">&nbsp;</span><span class="RktVal">77</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">p1</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">p1</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u3</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">p2</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">u4</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">p2</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Первые четыре являются элементами <a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a> и
 <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>. Последние четыре объединяют первые четыре во всех возможных комбинациях. </div>

<p></p>

<p></p>

<div class="SIntrapara">Затем мы записываем сигнатуру, цель(предназначение), 
несколько примеров и заголовок функции:<a name="(idx._(gentag._135))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">determines where </span><span class="RktSym">u</span><span class="RktCmt"> moves in one clock tick; </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">leaves the velocity as is</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-move-1</span><span class="hspace">&nbsp;</span><span class="RktSym">u1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">u3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-move-1</span><span class="hspace">&nbsp;</span><span class="RktSym">u2</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">17</span><span class="hspace">&nbsp;</span><span class="RktVal">77</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-move-1</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В качестве <a name="(idx._(gentag._136))"></a>примеров функций мы используем 
<a name="(idx._(gentag._137))"></a>примеры данных<span style="font-weight: bold"> и </span>
наши знания о положениях и скоростях в предметной области. 
В частности, мы знаем, что транспортное средство, которое движется на север со скоростью 
60 миль в час и на запад со скоростью 10 миль в час, будет в конце часа езды на 60 миль 
к северу от начальной точки и на 10 миль к западу. Через два часа он будет в 120 милях 
к северу от начальной точки и в 20 милях к западу. </div>

<p></p>

<p></p>

<div class="SIntrapara">Как всегда, функция, потребляющая экземпляр структуры, 
может (и, вероятно, должна) извлекать информацию из структуры для вычисления своего
результата. Итак, мы снова добавляем селекторные выражения к определению функции: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-move-1</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-vel</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">Примечание</span> 
Выражения селектора поднимают вопрос, нужно ли нам еще больше уточнить этот набросок. 
В конце концов, эти два выражения извлекают экземпляры 
<a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a> и <a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a> соответственно. Эти два также являются экземплярами 
структур, и мы можем извлекать из них значения по очереди. 
Вот как будет выглядеть получившийся скелет:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-move-1</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vel-deltax</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-vel</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vel-deltay</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-vel</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Однако это явно делает набросок довольно сложным. Для действительно реалистичных программ
доведение этой идеи до ее логического конца создало бы невероятно сложные схемы программы. 
В более общем смысле, 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-style: italic">
Если функция имеет дело с вложенными структурами, разработайте по одной функции для каждого уровня вложенности. 
</span></p>

</blockquote></div><div class="SIntrapara">Во второй части книги это 
<a name="(idx._(gentag._138))"></a> руководство  становится еще более важным, 
и мы его немного уточняем.  <span style="font-weight: bold">Конец</span></div>

<p></p>

<p></p>

<div class="SIntrapara">Здесь мы сосредотачиваемся на том, как объединить данный 
<a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a> и данный <a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a>, чтобы получить следующее местоположение 
a href="#%28tech._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a> - потому что это то, что нам говорят наши знания физики. 
В частности, они говорят, что нужно “сложить“ эти две величины вместе, где “сложение“
не может означать операцию, которую мы обычно применяем к числам. 
Итак, давайте представим, что у нас есть функция для добавления <a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a> в <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>: 
<a name="(idx._(gentag._139))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span><a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktSym">v</span><span class="RktCmt"> to </span><span class="RktSym">p</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">posn+</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Запись сигнатуры, цели(предназначения) и заголовка таким образом - законный способ
программирования. Это называется “загадывать (по)желание“ и является частью 
“составления списка пожеланий“, как описано в разделе 
<a href="#%28part._sec~3adesign%29" data-pltdoc="x">От Функций к Программам</a>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Главное - загадывать желания таким образом, чтобы мы могли 
выполнить функцию, над которой работаем. Таким образом, мы можем разделить сложные 
задачи программирования на разные задачи, метод, который помогает нам решать проблемы 
разумно небольшими шагами. Для примера задачи мы получаем полное определение 
<span class="RktSym">ufo-move-1</span>:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-move-1</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">posn+</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-loc</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-vel</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-vel</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Поскольку <span class="RktSym">ufo-move-1</span> и <span class="RktSym">posn+</span> 
являются полными определениями, мы можем даже нажать <span class="emph">RUN</span>, 
что проверит, что DrRacket пока не жалуется на грамматические проблемы с нашей работой.
Естественно, тесты не проходят, потому что <span class="RktSym">posn+</span> - это просто
пожелание, а не функция, которая нам нужна.</div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь пора сосредоточиться на <span class="RktSym">posn+</span>. 
Мы завершили первые два шага проектирования (определения данных, сигнатура/цель(предназначение/
заголовок),
<span class="refelem"><span class="refcolumn"><span class="refcontent">
В геометрии операция, соответствующая <span class="RktSym">posn+</span>, называется 
<span style="font-style: italic">translation(переносом)</span>.</span></span></span> 
поэтому мы должны создавать примеры. Один простой способ создать функциональные примеры 
для “пожеланий“ - использовать примеры для исходной функции и превратить их в примеры для новой функции:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">posn+</span><span class="hspace">&nbsp;</span><span class="RktSym">p1</span><span class="hspace">&nbsp;</span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">p2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">posn+</span><span class="hspace">&nbsp;</span><span class="RktSym">p1</span><span class="hspace">&nbsp;</span><span class="RktSym">v2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">17</span><span class="hspace">&nbsp;</span><span class="RktVal">77</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Для этой проблемы мы знаем, что <span class="RktPn">(</span><span class="RktSym">ufo-move-1</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">make-ufo</span><span class="stt"> </span><span class="RktSym">p1</span><span class="stt"> </span><span class="RktSym">v1</span><span class="RktPn">)</span><span class="RktPn">)</span> производит 
<span class="RktSym">p2</span>. В то же время мы знаем, что <span class="RktSym">ufo-move-1</span> применяет <span class="RktSym">posn+</span> к <span class="RktSym">p1</span> и 
<span class="RktSym">v1</span>, подразумевая, что <span class="RktSym">posn+</span> должен
производить <span class="RktSym">p2</span> для этих входных данных. 
Стоп! Проверьте наши ручные вычисления, чтобы убедиться, что вы следуете тому, 
что мы делаем. </div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь мы можем добавить выражения селектора в наш набросок(эскиз) проекта: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">posn+</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vel-deltax</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vel-deltay</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Поскольку <span class="RktSym">posn+</span> использует экземпляры a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a> и
 <a href="#%28tech._vel%29" class="techoutside" data-pltdoc="x"><span class="techinside">Vel</span></a> и поскольку каждый фрагмент данных является экземпляром структуры с двумя полями,
 мы получаем четыре выражения. В отличие от вложенных выражений селектора, приведенных выше, 
это простые применения селектора к параметру.</div>

<p></p>

<p></p>

<div class="SIntrapara">Если мы напомним себе, что представляют собой эти четыре выражения, или если мы вспомним, как мы вычисляли желаемые результаты из двух структур, наше завершение определения <span class="RktSym">posn+</span> будет простым: 
 <a name="(idx._(gentag._140))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">posn+</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vel-deltax</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">vel-deltay</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Первый шаг - добавить скорость в горизонтальном направлении к координате x и 
скорость в вертикальном направлении к координате y. Это дает два выражения, по одному для 
каждой новой координаты. С помощью <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span> мы снова можем объединить 
их в один <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>. </div>

<p></p>

<p><a name="(counter._(exercise._ex~3atry-it-out))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;75. 
Введите эти определения и их тестовые примеры в область определений DrRacket и убедитесь, 
что они работают. Это первый раз, когда вы столкнулись с “пожеланием“, и вам нужно убедиться, 
что вы понимаете, как эти две функции работают вместе.
<a href="#%28counter._%28exercise._ex~3atry-it-out%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>5.7<tt>&nbsp;</tt><a name="(part._data-uni._sec~3adata-uni)"></a>Вселенная данных</h4>

<p>Каждый язык содержит множество данных Эти данные представляют информацию
из внешнего мира и о нем; это то, чем манипулируют программы. Это вселенная данных
представляет собой набор, который не только содержит
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Помните, что математики называют наборами данных или наборами классов данных 
<span style="font-style: italic">sets</span>.</span></span></span> 
все встроенные данные, но также и любую часть данных,
которую любая программа может когда либо создать.
</p>

<p>Левая часть  <a href="#%28counter._data-uni._%28figure._fig~3auniverse%29%29" data-pltdoc="x">рисунка&nbsp;<span class="FigureRef">30</span></a> показывает один из способов
представить вселенную BSL. Поскольку существует бесконечно много чисел и строк, набор всех
данных бесконечен. Мы обозначаем “бесконечность(infinity)” на рисунке,
с помощью “...”, но настоящее определение должно избежать этой неточности.</p>

<p>Ни программы, ни отдельные функции в программах не работают со всей вселенной
(совокупностью) данных. Цель определения данных - описать части этой вселенной и
дать им имена, чтобы мы могли кратко ссылаться на них. Иными словами, определение
именованных данных - это описание набора данных, и это имя можно использовать в
других определениях данных и в сигнатурах функций. В сигнатуре функции имя указывает,
с какими данными будет иметь дело функция, и неявно, с какой частью совокупности данных,
она, дела иметь не будет.</p>

<blockquote class="Figure"><a name="(counter._data-uni._(figure._fig~3auniverse))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_74.png" alt="image" width="206.0" height="296.0"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_75.png" alt="image" width="206.0" height="296.0"></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;30: </span>Вселенная данных</span></p>

</blockquote>

<p></p>

<div class="SIntrapara">На практике определения данных в первых четырех главах
ограничены встроенными коллециями данных. Они делают это посредством явной или
неявной детализации всех включаемых значений. Например, область, заштрихованная
серым цветом с права на <a href="#%28counter._data-uni._%28figure._fig~3auniverse%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">30</span></a>, отображает следующее определение
данных:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._data-uni._b)"></a><span style="font-style: italic">BS</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"hello"</span><span class="RktCmt">,</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"world"</span><span class="RktCmt">, or</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._pi%29%29" class="RktValLink" data-pltdoc="x">pi</a></span><span class="RktCmt">.</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Хотя это конкретное определение данных выглядит глупо, обратите внимание на стилизованное
сочетание английского и  BSL, которое используется. Его значение является точным и
недвусмысленным, точно разъясняя, какие элементы принадлежат
 <a href="#%28tech._data-uni._b%29" class="techoutside" data-pltdoc="x"><span class="techinside">BS</span></a>, а какие нет.</div>

<p></p>

<p>Определение структурных типов полностью изменило картину. Когда программист
определяет структурный тип, вселенная расширяется со всеми возможными экземплярами
структуры. Например, добавление <span class="RktSym">posn</span>
означает, что появляются экземпляры <span class="RktSym">posn</span> со всемми
возможными значениями в двух полях.  Средний кружок на <a href="#%28counter._data-uni._%28figure._fig~3auni-struct%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">31</span></a> изображает соединения этих значений, включая такие, кажущиеся бессмысленными,
как <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktVal">"hello"</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">)</span> и <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktVal">0</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span>.
И да, некоторые из этих экземпляров <span class="RktSym">posn</span> не имеют для нас
никакого смысла. Но программа BSL может построить любой из них.</p>

<blockquote class="Figure"><a name="(counter._data-uni._(figure._fig~3auni-struct))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_76.png" alt="image" width="726.0" height="316.0"></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;31: </span>Добавление структуры во вселенную</span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Добавление еще одного определения структурного типа
смешивает и снова соответствует всему. Скажем, мы добавлеям определение для
 <span class="RktSym">ball</span>, также с двумя полями. Как показано в третьем
пузыре на <a href="#%28counter._data-uni._%28figure._fig~3auni-struct%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">31</span></a>, это добавление создает
экземпляры <span class="RktSym">ball</span> которые содержат числа, 
структуры <span class="RktSym">posn</span>, и т.д., которые содержат экземпляры
шара(<span class="RktSym">ball</span>). Попробуйте в  DrRacket! Добавить
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ball</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">location</span><span class="hspace">&nbsp;</span><span class="RktSym">velocity</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">в облать определений, нажмите 
<span class="emph">RUN</span>, и создайте несколько экземпляров структуры.
</div>

<p></p>

<p></p>

<div class="SIntrapara">Что касается прагматики определения данных, определение данных
для структурных типов описывает большие коллекции данных через комбинации существующих
определений данных с экземплярами. Когда мы пишем
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-style: italic">Posn</span><span class="RktCmt"> is </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">мы описываем бесконечное количество возможных
экземпляров <span class="RktSym">posn</span>. Как и выше, в определениях данных используются
комбинации естественного языка, наборов данных, определенных в другом месте, и конструкторов
данных. На данный момент в определении данных больше ничего не должно отображатся.</div>

<p></p>

<p></p>

<div class="SIntrapara">Определение данных для структур определяет новую коллекцию данных,
состоящую из этих экземпляров, которые будут использоваться нашими функциями.
Например, определение данных для <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>s идентифицирует область, заштрихованную
серым цветом в центральном пузыре вселенной на <a href="#%28counter._data-uni._%28figure._fig~3auni-struct%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">31</span></a>,  который включает все те структуры <span class="RktSym">posn</span>,
два поля которых содержат числа. В то же время вполне возможно создать экземпляр 
<span class="RktSym">posn</span>, который не удовлетворяет требованию, чтобы оба поля
содержали числа:
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"hello"</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Эта структура содержит 
<span class="RktSym">posn</span> в поле <span class="RktSym">x</span> и строку
в поле <span class="RktSym">y</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._data-uni._(exercise._struct7))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;76. Сформулируйте определения данных для следующих
определений структурных типов:
</div><div class="SIntrapara"><ul><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">movie</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">title</span><span class="stt"> </span><span class="RktSym">producer</span><span class="stt"> </span><span class="RktSym">year</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">person</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">name</span><span class="stt"> </span><span class="RktSym">hair</span><span class="stt"> </span><span class="RktSym">eyes</span><span class="stt"> </span><span class="RktSym">phone</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">pet</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">name</span><span class="stt"> </span><span class="RktSym">number</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">CD</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">artist</span><span class="stt"> </span><span class="RktSym">title</span><span class="stt"> </span><span class="RktSym">price</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">sweater</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">material</span><span class="stt"> </span><span class="RktSym">size</span><span class="stt"> </span><span class="RktSym">producer</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li></ul></div><div class="SIntrapara">Делайте разумные предположения относительно того,
какие значения входят в каждое поле. 
<a href="#%28counter._data-uni._%28exercise._struct7%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._data-uni._(exercise._ex~3atime-structure))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;77. Обеспечьте определение структурного типа и определение
данных для предоставления моментов времени с полуночи. Момент времени состоит из трех чисел:
часов(hours), минут(minutes) и секунд(seconds). 
<a href="#%28counter._data-uni._%28exercise._ex~3atime-structure%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._data-uni._(exercise._struct9))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;78. Предоставьте структурный тип и определение данных
для представления трех буквенных слов. Слово состоит из строчных букв,
представляемых с помощью <a href="#%28tech._1string%29" class="techoutside" data-pltdoc="x"><span class="techinside">1String</span></a>, от <span class="RktVal">"a"</span>
до <span class="RktVal">"z"</span> плюс <span class="RktVal">#false</span>. <span style="font-weight: bold">Примечание</span> Это упражнение является частью разработки игры палач(hangman);
см. <a href="part_four.html#%28counter._%28exercise._ex~3ahangman-list%29%29" data-pltdoc="x">упражнение&nbsp;396</a>. <a href="#%28counter._data-uni._%28exercise._struct9%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>Программисты не только пишут определения данных, они также читают их, чтобы
понимать программы, расширять типы данных, с которыми они могут иметь дело, устранять
ошибки и т.д. Мы читаем определение данных, чтобы понять, как создавать данные, принадлежащие
указанной коллекции, и определить, принадлежит ли часть данных какому-либо указанному классу.
</p>

<p></p>

<div class="SIntrapara">Поскольку <a name="(idx._data-uni._(gentag._141._data-uni))"></a>
определения данных играют центральную и важную роль  в процессе проектирования, часто лушче
иллюстрировать определения данных  
<a name="(idx._data-uni._(gentag._142._data-uni))"></a>примерами, как мы
иллюстрируем поведение функций <a name="(idx._data-uni._(gentag._143._data-uni))"></a>
примерами. И действительно, создать примеры данных из определения данных просто:
</div><div class="SIntrapara"><ul><li>

<p>для встроенного набора данных (число, строка, логические значени, изображения),
выберите свои любимые примеры;</p>

<p><span style="font-weight: bold">Примечание</span> Иногда люди используют описательные
имена для обозначения встроенных коллекций данных, таких как <span class="stt">NegativeNumber</span> или <span class="stt">OneLetterString</span>. Они не заменяют хорошо написанное
определение данынх. <span style="font-weight: bold">Конец</span></p>

</li><li>

<p>для перечисления используйте несколько элементов перечисления;</p>

</li><li>

<p>для интервалов используйте конечные точки (если они есть) и хотя бы одну 
внутреннюю точку; </p>

</li><li>

<p>для детализации рассмотрите каждую часть отдельно; а также </p>

</li><li>

<p>для определения данных для структур следуйте описанию на естественном языке; 
то есть используйте конструктор и выберите пример из коллекции данных, названной 
для каждого поля. </p>

</li></ul></div><div class="SIntrapara">Это все, что нужно для построения примеров 
из определений данных для большей части этой книги, хотя определения данных станут 
намного сложнее, чем то, что вы видели до сих пор. </div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._data-uni._(exercise._struct10))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;79. Создайте примеры для следующих определений данных: 
</div><div class="SIntrapara"><ul><li><blockquote class="SCodeFlow"><table class="RktBlk" style="display: inline-table; vertical-align: text-top; margin-top: 0;" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._data-uni._color)"></a><span style="font-style: italic">Color</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"white"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"yellow"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"orange"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"green"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"red"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"blue"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">"black"</span></td></tr></tbody></table></blockquote>

<p><span style="font-weight: bold">Применчание</span> DrRacket распознает гораздо больше 
строк в качестве цвета. <span style="font-weight: bold">Конец</span></p>

</li><li><blockquote class="SCodeFlow"><table class="RktBlk" style="display: inline-table; vertical-align: text-top; margin-top: 0;" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a name="(tech._data-uni._h)"></a><span style="font-style: italic">H</span><span class="RktCmt"> is a </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> between </span><span class="RktVal">0</span><span class="RktCmt"> and </span><span class="RktVal">100</span><span class="RktCmt">.</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> represents a happiness value</span></td></tr></tbody></table></blockquote></li><li>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" style="display: inline-table; vertical-align: text-top; margin-top: 0;" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">person</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">fstname</span><span class="hspace">&nbsp;</span><span class="RktSym">lstname</span><span class="hspace">&nbsp;</span><span class="RktSym">male?</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._data-uni._person)"></a><span style="font-style: italic">Person</span><span class="RktCmt"> is a structure:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-person</span><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="stt"> </span><a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Является ли хорошей идеей использовать имя поля, похожее на имя предиката? 
</div>

<p></p>

</li><li><blockquote class="SCodeFlow"><table class="RktBlk" style="display: inline-table; vertical-align: text-top; margin-top: 0;" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">dog</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">owner</span><span class="hspace">&nbsp;</span><span class="RktSym">name</span><span class="hspace">&nbsp;</span><span class="RktSym">age</span><span class="hspace">&nbsp;</span><span class="RktSym">happiness</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._data-uni._dog)"></a><span style="font-style: italic">Dog</span><span class="RktCmt"> is a structure:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-dog</span><span class="stt"> </span><a href="#%28tech._data-uni._person%29" class="techoutside" data-pltdoc="x"><span class="techinside">Person</span></a><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="stt"> </span><a href="#%28tech._positiveinteger%29" class="techoutside" data-pltdoc="x"><span class="techinside">PositiveInteger</span></a><span class="stt"> </span><a href="#%28tech._data-uni._h%29" class="techoutside" data-pltdoc="x"><span class="techinside">H</span></a><span class="RktPn">)</span></td></tr></tbody></table></blockquote>

<p>Добавьте также интерпретацию к этому определению данных.</p>

</li><li><blockquote class="SCodeFlow"><table class="RktBlk" style="display: inline-table; vertical-align: text-top; margin-top: 0;" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._data-uni._weapon)"></a><span style="font-style: italic">Weapon</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><span class="RktVal">#false</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">— </span><span class="RktCmt"> </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktVal">#false</span><span class="RktCmt"> means the missile hasn</span><span class="RktCmt">'</span><span class="RktCmt">t </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">been fired yet; a </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> means it is in flight</span></td></tr></tbody></table></blockquote></li></ul></div><div class="SIntrapara">
Последнее определение - необычная детализация, сочетающая встроенные данные со
структурным типом. В следующей главе такие определения рассматриваются подробно. 
 <a href="#%28counter._data-uni._%28exercise._struct10%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<h4>5.8<tt>&nbsp;</tt><a name="(part._sec~3adesignstructs)"></a>Проектирование с помощью структур</h4>

<p>Введение структурных типов усиливает необходимость всех шести шагов в 
<a name="(idx._(gentag._144))"></a>рецепте проектирования. Более не достаточно 
полагаться на встроенные коллекции данных для представления информации; 
Теперь ясно, что программисты должны создавать определения данных для всего, 
кроме простейших проблем. </p>

<p></p>

<div class="SIntrapara">В этом разделе добавлен рецепт разработки(проектировани), 
проиллюстрируюем его следующим образом: 
</div><div class="SIntrapara"><blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> 
Разработайте функцию, которая вычисляет расстояние от объектов в трехмерном пространстве 
до начала координат. </p>

</blockquote></div><div class="SIntrapara">Вот так:</div>

<p></p>

<p></p>

<div class="SIntrapara"><ol><li>

<p>Когда проблема требует представления частей информации, которые принадлежат 
друг другу или описывают естественное целое, вам необходимо определение 
структурного типа. Для этого требуется столько полей, сколько имеется соответствующих свойств.
Экземпляр этого структурного типа соответствует целому, а значения в полях 
соответствуют его атрибутам. </p>

<p>Определение данных для структурного типа вводит имя для коллекции легитимных экземпляров. 
Кроме того, оно должно описывать, какие данные относятся к какому полю. 
<span style="font-weight: bold">Используйте только имена встроенных коллекций данных или 
ранее определенных определений данных. </span></p>

<p>В конце концов, мы (и другие) должны иметь возможность использовать 
определение данных для создания образцов структуры. В противном случае 
что-то не так с нашим определением данных. Чтобы гарантировать, что мы можем 
создавать экземпляры, наши определения данных должны сопровождаться 
<a name="(idx._(gentag._145))"></a><span style="font-weight: bold">примерами данных</span>.</p>

<p></p>

<div class="SIntrapara">Вот как мы применим эту идею к проблеме примера: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">r3</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">z</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._r3)"></a><span style="font-style: italic">R3</span><span class="RktCmt"> is a structure:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-r3</span><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ex1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-r3</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">13</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ex2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-r3</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Определение структурного типа
вводит новый вид структуры, <span class="RktSym">r3</span>, а определение данных вводит 
<a href="#%28tech._r3%29" class="techoutside" data-pltdoc="x"><span class="techinside">R3</span></a> как имя для всех экземпляров <span class="RktSym">r3</span>, которые содержат только числа. 
</div>

<p></p>

</li><li>

<p>Вам по-прежнему нужна сигнатура, предназначение(формулировка цели) и заголовок функции, 
но они остаются прежними. Стоп! Сделайте это для примера задачи(проблемы). </p>

</li><li>

<p>Используйте примеры из первого шага для создания функциональных примеров. 
Для каждого поля, связанного с интервалами или перечислениями, обязательно выберите 
конечные и промежуточные точки, чтобы создать функциональные примеры. 
Мы ожидаем, что вы продолжите работу над примером задачи. </p>

</li><li>

<p>Функция, которая использует структуры, обычно - хотя и не всегда - извлекает 
значения из различных полей в структуре. Чтобы напомнить себе о такой возможности, 
добавьте селектор для каждого поля в . 
 <a name="(idx._(gentag._146))"></a>шаблоны для таких функций.</p>

<p></p>

<div class="SIntrapara">Вот что у нас есть для примера задачи: 
<a name="(idx._(gentag._147))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._r3%29" class="techoutside" data-pltdoc="x"><span class="techinside">R3</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">determines the distance of </span><span class="RktSym">p</span><span class="RktCmt"> to the origin </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r3-distance-to-0</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r3-x</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r3-y</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r3-z</span><span class="hspace">&nbsp;</span><span class="RktSym">p</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Вы можете записать рядом с каждым выражением селектора, какие данные оно извлекает 
из данной структуры; вы можете найти эту информацию в определении данных. 
Стоп! Просто сделай это! </div>

<p></p>

</li><li>

<p>При определении функции используйте выражения селектора из шаблона. 
Имейте в виду, что некоторые из них могут вам не понадобиться. </p>

</li><li>

<p>Проверка(тест). Протестируйте, как только будет написан заголовок функции. 
Проверяйте, пока не будут охвачены все выражения. Проверьте еще раз, когда будете 
вносить изменения. </p>

</li></ol></div><div class="SIntrapara">
Завершите пример задачи. Если вы не можете вспомнить расстояние от трехмерной точки 
до начала координат, поищите его в книге по геометрии. 
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Там вы найдете такую формулу, как 
<img src="part_one_files/pict_77.png" alt="image" width="79" height="15">.</span></span></span></div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._struct11))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;80. Создавайте шаблоны для функций, которые используют 
экземпляры следующих типов структур: 
</div><div class="SIntrapara"><ul><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">movie</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">title</span><span class="stt"> </span><span class="RktSym">director</span><span class="stt"> </span><span class="RktSym">year</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">pet</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">name</span><span class="stt"> </span><span class="RktSym">number</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">CD</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">artist</span><span class="stt"> </span><span class="RktSym">title</span><span class="stt"> </span><span class="RktSym">price</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li><li>

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="stt"> </span><span class="RktSym">sweater</span><span class="stt"> </span><span class="RktPn">[</span><span class="RktSym">material</span><span class="stt"> </span><span class="RktSym">size</span><span class="stt"> </span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._color%29%29" class="RktValLink" data-pltdoc="x">color</a></span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</li></ul></div><div class="SIntrapara">Нет, вам не нужны определения данных для этой задачи.  <a href="#%28counter._%28exercise._struct11%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._(exercise._struct11a))"></a><span style="font-weight: bold">Упражнение
</span>&nbsp;81. Разработайте функцию  <span class="RktSym">time-&gt;seconds</span>, 
которая использует экземпляры временных структур (см. <a href="#%28counter._data-uni._%28exercise._ex~3atime-structure%29%29" data-pltdoc="x">exercise&nbsp;77</a>77) и 
выдает количество секунд, прошедших с полуночи. Например, если вы представляете 12 часов 30 минут и 2 секунды с помощью одной из этих структур и затем применяете 
<span class="RktSym">time-&gt;seconds</span> к этому экземпляру, правильным результатом будет 45002.  <span class="RktVal">45002</span>. <a href="#%28counter._%28exercise._struct11a%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._struct11b))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;82. Разработайте функцию <span class="RktSym">compare-word</span>. 
Функция использует два трехбуквенных слова (см. <a href="#%28counter._data-uni._%28exercise._struct9%29%29" data-pltdoc="x">упражнение&nbsp;78</a>). 
Она производит(возвращает) слово, которое указывает, где данные согласны и не согласны. 
Функция сохраняет содержимое полей структуры, если они согласны; в противном случае она помещает
<span class="RktVal">#false</span> в поле полученного слова. 
<span style="font-weight: bold">Совет</span> В упражнениях упоминаются две задачи: 
сравнение слов и сравнение “букв”.
<a href="#%28counter._%28exercise._struct11b%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>5.9<tt>&nbsp;</tt><a name="(part._sec~3aworld-structs)"></a>Структуры в Мире</h4>

<p>Когда программный мир должен отслеживать два независимых элемента информации, 
мы должны использовать набор структур для представления данных о состоянии мира. 
Одно поле отслеживает одну часть информации, а другое поле - вторую часть информации. 
Естественно, если мир предметной области содержит более двух независимых частей информации,
определение типа структуры должно указывать столько полей, сколько существует отдельных 
частей информации. </p>

<p></p>

<div class="SIntrapara">Рассмотрим игру про космических захватчиков, состоящую 
из НЛО и танка. НЛО спускается по прямой вертикальной линии, а танк движется 
горизонтально внизу сцены. Если оба объекта движутся с известной постоянной скоростью, 
все, что нужно для описания этих двух объектов, - это одна часть информации 
для каждого объекта: координата y для НЛО и координата x для танка. 
Для их объединения требуется структура с двумя полями: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">space-game</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">tank</span><span class="RktPn">]</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Мы предоставляем вам сформулировать адекватное
определение данных для этого определения структурного типа, включая интерпретацию. 
Вдумайтесь в дефис в названии конструкции. BSL действительно позволяет использовать 
всевозможные символы в именах переменных, функций, структур и имен полей. 
Каковы имена селекторов для этой структуры? Имя предиката? </div>

<p></p>

<p>Каждый раз, когда мы говорим “часть информации“, мы не обязательно имеем в виду 
одно число или одно слово. Часть информации может сама по себе объединять несколько 
частей информации. Создание представления данных для такого рода информации естественным 
образом приводит к вложенным структурам.</p>

<p></p>

<div class="SIntrapara">Давайте добавим немного остроты в нашу воображаемую игру с 
космическими захватчиками. НЛО, спускающееся только по вертикали, скучно. 
Чтобы превратить эту идею в интересную игру, в которой танк атакует НЛО каким-либо оружием, 
НЛО должен иметь возможность спускаться нетривиальными линиями, возможно, прыгая 
случайным образом. Реализация этой идеи означает, что нам нужны две координаты для 
описания местоположения НЛО, так что наше пересмотренное определение данных для космической 
игры выглядит следующим образом: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._spacegame)"></a><span style="font-style: italic">SpaceGame</span><span class="RktCmt"> is a structure:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-space-game</span><span class="stt"> </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktPn">)</span><span class="RktCmt">. </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-space-game</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktSym">ux</span><span class="stt"> </span><span class="RktSym">uy</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">tx</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">describes a configuration where the UFO is </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">at (</span><span class="RktSym">ux</span><span class="RktCmt">,</span><span class="RktSym">uy</span><span class="RktCmt">) and the tank</span><span class="RktCmt">'</span><span class="RktCmt">s x-coordinate is </span><span class="RktSym">tx</span><span class="RktMeta"></span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>Понимание того, какие <a name="(idx._(gentag._149))"></a>представления данных 
необходимы для программных миров, требует практики. В следующих двух разделах представлены
несколько достаточно сложных постановок задач. Решите их, прежде чем переходить к играм, 
которые вы, возможно, захотите разработать самостоятельно. </p>

<h4>5.10<tt>&nbsp;</tt><a name="(part._sec~3aedit1)"></a>Графический редактор</h4>

<p>Чтобы программировать на BSL, вы открываете DrRacket, набираете текст 
на клавиатуре и смотрите, как появляется текст. Нажатие стрелки влево на 
клавиатуре перемещает курсор влево; нажатие клавиши Backspace (или удаления) 
стирает одну букву слева от курсора - если есть буква, с которой нужно начать. </p>

<p>Этот процесс называется “редактированием“, хотя его точное название должно быть 
“редактирование текста в программах“, потому что мы будем использовать “редактирование“ 
для более сложной задачи, чем набор текста на клавиатуре. Когда вы пишете и редактируете 
другие виды документов, например, задание на английском языке, вы, вероятно, будете 
использовать другие программные приложения, называемые текстовыми процессорами, хотя 
компьютерные ученые называют их все редакторами или даже графическими редакторами. </p>

<p>Теперь вы можете разработать универсальную программу, которая действует как 
однострочный редактор для простого текста. Редактирование здесь включает в себя 
ввод букв и какое-либо изменение уже существующего текста, включая удаление и вставку букв. 
Это подразумевает некоторое представление о позиции в тексте. Люди называют эту позицию 
<span style="font-style: italic">курсором</span>; большинство графических редакторов 
отображают его таким образом, чтобы его можно было легко обнаружить. </p>

<p>Взгляните на следующую конфигурацию редактора: </p>

<blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_78.png" alt="image" width="206.0" height="26.0"></p>

</blockquote>

<p>Кто-то мог ввести текст “helloworld” и пять раз нажать клавишу со стрелкой влево, 
в результате чего курсор переместился из конца текста в положение между “o” и “w”. 
Нажатие клавиши пробела теперь приведет к тому, что редактор изменит свое отображение 
следующим образом: </p>

<p></p>

<div class="SIntrapara"><blockquote class="SCentered">

<p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_79.png" alt="image" width="206.0" height="26.0"></p>

</blockquote></div><div class="SIntrapara">Короче говоря, действие вставляет “ ” и 
помещает курсор между ним и  “w.”</div>

<p></p>

<p></p>

<div class="SIntrapara">Учитывая это, редактор должен отслеживать две части информации: 
</div><div class="SIntrapara"><ol><li>

<p>введенный текст и </p>

</li><li>

<p>текущее положение курсора. </p>

</li></ol></div><div class="SIntrapara">И это предполагает структурный тип с двумя полями.</div>

<p></p>

<p></p>

<div class="SIntrapara">Мы можем представить несколько различных способов перехода 
от информации к данным и обратно. Например, одно поле в структуре может содержать 
весь введенный текст, а другое - количество символов между первым символом (считая слева) 
и курсором. Другое представление данных - использовать две строки в двух полях: 
часть текста слева от курсора и часть текста справа от него. Вот наш предпочтительный 
подход к представлению состояния редактора: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">editor</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">pre</span><span class="hspace">&nbsp;</span><span class="RktSym">post</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">An </span><a name="(tech._editor)"></a><span style="font-style: italic">Editor</span><span class="RktCmt"> is a structure:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-editor</span><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="stt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-editor</span><span class="stt"> </span><span class="RktSym">s</span><span class="stt"> </span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktCmt"> describes an editor</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">whose visible text is </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string-append%29%29" class="RktValLink" data-pltdoc="x">string-append</a></span><span class="stt"> </span><span class="RktSym">s</span><span class="stt"> </span><span class="RktSym">t</span><span class="RktPn">)</span><span class="RktCmt"> with </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the cursor displayed between </span><span class="RktSym">s</span><span class="RktCmt"> and </span><span class="RktSym">t</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Решите следующие несколько упражнений на основе этого представления данных. </div>

<p></p>

<p><a name="(counter._(exercise._struct-edit0))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;83. Разработайте функцию <span class="RktSym">render</span>, которая использует
 <a href="#%28tech._editor%29" class="techoutside" data-pltdoc="x"><span class="techinside">Editor</span></a>(редактор) и создает изображение. </p>

<p>Цель функции - визуализировать текст на пустой сцене пикселей
<img src="part_one_files/pict_80.png" alt="image" width="46" height="9">. 
В качестве курсора используйте <img src="part_one_files/pict_81.png" alt="image" width="33" height="9"> красный прямоугольник изображения, а для строк - черный текст размером 16. </p>

<p></p>

<div class="SIntrapara">Разработайте изображение для образца строки в области взаимодействия
DrRacket. Мы начали с этого выражения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%2Falign%29%29" class="RktValLink" data-pltdoc="x">overlay/align</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"left"</span><span class="hspace">&nbsp;</span><span class="RktVal">"center"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._text%29%29" class="RktValLink" data-pltdoc="x">text</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"hello world"</span><span class="hspace">&nbsp;</span><span class="RktVal">11</span><span class="hspace">&nbsp;</span><span class="RktVal">"black"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktVal">200</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Вы можете прочитать о  <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%29%29" class="RktValLink" data-pltdoc="x">beside</a></span>, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._above%29%29" class="RktValLink" data-pltdoc="x">above</a></span> и подобных функциях. 
Если вам нравится внешний вид изображения, используйте выражение в качестве теста и 
в качестве руководства по разработке <span class="RktSym">render</span>. <a href="#%28counter._%28exercise._struct-edit0%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._(exercise._struct-edit1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;84. Разработайте <span class="RktSym">edit</span>. Функция использует два входа, редактор <span class="RktSym">ed</span> и <a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a> <span class="RktSym">ke</span>, 
и создает еще один редактор. Его задача - добавить односимвольное событие 
<a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a> <span class="RktSym">ke</span> в конец поля 
<span style="font-style: italic">pre</span> в <span class="RktSym">ed</span>, 
если <span class="RktSym">ke</span> не обозначает клавишу возврата 
(<span class="RktVal">"\b"</span>). В этом случае он удаляет символ сразу слева от 
курсора (если он есть). Функция игнорирует клавишу табуляции 
(<span class="RktVal">"\t"</span>) и клавишу возврата (<span class="RktVal">"\r"</span>). 
</p>

<p>Функция обращает внимание только на два <a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a> длиннее одной буквы: 
<span class="RktVal">"left"</span> и <span class="RktVal">"right"</span>. 
Стрелка влево перемещает курсор на один символ(знак) влево (если есть), 
а стрелка вправо перемещает его на один знак вправо (если есть). Все другие такие 
<a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a> игнорируются. </p>

<p>Разработайте большое количество примеров для <span class="RktSym">edit</span>, 
обращая внимание на особые случаи. Решив это упражнение, мы создали 20 примеров и 
превратили их все в тесты. </p>

<p><span style="font-weight: bold">Подсказка</span> Думайте об этой функции как о 
потреблении <a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a>, коллекции, указанной как перечисление. 
Она использует вспомогательные функции для работы со структурой <a href="#%28tech._editor%29" class="techoutside" data-pltdoc="x"><span class="techinside">Editor</span></a>. 
Держите список пожеланий под рукой; вам нужно будет разработать дополнительные функции 
для большинства этих вспомогательных функций, таких как <span class="RktSym">string-first</span>, <span class="RktSym">string-rest</span>, <span class="RktSym">string-last</span>, и
 <span class="RktSym">string-remove-last</span>. Если вы еще не сделали этого, выполните
упражнения из раздела <a href="#%28part._sec~3afuncs%29" data-pltdoc="x">Функции</a>. 
</a>.   <a href="#%28counter._%28exercise._struct-edit1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._struct-edit2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;85. Определите функцию <span class="RktSym">run</span>. Передавая поле 
<span class="RktSym">pre</span> редактору, она запускает интерактивный редактор, 
используя <span class="RktSym">render</span> и <span class="RktSym">edit</span> из двух 
предыдущих упражнений для предложений 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span> и <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span> соответственно.  
<a href="#%28counter._%28exercise._struct-edit2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._struct-edit3))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;86. Обратите внимание, что если вы печатаете много, ваша программа-редактор 
не отображает весь текст. Вместо этого текст обрезается по правому краю. 
Измените функцию <span class="RktSym">edit</span> из 
<a href="#%28counter._%28exercise._struct-edit1%29%29" data-pltdoc="x">упражнения&nbsp;84</a> 
так, чтобы она игнорировало нажатие клавиши, если добавление его в конец поля 
<span class="RktSym">pre</span> будет означать, что отображаемый текст слишком широк 
для вашего холста.  
<a href="#%28counter._%28exercise._struct-edit3%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._struct-edit4))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;87. Разработайте представление данных для редактора на основе нашей первой идеи,
используя строку и индекс. Затем снова выполните предыдущие упражнения. 
<span style="font-weight: bold">Проследите рецепт проектирования.</span> 
<span style="font-weight: bold">Подсказка</span>  Если вы еще не сделали этого, 
выполните упражнения из раздела
<a href="#%28part._sec~3afuncs%29" data-pltdoc="x">Функции</a>.</p>

<p><span style="font-weight: bold">Замечание о выборе проектирования</span>. 
Упражнение - это первое изучение выбора проектирования. Оно показывает, 
что самый первый выбор проектирования касается представления данных. 
Чтобы сделать правильный выбор, необходимо заранее спланировать и взвесить каждый из них. 
Конечно, чтобы добиться успеха в этом вопросе, нужно набраться опыта.  
<a href="#%28counter._%28exercise._struct-edit4%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>5.11<tt>&nbsp;</tt><a name="(part._sec~3azoo2)"></a>Больше виртуальных питомцев</h4>

<p>В этом разделе мы продолжаем наш проект виртуального зоопарка из
<a href="#%28part._sec~3azoo1%29" data-pltdoc="x">Миры Виртуальных Питомцев</a>. 
В частности, цель упражнения - объединить программу мира кошки с программой  для
управления индикатором счастья. Когда запускается комбинированная программа, 
вы видите, как кошка идет по холсту(канве), и с каждым шагом ее счастье падает. 
Единственный способ сделать кошку счастливой - это покормить или погладить (стрелка вверх).
Наконец, цель последнего упражнения в этом разделе - создать еще одного виртуального 
счастливого питомца.
</p>

<p><a name="(counter._(exercise._struct12))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;88. Определите структурный тип, который отслеживает координату x кошки 
и ее счастье. Затем сформулируйте определение данных для кошек, получившее название 
<a name="(tech._vcat)"></a><span style="font-style: italic">VCat</span>, включая интерпретацию.
<a href="#%28counter._%28exercise._struct12%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._struct13))"></a><span style="font-weight: bold">Упражениние</span>&nbsp;89. Разработайте программный мир <span class="RktSym">happy-cat</span>
(счастливая кошка), которая управляет ходячей кошкой и ее уровнем счастья. 
Предполагая, что вначале кошка полностью счастлива. </p>

<p><span style="font-weight: bold">Подсказки</span> (1) Повторно используйте функции 
из программных миров из <a href="#%28part._sec~3azoo1%29" data-pltdoc="x">Миры Виртуальных
Питомцев</a>. (2) Используйте структурный тип из предыдущего упражнения для 
представления состояния мира. 
 <a href="#%28counter._%28exercise._struct13%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._struct14))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;90. Измените программу <span class="RktSym">happy-cat</span> из предыдущих 
упражнений так, чтобы она останавливалась всякий раз, когда счастье кошки падает до 
<span class="RktVal">0</span>. 
<a href="#%28counter._%28exercise._struct14%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._struct15))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;91. Расширьте определение структурного типа и определение данных 
из <a href="#%28counter._%28exercise._struct12%29%29" data-pltdoc="x">упражнения&nbsp;88</a>,
включив в него поле направления(direction). Измените свою программу 
<span class="RktSym">happy-cat</span> так, чтобы кошка двигалась в указанном направлении.
Программа должна переместить кошку в текущем направлении и развернуть кошку, 
когда она достигнет любого конца сцены. 
<a href="#%28counter._%28exercise._struct15%29%29" class="ex-end" data-pltdoc="x"></a></p>

<blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cham</span><span class="hspace">&nbsp;</span><img src="part_one_files/chameleon.png" alt="" width="63" height="150"><span class="RktPn">)</span></p>

</blockquote>

<p>Приведенный выше рисунок хамелеона - это 
<span style="font-weight: bold">прозрачное(transparent)</span> изображение. 
Чтобы вставить его в DrRacket, вставьте его с помощью пункта меню “Insert Image”
(Вставить изображение). 
Использование этой инструкции сохраняет прозрачность пикселей рисунка. </p>

<p>Когда частично прозрачное изображение комбинируется с цветной формой, 
например прямоугольником, изображение принимает основной цвет. На рисунке хамелеона 
внутренняя часть животного прозрачна; область снаружи сплошная белая. 
Попробуйте это выражение в своем DrRacket: </p>

<blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">background</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._rectangle%29%29" class="RktValLink" data-pltdoc="x">rectangle</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-width%29%29" class="RktValLink" data-pltdoc="x">image-width</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cham</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._image-height%29%29" class="RktValLink" data-pltdoc="x">image-height</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cham</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"solid"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._overlay%29%29" class="RktValLink" data-pltdoc="x">overlay</a></span><span class="hspace">&nbsp;</span><span class="RktSym">cham</span><span class="hspace">&nbsp;</span><span class="RktSym">background</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote>

<p><a name="(counter._(exercise._struct16))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;92.  Разработайте программу <span class="RktSym">cham</span>, 
в которой хамелеон постоянно ходит по холсту слева направо. Когда он достигает 
правого края холста, он исчезает и сразу же появляется слева. 
Подобно кошке, хамелеон голоден от любой прогулки, и со временем этот голод 
выражается в несчастье.</p>

<p>Для управления шкалой счастья хамелеона вы можете повторно использовать шкалу счастья 
от виртуального кота. Чтобы порадовать хамелеона, вы его кормите (стрелка вниз, 
всего две точки); ласки не разрешены. Конечно, как и все хамелеоны, наш тоже может 
менять цвет: <span class="RktVal">"r"</span> делает его красным, 
<span class="RktVal">"b"</span> - синим, а <span class="RktVal">"g"</span> - зеленым. 
Добавьте программный мир хамелеона в игру с виртуальным котом и по 
возможности повторно используйте функции последней. 
</p>

<p>Начнем с определения данных 
<a name="(tech._vcham)"></a><span style="font-style: italic">VCham</span> 
для представления хамелеонов. 
 <a href="#%28counter._%28exercise._struct16%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._struct16-copy))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;93. Скопируйте свое решение к 
<a href="#%28counter._%28exercise._struct16%29%29" data-pltdoc="x">упражнению&nbsp;92</a> 
и измените копию так, чтобы хамелеон шел по трехцветному фону. 
В нашем решении используются следующие цвета: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._beside%29%29" class="RktValLink" data-pltdoc="x">beside</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="refelem"><span class="refcolumn"><span class="refcontent">Have some Italian pizza when you’re done.</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">"white"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-scene%29%29" class="RktValLink" data-pltdoc="x">empty-scene</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">но вы можете использовать любые цвета. 
Посмотрите, как хамелеон меняет цвета, чтобы смешаться, когда он пересекает 
границу между двумя цветами.</div>

<p></p>

<p><span style="font-weight: bold">Примечание.</span> Если вы внимательно посмотрите 
анимацию, вы увидите, что хамелеон едет на белом прямоугольнике. 
Если вы знаете, как использовать программное обеспечение для редактирования изображений, 
измените изображение так, чтобы белый прямоугольник был невидим. 
Тогда хамелеон действительно сольется с фоном. 
 <a href="#%28counter._%28exercise._struct16-copy%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h3>6<tt>&nbsp;</tt><a name="(part._ch~3amix)"></a>Детализации и Структуры</h3>

<p>В предыдущих двух главах представлены два способа формулирования определений данных. 
Те, которые используют детализацию (перечисление и интервалы), используются для 
создания небольших коллекций из больших. 
Те, которые используют структуры, объединяют несколько коллекций. 
Поскольку разработка представлений данных является отправной точкой для правильного 
проектирования программы, вас не может удивить тот факт, что программисты часто хотят 
детализировать определения данных, которые включают структуры, или использовать структуры для 
объединения детализированных данных. </p>

<p></p>

<div class="SIntrapara">Вспомните игру с воображаемым космическим захватчиком из 
<a href="#%28part._sec~3aworld-structs%29" data-pltdoc="x">Структуры в Мире</a> 
из предыдущей главы. Пока что в нем участвуют один НЛО, спускающийся из космоса, 
и один танк на земле, движущийся горизонтально. 
В нашем <a name="(idx._(gentag._150))"></a> представлении данных используется структура 
с двумя полями: одно для представления данных НЛО, а другое - для представления 
данных танка. Естественно, игрокам понадобится танк, способный запускать ракету. 
Внезапно мы можем представить себе состояние второго типа, которое содержит три 
независимо движущихся объекта: НЛО, танк и ракету. Таким образом, у нас есть 
две различные структуры: одна для представления двух независимо движущихся объектов, 
а другая для третьего. Поскольку мировое состояние теперь может быть одной из этих 
двух структур, естественно использовать детализацию для описания всех возможных 
состояний: 
</div><div class="SIntrapara"><ol><li>

<p>состояние мира - это структура с <span style="font-weight: bold">двумя</span> полями, или </p>

</li><li>

<p>состояние мира представляет собой структуру с <span style="font-weight: bold">тремя</span>
 полями </p>

</li></ol></div><div class="SIntrapara">Что касается нашей области
<span class="refelem"><span class="refcolumn"><span class="refcontent">Не беспокойтесь, следующая часть книги посвящена запуску любого количества ракет без перезарядки.</span></span></span>
 - реальной игры - первое состояние представляет время до того, как танк запустит 
свою единственную ракету, а второй - время после того, как ракета была запущена.

<p></p>

<p>В этой главе представлена основная идея детализации определений данных, 
содержащих структуры. Поскольку у нас есть все остальные ингредиенты, которые нам нужны, 
мы начинаем прямо с разбивки по элементам. После этого мы обсудим некоторые примеры, 
в том числе программные миры, которые извлекают пользу из нашей новой силы. 
Последний раздел посвящен ошибкам в программировании.
 </p>

<h4>6.1<tt>&nbsp;</tt><a name="(part._mix._sec~3aitemization-design2)"></a>Ещё раз, 
проектирование с использованием детализации</h4>

<p>Давайте начнем с уточненной постановки задачи для нашей игры про космических
захватчиков из <a href="#%28part._sec~3aprogstructs%29" data-pltdoc="x">Программирование со структурами</a>.</p>

<blockquote>

<p><span style="font-weight: bold">Пример Задачи</span> Разработайте игровую программу, 
используя библиотеку <span class="sroman">the <span class="Smaller"><span style="font-style: italic">2htdp/universe</span></span> </span>, для игры в простую игру 
с захватчиками космоса. Игрок управляет танком (маленький прямоугольник), 
который должен защищать нашу планету (нижняя часть холста) от НЛО (см. 
<a href="#%28part._sec~3aintervals%29" data-pltdoc="x">Интервалы</a> там есть один из
возможных вариантов), спускающегося с верхней части холста вниз. 
Чтобы остановить НЛО от приземления, игрок может запустить одиночную ракету 
(треугольник меньше танка), нажав пробел. 
В ответ ракета вылетает из танка. 
Если НЛО сталкивается с ракетой, игрок выигрывает; в противном случае НЛО приземляется, 
и игрок проигрывает. </p>

<p>Вот некоторые подробности о трех игровых объектах и их перемещениях. 
Во-первых, танк движется с постоянной скоростью по нижней части холста, 
хотя игрок может использовать клавишу со стрелкой влево и клавишу со стрелкой вправо, 
чтобы изменить направление. Во-вторых, НЛО спускается с постоянной скоростью, 
но совершает небольшие случайные прыжки влево или вправо. 
В-третьих, после запуска ракета поднимается по прямой вертикальной линии 
с постоянной скоростью, по крайней мере, в два раза быстрее, чем спускается НЛО. 
Наконец, НЛО и ракета сталкиваются, если их ориентиры достаточно близки, 
что бы вы ни считали “достаточно близкими“. </p>

</blockquote>

<p>В следующих двух подразделах этот пример задачи используется в качестве 
рабочего примера, поэтому внимательно изучите ее и решите следующее упражнение, 
прежде чем продолжить. Это поможет вам понять проблему достаточно глубоко. </p>

<p><a name="(counter._mix._(exercise._mix1))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;94. Нарисуйте несколько набросков игрового пейзажа на разных этапах. 
Используйте наброски, чтобы определить постоянные и переменные элементы игры. 
Для первых разработайте физические и графические константы, которые описывают 
измерения мира (холста) и его объектов. Также разработайте фоновый пейзаж. 
Наконец, создайте исходную сцену из констант для танка, НЛО и фона.  <a href="#%28counter._mix._%28exercise._mix1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><span style="font-weight: bold">Определение детализации</span> 
Первый шаг в нашем рецепте проектирования требует разработки определений данных. 
Одна из целей определения данных - описать построение данных, которые представляют 
состояние мира; другой - описать все возможные фрагменты данных, которые могут 
потреблять(принимать) функции обработки событий программного мира. 
Поскольку мы не встречали перечислений, включающих структуры, 
в первом подразделе представлена эта идея. 
Хотя это, вероятно, вас не удивит, обратите на это пристальное внимание. 
</p>

<p><span class="refelem"><span class="refcolumn"><span class="refcontent">Для этой игры 
с космическими захватчиками мы могли бы обойтись одним определением структурного
типа из трех полей, где третье поле содержит <span class="RktVal">#false</span> 
до запуска ракеты, а затем <span class="RktSym">Posn</span> для координат ракеты. 
См. ниже. </span></span></span></p>

<p></p>

<div class="SIntrapara">Как утверждалось во введении к этой главе, игра  
космический захватчик с ракетным танком требует 
<a name="(idx._mix._(gentag._151._mix))"></a>представления данных для двух 
различных типов игровых состояний. Выберем два определения структурного типа: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">aim</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">tank</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">fired</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">tank</span><span class="hspace">&nbsp;</span><span class="RktSym">missile</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Первое предназначен для периода времени, когда игрок пытается поставить танк на 
позицию для выстрела, а второе - для представления состояний после выстрела ракеты. 
Однако, прежде чем мы сможем сформулировать определение данных для полного состояния игры, 
нам нужны представления данных для танка, НЛО и ракеты. </div>

<p></p>

<p></p>

<div class="SIntrapara">Предполагая постоянные определения для таких физических констант, 
как <span class="RktSym">WIDTH</span> и <span class="RktSym">HEIGHT</span>, 
которые являются предметом <a href="#%28counter._mix._%28exercise._mix1%29%29" data-pltdoc="x">упражнения&nbsp;94</a>, мы формулируем определения данных следующим образом: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mix._ufo)"></a><span style="font-style: italic">UFO</span><span class="RktCmt"> is a </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt">. </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktCmt"> is the UFO</span><span class="RktCmt">'</span><span class="RktCmt">s location </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">(using the top-down, left-to-right convention)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tank</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">loc</span><span class="hspace">&nbsp;</span><span class="RktSym">vel</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mix._tank)"></a><span style="font-style: italic">Tank</span><span class="RktCmt"> is a structure:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="stt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktPn">)</span><span class="RktCmt">. </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">dx</span><span class="RktPn">)</span><span class="RktCmt"> specifies the position:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">(</span><span class="RktSym">x</span><span class="RktCmt">, </span><span class="RktSym">HEIGHT</span><span class="RktCmt">) and the tank</span><span class="RktCmt">'</span><span class="RktCmt">s speed: </span><span class="RktSym">dx</span><span class="RktCmt"> pixels/tick </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mix._missile)"></a><span style="font-style: italic">Missile</span><span class="RktCmt"> is a </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt">. </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><span class="RktSym">x</span><span class="stt"> </span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktCmt"> is the missile</span><span class="RktCmt">'</span><span class="RktCmt">s place</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Каждое из этих определений данных описывает 
не что иное, как структуру, либо вновь определенную, <span class="RktSym">tank</span>,
либо встроенную коллекцию данных <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>. 
Что касается последней, вас может немного удивить то, что <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>s используются 
для представления двух различных аспектов мира. 
С другой стороны, мы использовали числа (а также строки и логические значения) 
для представления множества различных видов информации в реальном мире, 
поэтому повторное использование набора структур, таких как  <span class="RktSym">Posn</span>, 
не представляет большого труда. </div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь мы можем сформулировать определения данных для 
состояния игры с космическими захватчиками: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mix._sig)"></a><span style="font-style: italic">SIGS</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-aim</span><span class="stt"> </span><a href="#%28tech._mix._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a><span class="stt"> </span><a href="#%28tech._mix._tank%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tank</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-fired</span><span class="stt"> </span><a href="#%28tech._mix._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a><span class="stt"> </span><a href="#%28tech._mix._tank%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tank</span></a><span class="stt"> </span><a href="#%28tech._mix._missile%29" class="techoutside" data-pltdoc="x"><span class="techinside">Missile</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> represents the complete state of a </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">space invader game</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Форма определения данных аналогична описанию.
Однако каждое предложение описывает содержимое структурного типа, точно так же, 
как определение данных для структурных типов, которые мы видели до сих пор. 
Тем не менее, это определение данных показывает, что не каждое определение данных имеет 
только одно определение структурного типа; здесь одно определение данных включает в себя 
два различных определения структурного типа. </div>

<p></p>

<p></p>

<div class="SIntrapara">Смысл такого определения данных также прост. Оно вводит 
имя <a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a> для коллекции всех тех экземпляров структуры, 
которые вы можете создать в соответствии с определением. 
Итак, давайте создадим: 
</div><div class="SIntrapara"><ul><li>

<p></p>

<div class="SIntrapara">Вот пример, описывающий маневрирование танка на позицию для запуска ракеты: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym">make-aim</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="hspace">&nbsp;</span><span class="RktVal">28</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span><span class="RktPn">)</span></p>

</blockquote></div>

<p></p>

</li><li>

<p></p>

<div class="SIntrapara">Этот такой же, как и предыдущий, но ракета выпущена:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">make-fired</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="hspace">&nbsp;</span><span class="RktVal">28</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">28</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">TANK-HEIGHT</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Конечно, имена, написанные с заглавной буквы, относятся к определенным вами физическим константам.
</div>

<p></p>

</li><li>

<p></p>

<div class="SIntrapara">Наконец, вот тот, где ракета вот-вот столкнется с НЛО: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">make-fired</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktVal">103</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В этом примере предполагается, что холст имеет высоту более 100 пикселей.</div>

<p></p>

</li></ul></div><div class="SIntrapara">Обратите внимание, что первый экземпляр 
<a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a> создается в соответствии с первым предложением определения данных, 
а второй и третий следуют за вторым предложением. Естественно, числа в каждом поле 
зависят от вашего выбора глобальных игровых констант. 
</div>

<p></p>

<p><a name="(counter._mix._(exercise._mix2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;95. 
Объясните, почему три экземпляра создаются в соответствии с первым или вторым предложением 
определения данных. 
 <a href="#%28counter._mix._%28exercise._mix2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._mix._(exercise._mix3))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;96. Набросайте, как можно отрисовать каждое из трех игровых состояний на 
холсте -  <img src="part_one_files/pict_82.png" alt="image" width="52" height="9">. <a href="#%28counter._mix._%28exercise._mix3%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><span style="font-weight: bold">Рецепт разработки</span> 
С новым способом формулирования определений данных приходит проверка рецепта разработки. 
В этой главе представлен способ объединения двух или более средств описания данных, 
и пересмотренный <a name="(idx._mix._(gentag._152._mix))"></a>рецепт разработки отражает это, 
особенно первый шаг: 
</p>

<p></p>

<div class="SIntrapara"><ol><li>

<p>Когда вам понадобится этот новый способ определения данных? 
Вы уже знаете, что необходимость в Детализации обусловлена различиями между 
разными классами информации в постановке задачи. Точно так же потребность в 
определениях данных на основе структуры возникает из-за необходимости сгруппировать 
несколько различных частей информации. </p>

<p>Детализация различных форм данных, включая коллекции структур, требуется, 
когда в вашей постановке задачи выделяются различные виды информации и 
когда по крайней мере некоторые из этих частей информации состоят из нескольких 
разных частей. </p>

<p>Следует иметь в виду, что определения данных могут относиться к другим 
определениям данных. Следовательно, если конкретный пункт в определении данных 
выглядит слишком сложным, допустимо записать отдельное определение данных 
для этого пункта и обратиться к этому вспомогательному определению. </p>

<p>И, как всегда, сформулируйте <a name="(idx._mix._(gentag._153._mix))"></a>примеры данных, 
используя <a name="(idx._mix._(gentag._154._mix))"></a>определения данных. </p>

</li><li>

<p>Второй шаг остается прежним. Сформулируйте сигнатуру функции, в которой упоминаются 
только имена определенных или встроенных коллекций данных, добавьте предназначение и 
создайте заголовок функции. </p>

</li><li>

<p>На третьем шаге ничего не меняется. Вам по-прежнему необходимо сформулировать 
функциональные примеры, иллюстрирующие предназначение из второго шага, и вам 
по-прежнему нужен один пример для каждого элемента в детализации.</p>

</li><li>

<p>При разработке <a name="(idx._mix._(gentag._155._mix))"></a>шаблона теперь используются 
два разных аспекта: сама детализация и использование структур в ее предложениях. </p>

<p>По первому, тело шаблона состоит из выражения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, которое имеет столько предложений 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, сколько элементов в детализации. 
Кроме того, вы должны добавить условие в каждое предложение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, 
которое идентифицирует подкласс данных в соответствующем элементе. </p>

<p>Во втором случае, если элемент имеет дело со структурой, шаблон содержит выражения 
селектора - в предложении <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, которое имеет дело с подклассом данных, описанных в элементе. </p>

<p>Однако, когда вы выбираете описание данных с помощью отдельного определения данных, 
вы <span style="font-weight: bold">не</span> добавляете выражения селектора. 
Вместо этого вы создаете шаблон для отдельного определения данных для текущей задачи и 
ссылаетесь на этот шаблон с помощью вызова функции. 
Последнее указывает на то, что этот подкласс данных обрабатывается отдельно. </p>

<p><span style="font-weight: bold">Прежде чем приступить к разработке шаблона</span>, 
кратко подумайте о характере функции. Если в формулировке проблемы предполагается, 
что необходимо выполнить несколько задач, вполне вероятно, что вместо шаблона потребуется 
композиция из нескольких отдельно разработанных функций. 
В этом случае пропустите шаг шаблона. </p>

</li><li>

<p>Заполните пробелы в шаблоне. Чем сложнее вы делаете определения данных, 
тем сложнее становится этот шаг. Хорошая новость в том, что этот рецепт разработки
может помочь во многих ситуациях. </p>

<p>Если вы застряли, сначала заполните простые случаи, а для остальных используйте 
значения по умолчанию. Хотя это приводит к сбою некоторых тестовых примеров, 
вы делаете успехи и можете визуализировать этот прогресс. </p>

<p>Если вы застряли на некоторых случаях детализации, проанализируйте примеры, 
соответствующие этим случаям. Определите, что части шаблона вычисляют на основе 
заданных входных данных. Затем подумайте, как объединить эти части (плюс некоторые 
константы) для вычисления желаемого результата. Имейте в виду, что вам может понадобиться
вспомогательная функция. </p>

<p>Кроме того, если ваш шаблон “вызывает“ другой шаблон из-за того, что 
определения данных ссылаются друг на друга, предположите, что другая функция 
выполняет то, что обещают ее цель и примеры, даже если определение этой другой функции 
еще не завершено. </p>

</li><li>

<p>Тест(проверка). Если тесты не проходят, определите, что не так: функция, 
тесты или и то, и другое. Вернитесь к соответствующему шагу. </p>

</li></ol></div><div class="SIntrapara">
Вернитесь назад к <a href="#%28part._sec~3adesign-func%29" data-pltdoc="x">Рарзаботке Функций</a>,
перечитайте описание простого рецепта разработки и сравните его с этой версией. </div>

<p></p>

<p>Давайте проиллюстрируем рецепт разработки с разработкой функции рендеринга 
для примера задачи в начале этого раздела. Напомним, что выражению 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> нужна такая функция рендеринга, 
чтобы преобразовывать состояние мира в изображение после каждого такта часов, 
щелчка мыши или нажатия клавиши. </p>

<p></p>

<div class="SIntrapara">Сигнатура этой функции рендеринга гласит, что она отображает элемент 
класса состояния мира в класс изображений - <a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a>:<a name="(idx._mix._(gentag._156._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktSym">TANK</span><span class="RktCmt">, </span><span class="RktSym">UFO</span><span class="RktCmt">, and possibly </span><span class="RktSym">MISSILE</span><span class="RktCmt"> to </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">the </span><span class="RktSym">BACKGROUND</span><span class="RktCmt"> scene</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-render</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Здесь <span class="RktSym">TANK</span>, <span class="RktSym">UFO</span>, 
<span class="RktSym">MISSILE</span> и <span class="RktSym">BACKGROUND</span>
- это запрошенные константы изображения из  <a href="#%28counter._mix._%28exercise._mix1%29%29" data-pltdoc="x">упражнения&nbsp;94</a>. Напомним, что эта сигнатура - всего лишь экземпляр 
общей сигнатуры для функций рендеринга, которые всегда используют коллекции состояний мира 
и создают какое-то изображение.
</div>

<p></p>

<blockquote class="Figure"><a name="(counter._mix._(figure._fig~3asigs-examples))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered"><table style="border-collapse: collapse;" cellspacing="0" cellpadding="0"><tbody><tr><td style="border-bottom: 1px solid black;">

<p>s</p>

</td><td style="border-bottom: 1px solid black;">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;">

<p><span class="RktPn">(</span><span class="RktSym">si-render</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span></p>

</td></tr><tr><td valign="bottom">

<p></p>

</td><td valign="bottom">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="bottom">

<p></p>

</td></tr><tr><td valign="bottom"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">make-aim</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="hspace">&nbsp;</span><span class="RktVal">28</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td><td valign="bottom">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="bottom">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_83.png" alt="image" width="86" height="76"></p>

</td></tr><tr><td valign="bottom"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">make-fired</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">22</span><span class="hspace">&nbsp;</span><span class="RktVal">103</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td><td valign="bottom">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="bottom">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_84.png" alt="image" width="86" height="76"></p>

</td></tr><tr><td valign="bottom"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">make-fired</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">20</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="hspace">&nbsp;</span><span class="RktVal">28</span><span class="hspace">&nbsp;</span><span class="RktVal"><span class="nobreak">-3</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">32</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktSym">TANK-HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td><td valign="bottom">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="bottom">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_85.png" alt="image" width="86" height="76"></p>

</td></tr></tbody></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;32: </span>Визуализация игровых состояний космического захватчика, на примере </span></p>

</blockquote>

<p>Поскольку детализация в определении данных состоит из двух элементов, 
давайте сделаем три примера, используя примеры данных, приведенные выше. См. 
<a href="#%28counter._mix._%28figure._fig~3asigs-examples%29%29" data-pltdoc="x">Рисунок&nbsp;<span class="FigureRef">32</span></a> 32. В отличие от таблиц функций, которые можно найти 
в книгах по математике, эта таблица отображается вертикально. Левый столбец содержит 
примеры входных данных для нашей желаемой функции; в правом столбце перечислены 
соответствующие желаемые результаты. Как видите, мы использовали примеры данных из первого шага 
рецепта разработки, и они охватывают оба элемента детализации. </p>

<p></p>

<div class="SIntrapara">Далее мы переходим к разработке шаблона, самому важному этапу 
<a name="(idx._mix._(gentag._157._mix))"></a>процесса проектирования. Во-первых, мы знаем, 
что тело <span class="RktSym">si-render</span> должно быть выражением 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> с двумя предложениями 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. Следуя рецепту разработки, двумя условиями являются 
<span class="RktPn">(</span><span class="RktSym">aim?</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span> и <span class="RktPn">(</span><span class="RktSym">fired?</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span>, и они различают два возможных типа данных, которые может потреблять
(принимать) <span class="RktSym">si-render</span>:  <a name="(idx._mix._(gentag._158._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-render</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">aim?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">fired?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Во-вторых, мы добавляем выражения селектора в каждое предложение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, 
которое имеет дело со структурами. В данном случае оба пункта касаются обработки 
структур: <span class="RktSym">aim</span> и <span class="RktSym">fired</span>. 
Первая имеет два поля и, следовательно, требует двух выражений селектора для первого 
предложения <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, а второй вид структур состоит из трех значений и, 
следовательно, требует трех выражений селектора: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-render</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">aim?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">aim-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">aim-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">fired?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-missile</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>В шаблоне есть почти все, что нам нужно для выполнения нашей задачи. 
Чтобы завершить определение, мы выясняем для каждой строки <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, 
как объединить значения, которые у нас есть, чтобы вычислить ожидаемый результат. 
Помимо частей ввода, мы также можем использовать глобально определенные константы, 
например, <span class="RktSym">BACKGROUND</span>, что здесь явно поможет; 
примитивные или встроенные операции; и, если все остальное не помогает, 
функции списка пожеланий, то есть мы описываем функции, которые мы хотели бы иметь. </p>

<p></p>

<div class="SIntrapara">Рассмотрим первое предложение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, 
где у нас есть <a name="(idx._mix._(gentag._159._mix))"></a>представление данных танка,
то есть <span class="RktPn">(</span><span class="RktSym">aim-tank</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span>, и представление данных НЛО, 
то есть <span class="RktPn">(</span><span class="RktSym">aim-ufo</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span>. Из первого примера на 
<a href="#%28counter._mix._%28figure._fig~3asigs-examples%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">32</span></a> мы знаем, что нам нужно 
добавить два объекта к фоновому пейзажу. Кроме того, рецепт проектирования предполагает, 
что если эти фрагменты данных идут с собственным определением данных, мы должны рассмотреть
возможность определения вспомогательных (вспомогательных) функций и использовать их для
вычисления результата:  <a name="(idx._mix._(gentag._160._mix))"></a> <a name="(idx._mix._(gentag._161._mix))"></a><a name="(idx._mix._(gentag._162._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tank-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">aim-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">aim-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Здесь <span class="RktSym">tank-render</span> и <span class="RktSym">ufo-render</span> - это функции списка желаний: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._tank%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tank</span></a><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktSym">t</span><span class="RktCmt"> to the given image </span><span class="RktSym">im</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tank-render</span><span class="hspace">&nbsp;</span><span class="RktSym">t</span><span class="hspace">&nbsp;</span><span class="RktSym">im</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">im</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktSym">u</span><span class="RktCmt"> to the given image </span><span class="RktSym">im</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-render</span><span class="hspace">&nbsp;</span><span class="RktSym">u</span><span class="hspace">&nbsp;</span><span class="RktSym">im</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">im</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<blockquote class="Figure"><a name="(counter._mix._(figure._fig~3asi-render))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">renders the given game state on top of </span><span class="RktSym">BACKGROUND</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">for examples see </span><a href="#%28counter._mix._%28figure._fig~3asigs-examples%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">32</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-render</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">aim?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tank-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">aim-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">aim-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">fired?</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tank-render</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-missile</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;33: </span>Полная функция рендеринга</span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Проведя небольшую аналогию, мы можем поступить так же со 
вторым условием <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. На <a href="#%28counter._mix._%28figure._fig~3asi-render%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">33</span></a> показано полное 
определение. Лучше всего то, что мы можем сразу повторно использовать наши функции 
списка пожеланий, <span class="RktSym">tank-render</span> и 
<span class="RktSym">ufo-render</span>, и все, что нам нужно добавить, - это функция для
включения ракеты в сцену. Соответствующая запись в списке пожеланий:  
<a name="(idx._mix._(gentag._163._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._missile%29" class="techoutside" data-pltdoc="x"><span class="techinside">Missile</span></a><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds </span><span class="RktSym">m</span><span class="RktCmt"> to the given image </span><span class="RktSym">im</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="hspace">&nbsp;</span><span class="RktSym">im</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">im</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Как и выше, комментарий достаточно подробно описывает то, что мы хотим. 
</div>

<p></p>

<p></p>

<div class="SIntrapara"><a name="(counter._mix._(exercise._mix-ufo-render))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;97. Разработайте функции  
 <span class="RktSym">tank-render</span>,  <span class="RktSym">ufo-render</span> и 
<span class="RktSym">missile-render</span>. Сравните это выражение:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">tank-render</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-missile</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
с этим:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym">ufo-render</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tank-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">fired-missile</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Когда два выражения дают одинаковый результат? 
 <a href="#%28counter._mix._%28exercise._mix-ufo-render%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._mix._(exercise._mix-ufo-stop))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;98. Разработайте функцию <span class="RktSym">si-game-over?</span>
 для использования в качестве обработчика остановки 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span>. Игра останавливается, 
если НЛО приземляется или ракета попадает в НЛО. 
Для обоих условий мы рекомендуем вам проверить близость одного объекта к другому. </p>

<p>Предложение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span> допускает необязательное второе
подвыражение, а именно функцию, которая отображает конечное состояние игры. 
Создайте  <span class="RktSym">si-render-final</span> и используйте его как вторую 
часть для предложения <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span> в  функции 
<span class="RktSym">main</span> <a href="#%28counter._mix._%28exercise._mix-ufo-fire%29%29" data-pltdoc="x">упражнения&nbsp;100</a>.
<a href="#%28counter._mix._%28exercise._mix-ufo-stop%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._mix._(exercise._mix-ufo-move))"></a><span style="font-weight: bold">Упражненние</span>&nbsp;99. Разработайте <span class="RktSym">si-move</span>. 
Эта функция вызывается для каждого тика часов, чтобы определить, в какую позицию 
сейчас перемещаются объекты. Соответственно, она принимает один элемент 
<a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a> и производит другой. </p>

<p>Переместить танк и ракету (если таковые имеются) относительно несложно. 
Они движутся по прямой с постоянной скоростью. Перемещение НЛО требует небольших 
случайных прыжков влево или вправо. Поскольку вы никогда не имели дела с функциями, 
которые создают случайные числа, оставшаяся часть этого упражнения представляет собой 
длинный намек на то, как справиться с этой проблемой. </p>

<p></p>

<div class="SIntrapara">BSL имеет функцию, которая создает случайные числа. 
Введение в эту функцию показывает, почему подписи и предназначения играют такую 
важную роль во время проектирования. 
Вот соответствующие материалы для нужной вам функции:  
<a name="(idx._mix._(gentag._164._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">produces a number in the interval [</span><span class="RktVal">0</span><span class="RktCmt">,</span><span class="RktSym">n</span><span class="RktCmt">),</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">possibly a different one each time it is called </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span><span class="hspace">&nbsp;</span><span class="RktSym">n</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Поскольку подпись и назначение цели точно описывают, 
что вычисляет функция, теперь вы можете поэкспериментировать с <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span> в области взаимодействий DrRacket. Стоп! Сделай это! </div>

<p></p>

<p></p>

<div class="SIntrapara">Если <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span> выдает разные(почти) числа  каждый 
раз при вызове, тестирование функций, использующих 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span>, затруднено. Для начала разделите <span class="RktSym">si-move</span> и его собственное функционирование на две части: 
<span class="refelem"><span class="refcolumn"><span class="refcontent">
Идея о том, что вы должны использовать <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span>, 
является знанием BSL, а не частью навыков проектирования, которые вы должны приобрести, 
поэтому мы предоставляем этот совет. Кроме того, <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span> - 
это первый и единственный примитив BSL, который не является математической функцией. 
Функции в программировании основаны на математических функциях, но это не идентичные концепции. 
</span></span></span>
<a name="(idx._mix._(gentag._165._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-move</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-move-proper</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a><span class="RktCmt"> Number -&gt; </span><a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">moves the space-invader objects predictably by </span><span class="RktSym">delta</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-move-proper</span><span class="hspace">&nbsp;</span><span class="RktSym">w</span><span class="hspace">&nbsp;</span><span class="RktSym">delta</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">w</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">С помощью этого определения вы отделяете создание 
случайного числа от процесса перемещения игровых объектов. 
Хотя <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span> может давать разные 
результаты при каждом вызове,  <span class="RktSym">si-move-proper</span> можно 
протестировать на определенных числовых входных данных и, таким образом, 
гарантированно вернуть тот же результат при одинаковых входных данных. 
Короче говоря, большая часть кода остается тестируемой. </div>

<p></p>

<p>Вместо прямого вызова <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._random%29%29" class="RktValLink" data-pltdoc="x">random</a></span> вы можете создать функцию, 
которая создает случайную координату x для НЛО. Для проверки такой функции рассмотрите 
возможность использования <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-random%29%29" class="RktStxLink" data-pltdoc="x">check-random</a></span> из среды тестирования BSL.
<a href="#%28counter._mix._%28exercise._mix-ufo-move%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._mix._(exercise._mix-ufo-fire))"></a><span style="font-weight: bold">упражнение</span>&nbsp;100. Разработайте функцию 
<span class="RktSym">si-control</span>, которая играет роль обработчика клавиатурных событий. 
Таким образом, она принимает состояние игры и событие <a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a> и 
создает новое состояние игры. Она реагирует на три разных клавиши: 
</div><div class="SIntrapara"><ul><li>

<p>нажатие на стрелку влево обеспечивает движение танка влево; </p>

</li><li>

<p>нажатие правой стрелки обеспечивает движение танка вправо; а также</p>

</li><li>

<p>нажатие клавиши пробела запускает ракету, если она еще не запущена. </p>

</li></ul></div>

<p></p>

<p>Когда у вас есть эта функция, вы можете определить функцию <span class="RktSym">si-main</span>,
которая использует <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> для создания окна игры. 
Наслаждайся! 
 <a href="#%28counter._mix._%28exercise._mix-ufo-fire%29%29" class="ex-end" data-pltdoc="x"></a>
<a name="(idx._mix._(gentag._166._mix))"></a></p>

<blockquote class="Figure"><a name="(counter._mix._(figure._fig~3amix-ufo2))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._sigs..v2%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS.v2</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">renders the given game state on top of </span><span class="RktSym">BACKGROUND</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">si-render.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">tank-render</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sigs-tank</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ufo-render</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sigs-ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render.v2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">sigs-missile</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">BACKGROUND</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;34: </span>Повторная отрисовка состояний игры </span></p>

</blockquote>

<p></p>

<div class="SIntrapara">Представления данных редко бывают уникальными. 
Например, мы могли бы использовать один структурный тип для представления состояний игры 
с космическими захватчиками: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">sigs</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">ufo</span><span class="hspace">&nbsp;</span><span class="RktSym">tank</span><span class="hspace">&nbsp;</span><span class="RktSym">missile</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mix._sigs..v2)"></a><span style="font-style: italic">SIGS.v2</span><span class="RktCmt"> (short for </span><span style="font-style: italic">SIGS version 2</span><span class="RktCmt">) is a structure:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-sigs</span><span class="stt"> </span><a href="#%28tech._mix._ufo%29" class="techoutside" data-pltdoc="x"><span class="techinside">UFO</span></a><span class="stt"> </span><a href="#%28tech._mix._tank%29" class="techoutside" data-pltdoc="x"><span class="techinside">Tank</span></a><span class="stt"> </span><a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> represents the complete state of a</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">space invader game</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mix._missileornot)"></a><span style="font-style: italic">MissileOrNot</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">#false</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktVal">#false</span><span class="RktCmt"> means the missile is in the tank;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a><span class="RktCmt"> says the missile is at that location</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
В отличие от первого <a name="(idx._mix._(gentag._167._mix))"></a>представления данных 
для состояний игры, эта вторая версия не делает различий между до запуска ракеты и 
после него. Вместо этого каждое состояние содержит некоторые данные о ракете, 
хотя эта часть данных может быть просто <span class="RktVal">#false</span>, 
что указывает на то, что ракета еще не была запущена. </div>

<p></p>

<p>В результате функции для этого второго представления данных состояний отличаются 
от функций для первого. В частности, функции, которые используют элемент 
<a href="#%28tech._mix._sigs..v2%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS.v2</span></a>, не используют выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, потому что в коллекции есть только один вид элементов. 
С точки зрения подхода к проектированию достаточно 
<a name="(idx._mix._(gentag._168._mix))"></a> рецепта проектирования структур из раздела <a href="#%28part._sec~3adesignstructs%29" data-pltdoc="x">Проектирование со структурами</a>. 
На <a href="#%28counter._mix._%28figure._fig~3amix-ufo2%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">34</span></a> показан результат разработки функции рендеринга 
для этого представления данных. </p>

<p></p>

<div class="SIntrapara">Напротив, для проектирования функций с использованием 
<a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a> требуется рецепт из этого раздела. 
Давайте посмотрим на разработку <span class="RktSym">missile-render.v2</span>, 
задача которой - добавить ракету к изображению. Вот материал заголовка:  
<a name="(idx._mix._(gentag._169._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">adds an image of missile m to scene </span><span class="RktSym">s</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p>Что касается примеров, мы должны рассмотреть как минимум два случая: один, 
когда <span class="RktSym">m</span> имеет значение <span class="RktVal">#false</span>, 
и другой, когда <span class="RktSym">m</span> является <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>. 
В первом случае ракета не была запущена, что означает, что изображение ракеты не должно 
быть добавлено в данную сцену. Во втором случае указывается положение ракеты, и именно 
там должно появиться изображение ракеты. <a href="#%28counter._mix._%28figure._fig~3amissile-render%29%29" data-pltdoc="x">Рисунок&nbsp;<span class="FigureRef">35</span></a> 
демонстрирует работу функции с двумя различными сценариями. </p>

<blockquote class="Figure"><a name="(counter._mix._(figure._fig~3amissile-render))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote><table style="border-collapse: collapse;" cellspacing="0" cellpadding="0"><tbody><tr><td style="border-bottom: 1px solid black;">

<p><span class="RktSym">m</span></p>

</td><td style="border-bottom: 1px solid black;">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;">

<p><span class="RktPn">(</span><span class="RktSym">missile-render.v2</span><span class="stt"> </span><span class="RktSym">m</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span></p>

</td></tr><tr><td valign="bottom">

<p></p>

</td><td valign="bottom">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="bottom">

<p></p>

</td></tr><tr><td valign="bottom"><span class="RktVal">#false</span></td><td valign="bottom">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="bottom">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_86.png" alt="image" width="86" height="76"></p>

</td></tr><tr><td valign="bottom"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">32</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">TANK-HEIGHT</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></td><td valign="bottom">

<p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p>

</td><td valign="bottom">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_87.png" alt="image" width="86" height="76"></p>

</td></tr></tbody></table></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;35: </span>Рендеринг игр космический
захватчик с танками </span></p>

</blockquote>

<p><a name="(counter._mix._(exercise._mix-ufo2-test))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;101. Превратите примеры на 
<a href="#%28counter._mix._%28figure._fig~3amissile-render%29%29" data-pltdoc="x">рисунке &nbsp;<span class="FigureRef">35</span></a> в тестовые примеры. 
<a href="#%28counter._mix._%28exercise._mix-ufo2-test%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara">Теперь мы готовы разработать шаблон. Поскольку определение данных 
для главного аргумента (<span class="RktSym">m</span>) представляет собой 
детализацию с двумя элементами, тело функции, вероятно, будет состоять из выражения 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> с двумя предложениями:  
<a name="(idx._mix._(gentag._170._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
После определения данных снова первое предложение <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> проверяет,
является ли <a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a> логическим значением, а второе проверяет, является ли 
оно элементом <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>. И, если кто-то случайно применит 
<span class="RktSym">missile-render.v2</span> к <span class="RktVal">#true</span> и к 
какому-либо изображению, функция будет использовать первое предложение 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> для вычисления результата. 
Ниже мы подробнее расскажем о таких ошибках. </div>

<p></p>

<p></p>

<div class="SIntrapara">Второй шаг шаблона запрашивает выражения селектора 
во всех тех предложениях <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>, которые имеют дело со структурами. 
В нашем примере это верно для второго предложения, и выражения селектора извлекают 
координаты x и y из заданного  <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>: 
<a name="(idx._mix._(gentag._171._mix))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Сравните этот шаблон с шаблоном для <span class="RktSym">si-render</span> выше. 
Определение данных для последнего имеет дело с двумя различными типами структур, 
и поэтому шаблон функции для <span class="RktSym">si-render</span> содержит выражения 
селектора в обоих предложениях <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. 
Однако определение данных для<a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a> смешивает элементы, 
которые являются простыми значениями, с элементами, описывающими структуры. 
Оба типа определений вполне подходят; ключ для вас - следовать рецепту и найти 
организацию кода, которая соответствует определению данных. 
</div>

<p></p>

<p></p>

<div class="SIntrapara">Вот полное определение функции: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-render.v2</span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._place-image%29%29" class="RktValLink" data-pltdoc="x">place-image</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MISSILE</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">m</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Выполняя его шаг за шагом, вы сначала работаете над простыми предложениями; 
в этой функции оно первое. Поскольку в нем говорится, что ракета не была запущена, 
функция возвращает заданное значение <span class="RktSym">s</span>. 
Для второго предложения нужно помнить, что <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="stt"> </span><span class="RktSym">m</span><span class="RktPn">)</span> и <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="stt"> </span><span class="RktSym">m</span><span class="RktPn">)</span> 
выбирают координаты для изображения ракеты. Эта функция должна добавлять 
<span class="RktSym">MISSILE</span> к <span class="RktSym">s</span>, 
поэтому вам нужно выяснить лучшую комбинацию примитивных операций и ваших 
собственных функций для объединения четырех значений. Выбор этой операции комбинирования - 
это именно то место, где в игру вступает ваше творческое чутье как программиста. 
</div>

<p></p>

<p><a name="(counter._mix._(exercise._mix-ufo2-finish))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;102. Разработайте все другие функции, которые необходимы 
для завершения игры для этого второго определения данных. 
 <a href="#%28counter._mix._%28exercise._mix-ufo2-finish%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._mix._(exercise._mix-zoo))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;103. Разработайте представление данных для следующих четырех 
видов животных зоопарка: 
</div><div class="SIntrapara"><ul><li>

<p><span style="font-weight: bold">spiders(пауки)</span>, соответствующие атрибуты 
которых - количество оставшихся ног (мы предполагаем, что пауки могут потерять ноги 
в результате несчастного случая) и пространство, необходимое им в случае 
транспортировки; </p>

</li><li>

<p><span style="font-weight: bold">elephants(слоны)</span>, единственные атрибуты которых - пространство, необходимое в случае транспортировки; </p>

</li><li>

<p><span style="font-weight: bold">boa constrictors(удавы)</span>, атрибуты которых 
включают длину и обхват; а также</p>

</li><li>

<p><span style="font-weight: bold">armadillos(броненосцы)</span>, для которых 
вы должны определить соответствующие атрибуты, в том числе тот, который определяет 
пространство, необходимое для транспортировки. </p>

</li></ul></div><div class="SIntrapara">Разработайте шаблон для функций, которые принимают в 
качестве аргументов животных из зоопарка. </div>

<p></p>

<p>Создавайте функцию <span class="RktSym">fits?</span>, которая принимает животное 
из зоопарка и описание клетки. Она определяет, достаточен ли объем клетки для животного. 
 <a href="#%28counter._mix._%28exercise._mix-zoo%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._mix._(exercise._mix-vehicle))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;104. Ваш родной город управляет парком транспортных средств:
автомобилями, фургонами, автобусами и внедорожниками. Разработайте представление данных 
для автомобилей. Представление каждого транспортного средства должно описывать количество 
пассажиров, которых оно может перевозить, его номерной знак и расход топлива (миль на галлон).
Разработайте шаблон для функций, которые потребляют(принимают в качестве аргументов) автомобили.
 <a href="#%28counter._mix._%28exercise._mix-vehicle%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._mix._(exercise._mix-coordinates))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;105. Некоторые программы содержат 
следующее определение данных: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._mix._coordinate)"></a><span style="font-style: italic">Coordinate</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><a href="#%28tech._negativenumber%29" class="techoutside" data-pltdoc="x"><span class="techinside">NegativeNumber</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> on the y axis, distance from top</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><a href="#%28tech._positivenumber%29" class="techoutside" data-pltdoc="x"><span class="techinside">PositiveNumber</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> on the x axis, distance from left</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> an ordinary Cartesian point</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Составьте как минимум два примера данных для каждого предложения в определении данных. 
Для каждого из примеров объясните его значение с помощью наброска холста. 
 <a href="#%28counter._mix._%28exercise._mix-coordinates%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<h4>6.2<tt>&nbsp;</tt><a name="(part._sec~3aworlds-mix)"></a>Смешивая миры</h4>

<p>В этом разделе предлагается несколько задач проектирования программного мира, 
начиная с простых упражнений-расширений, касающихся наших виртуальных питомцев. </p>

<p><a name="(counter._(exercise._zoo3))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;106.  В <a href="#%28part._sec~3azoo2%29" data-pltdoc="x">Другие виртуальные питомцы</a> 
мы обсуждали создание виртуальных питомцев с индикаторами счастья. 
Один из виртуальных питомцев - кошка; другой - хамелеон. 
Однако каждая программа посвящена одному питомцу.  </p>

<p></p>

<div class="SIntrapara">Разработайте программный мир <span class="RktSym">cat-cham</span>.
Учитывающий и местоположение, и животное, оно ходит по холсту, начиная с заданного
местоположения. Вот выбранное представление данных для животных: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._vanimal)"></a><span style="font-style: italic">VAnimal</span><span class="RktCmt"> is either</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><span style="font-style: italic">VCat</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> a </span><span style="font-style: italic">VCham</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara"> где <span style="font-style: italic">VCat</span> и 
<span style="font-style: italic">VCham</span> - ваши определения данных из  
 <a href="#%28counter._%28exercise._struct12%29%29" data-pltdoc="x">упражнений&nbsp;88</a>
<a href="#%28counter._%28exercise._struct16%29%29" data-pltdoc="x">и&nbsp;92</a>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Учитывая, что <a href="#%28tech._vanimal%29" class="techoutside" data-pltdoc="x"><span class="techinside">VAnimal</span></a> представляет собой 
совокупность состояний мира, вам необходимо спроектировать 
</div><div class="SIntrapara"><ul><li>

<p>функция рендеринга из <a href="#%28tech._vanimal%29" class="techoutside" data-pltdoc="x"><span class="techinside">VAnimal</span></a> в <a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a>;</p>

</li><li>

<p>функция для обработки тактов часов, от <a href="#%28tech._vanimal%29" class="techoutside" data-pltdoc="x"><span class="techinside">VAnimal</span></a> до <a href="#%28tech._vanimal%29" class="techoutside" data-pltdoc="x"><span class="techinside">VAnimal</span></a>; а также</p>

</li><li>

<p>функция для работы с событиями клавиатуры, чтобы вы могли кормить, 
погладить и раскрасить свое животное - если применимо. </p>

</li></ul></div><div class="SIntrapara">Изменить окрас кошки или погладить хамелеона 
по-прежнему невозможно.  
<a href="#%28counter._%28exercise._zoo3%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._(exercise._zoo4))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;107. Разработайте программу <span class="RktSym">cham-and-cat</span>, которая работает 
как с виртуальным котом, так <span style="font-weight: bold">и</span> с виртуальным хамелеоном. 
Вам необходимо определение данных для “zoo”, содержащее как животных, так и функции для работы с ними. </p>

<p></p>

<div class="SIntrapara">Постановка задачи оставляет открытым вопрос о том, 
как клавиши управляют двумя животными. 
Вот два возможных толкования: 
</div><div class="SIntrapara"><ol><li>

<p>Каждое клавиатурное событие достается обоим животным.</p>

</li><li>

<p>Каждое ключевое событие относится только к одному из двух животных. </p>

<p>Для этой альтернативы вам необходимо <a name="(idx._(gentag._172))"></a>представление данных,
которое указывает животное в <span style="font-style: italic">focus(фокусе)</span> 
то есть животное, которым в данный момент можно управлять. Чтобы переключить фокус, 
пусть функция обработки клавиш интерпретирует <span class="RktVal">"k"</span> для 
“kitty”(котенка) и <span class="RktVal">"l"</span> для lizard(ящерицы). 
Как только игрок нажимает <span class="RktVal">"k"</span>, следующие нажатия клавиш 
применяются только к коту - до тех пор, пока игрок не нажмет 
<span class="RktVal">"l"</span>.</p>

</li></ol></div><div class="SIntrapara">Выберите один из вариантов и разработайте 
подходящую программу.  
<a href="#%28counter._%28exercise._zoo4%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._(exercise._pedestrian))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;108. По умолчанию светофор для пешеходного перехода показывает стоящего 
оранжевого человека на черном фоне. Когда приходит время позволить пешеходу перейти улицу, 
свет получает сигнал и переключается на зеленый идущий человек. Эта фаза длится 10 секунд. 
После этого на индикаторе появятся цифры <span class="RktVal">9</span>, 
<span class="RktVal">8</span>, ...,  <span class="RktVal">0</span> с нечетными числами 
оранжевого цвета и четными числами зеленого цвета. Когда обратный отсчет достигает 0, 
свет возвращается в состояние по умолчанию.</p>

<p></p>

<div class="SIntrapara">Разработайте программный мир, реализующий такой пешеходный светофор. 
Свет переключается из состояния по умолчанию, когда вы нажимаете клавишу пробела на клавиатуре. 
Все остальные переходы должны быть реакцией на тиканье часов. 
Вы можете использовать следующие изображения 
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><img src="part_one_files/pedestrian_traffic_light_red.png" alt="" width="57" height="56"> <img src="part_one_files/pedestrian_traffic_light_green.png" alt="" width="68" height="56"></p>

</blockquote></div><div class="SIntrapara">или вы можете создать свои собственные фигурки из библиотеки изображений.
 <a href="#%28counter._%28exercise._pedestrian%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p><a name="(counter._(exercise._ex~3afsm))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;109. Разработайте программный мир, который распознает шаблон 
в последовательности <a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a>. Первоначально программа показывает 
белый прямоугольник 100 на 100. Как только ваша программа обнаружит первую 
желаемую букву, она отобразит желтый прямоугольник того же размера. 
После встречи с последней буквой цвет прямоугольника становится зеленым. 
Если происходит какое-либо “неверное“ клавиатурное событие, программа 
отображает красный прямоугольник. 
</p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3afsm-dd))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table style="border-collapse: collapse;" cellspacing="0" cellpadding="0"><tbody><tr><td style="border-bottom: 1px solid black;">

<p>общепринятый</p>

</td><td style="border-bottom: 1px solid black;">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td style="border-bottom: 1px solid black;">

<p>определенные сокращения</p>

</td></tr><tr><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a name="(tech._expectstosee..v1)"></a><span style="font-style: italic">ExpectsToSee.v1</span><span class="RktCmt"> is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"start, expect an 'a'"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"expect 'b', 'c', or 'd'"</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"finished"</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktVal">"error, illegal key"</span><span class="RktCmt"> </span></td></tr></tbody></table></td><td valign="top">

<p><span class="hspace">&nbsp;&nbsp;</span></p>

</td><td valign="top"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a name="(tech._expectstosee..v2)"></a><span style="font-style: italic">ExpectsToSee.v2</span><span class="RktCmt"> is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">AA</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">BB</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">DD</span><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktSym">ER</span><span class="RktCmt"> </span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">AA</span><span class="hspace">&nbsp;</span><span class="RktVal">"start, ..."</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">BB</span><span class="hspace">&nbsp;</span><span class="RktVal">"expect ..."</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">DD</span><span class="hspace">&nbsp;</span><span class="RktVal">"finished"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">ER</span><span class="hspace">&nbsp;</span><span class="RktVal">"error, ..."</span><span class="RktPn">)</span></td></tr></tbody></table></td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;36: </span>Два способа написания определения данных для конечных автоматов(FSM) </span></p>

</blockquote>

<p>Конкретные последовательности, которые ищет ваша программа, начинаются с 
<span class="RktVal">"a"</span>, за которым следует произвольно длинное сочетание 
 <span class="RktVal">"b"</span> и <span class="RktVal">"c"</span>, и заканчивается 
<span class="RktVal">"d"</span>. Ясно, что <span class="RktVal">"acbd"</span> - это 
один из примеров допустимой строки; два других - <span class="RktVal">"ad"</span> и
 <span class="RktVal">"abcbbbcd"</span>. Конечно, <span class="RktVal">"da"</span>, <span class="RktVal">"aa"</span>, или  <span class="RktVal">"d"</span> не соответстуют. </p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3afsm-a-b-or-c*-d))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><blockquote class="SCentered">

<p><img style="vertical-align: 0px; margin: -3px -3px -3px -3px;" src="part_one_files/pict_88.png" alt="image" width="606.0" height="256.0"></p>

</blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;37: </span>Конечный автомат в виде диаграммы </span></p>

</blockquote>

<p><span style="font-weight: bold">Подсказка</span> . В вашем решении реализован 
конечный автомат (FSM) - идея, представленная в <<a href="#%28part._sec~3aworlds-more%29" data-pltdoc="x">Миры Конечных состоянийs</a> как один из принципов проектирования программных
миров. Как следует из названия, программа FSM может находиться в одном из 
конечного числа состояний. Первое состояние называется 
<span style="font-style: italic">initial state</span>(начальным состоянием). 
Каждое клавиатурное событие заставляет машину пересматривать свое текущее состояние; 
она может перейти в то же состояние или в другое. Когда ваша программа распознает 
правильную последовательность клавиатурных событий, она переходит в 
<span style="font-style: italic">final state</span>(конечное состояние). </p>

<p>Для задачи распознавания последовательности состояний обычно представляют буквы, 
которые машина ожидает увидеть дальше; см. <a href="#%28counter._%28figure._fig~3afsm-dd%29%29" data-pltdoc="x">рисунок&nbsp;<span class="FigureRef">36</span></a> для определения данных.
<span class="refelem"><span class="refcolumn"><span class="refcontent">
В определении данных справа используется техника именования, представленная в 
<a href="#%28counter._%28exercise._ex~3aalternative-data-design2%29%29" data-pltdoc="x">упражнении&nbsp;61</a>.</span></span></span> 
Взгляните на последнее состояние, в котором говорится, что обнаружен недопустимый ввод. 
На <a href="#%28counter._%28figure._fig~3afsm-a-b-or-c%2A-d%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">37</span></a> показано, как представить 
себе эти состояния и их отношения в виде диаграммы. Каждый узел соответствует одному 
из четырех конечных состояний; каждая стрелка указывает, какое событие 
<a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a> вызывает переход программы из одного состояния 
в другое. </p>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">История</span> 
История В 1950-х годах Stephen C. Kleene, которого мы бы назвали компьютерным ученым, 
изобрел <span style="font-style: italic">regular expressions</span>(регулярные выражения)
для обозначения проблемы распознавания текстовых шаблонов. 
Для указанной выше проблемы Клини написал бы 
</div><div class="SIntrapara"><blockquote class="SCentered">

<p><span class="stt">a (b|c)* d</span></p>

</blockquote></div><div class="SIntrapara">что означает, <span class="stt">a</span>, 
за которым следует <span class="stt">b</span> или <span class="stt">c</span> 
произвольно часто, пока не встретится <span class="stt">d</span>.
 <a href="#%28counter._%28exercise._ex~3afsm%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<h4>6.3<tt>&nbsp;</tt><a name="(part._sec~3ainput-errors)"></a>Ошибки Ввода</h4>

<p>Один из центральных моментов этой главы касается роли предикатов. 
Они имеют решающее значение, когда вы должны разработать функции, обрабатывающие 
совокупность данных. Такие сочетания возникают естественным образом, когда в 
формулировке вашей проблемы упоминается много различных видов информации, 
но они также возникают, когда вы передаете свои функции и программы другим. 
В конце концов, вы
<span class="refelem"><span class="refcolumn"><span class="refcontent">Это форма 
самообмана - ожидать, что мы всегда уважаем собственные сигнатуры функций. 
Вызов функции для неправильных данных случается с лучшими из нас. 
В то время как многие языки похожи на BSL и ожидают, что программисты будут проверять 
сигнатуры самостоятельно, другие делают это автоматически за счет некоторой 
дополнительной сложности.
</span></span></span>  
знаете и уважаете определения данных и сигнатуры функций. Однако вы никогда не знаете, 
чем занимаются ваши друзья и коллеги, и особенно не знаете, как кто-то 
без знания BSL и программирования использует ваши программы. Таким образом, 
в этом разделе представлен один из способов защиты программ от 
несоответствующего ввода.</p>

<p></p>

<div class="SIntrapara">Давайте продемонстрируем этот момент с помощью простой программы, 
функции для вычисления площади диска: <a name="(idx._(gentag._173))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the area of a disk with radius </span><span class="RktSym">r</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">area-of-disk</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktVal">3.14</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Наши друзья могут захотеть использовать эту функцию для своего домашнего задания по геометрии. 
К сожалению, когда наши друзья используют эту функцию, они могут случайно применить ее 
к строке, а не к числу. Когда это происходит, функция останавливает выполнение программы 
с загадочным сообщением об ошибке: 
<a name="(idx._(gentag._174))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">area-of-disk</span><span class="hspace">&nbsp;</span><span class="RktVal">"my-disk"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">*:expects a number, given "my-disk"</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">
С помощью предикатов вы можете предотвратить появление такого рода загадочных сообщений 
об ошибках и сигнализировать об информативной ошибке по вашему выбору. 
</div>

<p></p>

<blockquote class="Figure"><a name="(counter._(figure._fig~3absl-universe))" x-target-lift="Figure"></a><blockquote class="Centerfigure"><blockquote class="FigureInside"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a name="(tech._any)"></a><span style="font-style: italic">Any</span><span class="RktCmt"> </span><span class="RktCmt">BSL</span><span class="RktCmt"> value is one of: </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._string%29" class="techoutside" data-pltdoc="x"><span class="techinside">String</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><a href="#%28tech._image%29" class="techoutside" data-pltdoc="x"><span class="techinside">Image</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="stt"> </span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="stt"> </span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span>...</td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">–</span><span class="RktCmt"> </span><span class="RktPn">(</span><span class="RktSym">make-tank</span><span class="stt"> </span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="stt"> </span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span>...</td></tr></tbody></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget">Рисунок&nbsp;38: </span>Вселенная данных BSL </span></p>

</blockquote>

<p>В частности, мы можем определять проверенные версии наших функций, 
когда хотим передать их нашим друзьям. Поскольку наши друзья могут не знать BSL, 
мы должны ожидать, что они применят эту 
<span style="font-style: italic">проверенную функцию</span> к произвольным значениям BSL: 
числам, строкам, изображениям, <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>s и так далее. 
Хотя мы не можем предвидеть, какие типы структур будут определены в BSL, мы знаем 
приблизительную форму определения данных для множества всех значений BSL. 
На  <a href="#%28counter._%28figure._fig~3absl-universe%29%29" data-pltdoc="x">рисунке&nbsp;<span class="FigureRef">38</span></a> показана эта форма определения данных. 
Как обсуждалось в <a href="#%28part._data-uni._sec~3adata-uni%29" data-pltdoc="x">Вселенной данных</a>, определение данных для <a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a> является открытым, 
поскольку каждое определение типа структуры добавляет новые экземпляры. 
Эти экземпляры могут снова содержать значения <a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a>, что подразумевает, 
что определение данных <a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a> должно относиться к самому себе - поначалу страшная мысль. </p>

<p></p>

<div class="SIntrapara">На основе этой детализации шаблон для проверенной функции 
имеет следующую приблизительную форму:  
<a name="(idx._(gentag._175))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> -&gt; ???</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">checked-f</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._image~3f%29%29" class="RktValLink" data-pltdoc="x">image?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">which selectors are needed in the next clause?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">tank?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Конечно, никто не может перечислить все пункты этого определения; к счастью, 
в этом нет необходимости. Что мы действительно знаем, так это то, что для всех этих 
значений в классе значений, для которых определена исходная функция, проверенная версия 
должна давать одинаковые результаты; для всех остальных она должна сигнализировать об ошибке. 
</div>

<p></p>

<p></p>

<div class="SIntrapara">Конкретно, наша функция-образец 
<span class="RktSym">checked-area-of-disk</span> принимает произвольное значение BSL 
и использует <span class="RktSym">area-of-disk</span> для вычисления площади диска, 
если ввод - это число. В противном случае она должна остановиться с сообщением об ошибке; 
в BSL мы используем для этого функцию <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span>. 
Функция error использует строку и останавливает программу: 
<a name="(idx._(gentag._176))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow">

<p><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"area-of-disk: number expected"</span><span class="RktPn">)</span></p>

</blockquote></div><div class="SIntrapara">Следовательно, приблизительное определение 
<span class="RktSym">checked-area-of-disk</span> выглядит так: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span><span class="hspace">&nbsp;</span><span class="RktVal">"area-of-disk: number expected"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">checked-area-of-disk</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">area-of-disk</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._image~3f%29%29" class="RktValLink" data-pltdoc="x">image?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">tank?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Использование <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span> помогает естественным образом завершить это определение: 
<a name="(idx._(gentag._177))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">computes the area of a disk with radius </span><span class="RktSym">v</span><span class="RktCmt">, </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if </span><span class="RktSym">v</span><span class="RktCmt"> is a number</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">checked-area-of-disk</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">area-of-disk</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"area-of-disk: number expected"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
И чтобы убедиться, что мы получаем то, что хотим, давайте поэкспериментируем: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">checked-area-of-disk</span><span class="hspace">&nbsp;</span><span class="RktVal">"my-disk"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">area-of-disk:number expected</span></p>

</td></tr></tbody></table></blockquote></div>

<p></p>

<p>Написание проверяющих функций важно, если мы распространяем наши программы 
для использования другими. Однако разработка программ, которые работают должным образом, 
гораздо важнее. В этой книге основное внимание уделяется процессу проектирования для 
правильного проектирования программ, и, чтобы не отвлекаться, мы согласны с тем, 
что всегда придерживаемся определений данных и сигнатур. По крайней мере, мы почти всегда 
это делаем, и в редких случаях мы можем попросить вас разработать проверяющие версии 
функции или программы. </p>

<p><a name="(counter._(exercise._ex~3achecked2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;110. Проверяющая версия <span class="RktSym">area-of-disk</span> также может 
требовать, чтобы аргументы функции были положительными числами, а не просто произвольными 
числами. Измените таким образом <span class="RktSym">checked-area-of-disk</span>.  
<a href="#%28counter._%28exercise._ex~3achecked2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p></p>

<div class="SIntrapara"><a name="(counter._(exercise._ex~3achecked3))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;111. Взгляните на эти определения: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define-struct%29%29" class="RktStxLink" data-pltdoc="x">define-struct</a></span><span class="hspace">&nbsp;</span><span class="RktSym">vec</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._vec)"></a><span style="font-style: italic">vec</span><span class="RktCmt"> is</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-vec</span><span class="stt"> </span><span class="RktSym">PositiveNumber</span><span class="stt"> </span><span class="RktSym">PositiveNumber</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span style="font-weight: bold">interpretation</span><span class="RktCmt"> represents a velocity vector</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Разработайте функцию <span class="RktSym">checked-make-vec</span>, которую следует 
понимать как проверяющую версию примитивной операции <span class="RktSym">make-vec</span>.
 Это гарантирует, что аргументы <span class="RktSym">make-vec</span> будут положительными
числами. Другими словами, <span class="RktSym">checked-make-vec</span> обеспечивает 
соблюдение нашего неформального определения данных. 
 <a href="#%28counter._%28exercise._ex~3achecked3%29%29" class="ex-end" data-pltdoc="x"></a></div>

<p></p>

<p></p>

<div class="SIntrapara"><span style="font-weight: bold">Предикаты</span>
 Вы можете задаться вопросом, как вы можете создавать свои собственные предикаты. 
В конце концов, проверенные функции действительно имеют такую общую форму: 
<a name="(idx._(gentag._178))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> -&gt; </span>...</td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">checks that </span><span class="RktSym">a</span><span class="RktCmt"> is a proper input for function </span><span class="RktSym">g</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">checked-g</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">XYZ?</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"g: bad input"</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
где сама <span class="RktSym">g</span> определяется так: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._xyz%29" class="techoutside" data-pltdoc="x"><span class="techinside">XYZ</span></a><span class="RktCmt"> -&gt; </span>...</td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">g</span><span class="hspace">&nbsp;</span><span class="RktSym">some-x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Мы предполагаем, что существует определение данных с меткой <a name="(tech._xyz)"></a><span style="font-style: italic">XYZ</span>, и что <span class="RktPn">(</span><span class="RktSym">XYZ?</span><span class="stt"> </span><span class="RktSym">a</span><span class="RktPn">)</span> 
выдает <span class="RktVal">#true</span>, когда <span class="RktSym">a</span> 
 является элементом <a href="#%28tech._xyz%29" class="techoutside" data-pltdoc="x"><span class="techinside">XYZ</span></a>, и <span class="RktVal">#false</span> в противном случае.
</div>

<p></p>

<p>Для <span class="RktSym">area-of-disk</span>, которая принимают 
<a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>(числа), <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span>
очевидно, подходящий предикат. Напротив, для некоторых функций, таких как 
<span class="RktSym">missile-render</span> выше, нам явно нужно определить наш 
собственный предикат, потому что  <a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a> - это надуманный, 
а не встроенный набор данных. Итак, давайте разработаем предикат для 
 <a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a>.</p>

<p></p>

<div class="SIntrapara">Напомним сигнатуру предикатов: 
 <a name="(idx._(gentag._179))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is </span><span class="RktSym">a</span><span class="RktCmt"> an element of the </span><a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a><span class="RktCmt"> collection</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Хорошей практикой является использование вопросов в качестве предназначения для предикатов,
потому что применение предиката похоже на вопрос о значении. Знак вопроса “?” в конце 
названия также усиливает эту идею; некоторые люди могут прибегать к “huh”, чтобы 
произносить названия таких функций. 
</div>

<p></p>

<p></p>

<div class="SIntrapara">Придумывать примеры также несложно: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._make-posn%29%29" class="RktValLink" data-pltdoc="x">make-posn</a></span><span class="hspace">&nbsp;</span><span class="RktVal">9</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Первые два примера напоминают, что каждый элемент<a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a>
 имеет значение <span class="RktVal">#false</span>  или некоторый <a href="#%28tech._posn%29" class="techoutside" data-pltdoc="x"><span class="techinside">Posn</span></a>. 
Третий тест говорит, что строки не являются элементами коллекции. Вот еще три теста: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._empty-image%29%29" class="RktValLink" data-pltdoc="x">empty-image</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">Объясните ожидаемые ответы! </div>

<p></p>

<p>Поскольку предикаты используют все возможные значения BSL, их шаблоны аналогичны 
шаблонам для <span class="RktSym">checked-f</span>. Стоп! 
Найдите шаблон и еще раз посмотрите, прежде чем читать дальше. </p>

<p></p>

<div class="SIntrapara">Как и в случае с проверяющими функциями, предикату не нужны 
все возможные строки <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span>. Требуются только те, которые могут давать <span class="RktVal">#true</span>: 
<a name="(idx._(gentag._180))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-x%29%29" class="RktValLink" data-pltdoc="x">posn-x</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn-y%29%29" class="RktValLink" data-pltdoc="x">posn-y</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Все остальные случаи объединяются с помощью строки <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span>, которая 
дает <span class="RktVal">#false</span>.
 <span class="RktVal">#false</span>.</div>

<p></p>

<p></p>

<div class="SIntrapara">Учитывая шаблон, определение <span class="RktSym">missile-or-not?</span>
это простой вопрос обдумывания каждого случая: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3d~3f%29%29" class="RktValLink" data-pltdoc="x">boolean=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Только <span class="RktVal">#false</span> является допустимым <a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a>; <span class="RktVal">#true</span> - нет. 
Мы выражаем эту идею с помощью <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3d~3f%29%29" class="RktValLink" data-pltdoc="x">boolean=?</a></span><span class="stt"> </span><span class="RktVal">#false</span><span class="stt"> </span><span class="RktSym">v</span><span class="RktPn">)</span>, но <span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._false~3f%29%29" class="RktValLink" data-pltdoc="x">false?</a></span><span class="stt"> </span><span class="RktSym">v</span><span class="RktPn">)</span> также подойдет: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">missile-or-not?</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._false~3f%29%29" class="RktValLink" data-pltdoc="x">false?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._posn~3f%29%29" class="RktValLink" data-pltdoc="x">posn?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Естественно, все элементы <span class="RktSym">Posn</span> также являются членами 
<a href="#%28tech._mix._missileornot%29" class="techoutside" data-pltdoc="x"><span class="techinside">MissileOrNot</span></a>, что объясняет <span class="RktVal">#true</span>
 во второй строке.</div>

<p></p>

<p><a name="(counter._(exercise._ex~3amissile-or-not-or))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;112. Теперь переформулируйте предикат, используя выражение 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span>(или). 
<a href="#%28counter._%28exercise._ex~3amissile-or-not-or%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p><a name="(counter._(exercise._predicate1))"></a><span style="font-weight: bold">Exercise</span>&nbsp;113.Разработайте предикаты для следующих определений данных из предыдущего 
раздела: <a href="#%28tech._mix._sig%29" class="techoutside" data-pltdoc="x"><span class="techinside">SIGS</span></a>, <a href="#%28tech._mix._coordinate%29" class="techoutside" data-pltdoc="x"><span class="techinside">Coordinate</span></a> (<a href="#%28counter._mix._%28exercise._mix-coordinates%29%29" data-pltdoc="x">упражнения&nbsp;105</a>), и <a href="#%28tech._vanimal%29" class="techoutside" data-pltdoc="x"><span class="techinside">VAnimal</span></a>. <a href="#%28counter._%28exercise._predicate1%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>В заключение упомянем <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._key-event~3f%29%29" class="RktValLink" data-pltdoc="x">key-event?</a></span> и
 <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._mouse-event~3f%29%29" class="RktValLink" data-pltdoc="x">mouse-event?</a></span> как два важных предиката, 
которые вы, возможно, захотите использовать в своих программных мирах. 
Они проверяют ожидаемое свойство, но вам следует проверить их документацию, 
чтобы убедиться, что вы понимаете, что они вычисляют. </p>

<h4>6.4<tt>&nbsp;</tt><a name="(part._sec~3aworld-checking)"></a>Проверка мира</h4>

<p>В программном мире многое может пойти не так. Хотя мы просто согласились верить, 
что наши функции всегда применяются к надлежащему типу данных, в программном мире
мы можем манипулировать слишком многими вещами одновременно, чтобы так сильно доверять себе.
Когда мы разрабатываем программный мир, которая заботится о тактах часов, щелчках мыши, 
нажатиях клавиш и рендеринге, очень легко ошибиться в одном из этих взаимодействий. 
Конечно, ошибка не означает, что BSL сразу распознает ошибку. Например, одна из наших 
функций может дать результат, который не совсем элемент вашего представления данных 
для состояний мира. В то же время <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> принимает этот фрагмент данных 
и хранит его, пока не произойдет следующее событие. Только когда следующий обработчик 
событий получает этот несоответствующий фрагмент данных, программа может выйти из строя. 
Но это может ухудшиться, потому что даже второй, третий и четвертый этап обработки 
событий могут фактически справиться с несоответствующими значениями состояния, 
и все это взрывается намного позже в процессе. 
</p>

<p>Чтобы помочь с такого рода проблемами, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> поставляется с 
дополнительным предложением <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._check-with%29%29" class="RktStxLink" data-pltdoc="x">check-with</a></span>, которое принимает предикат 
для состояний мира. Если, например, мы решили представлять все состояния мира с помощью 
<a href="#%28tech._number%29" class="techoutside" data-pltdoc="x"><span class="techinside">Number</span></a>, мы могли бы легко выразить этот факт следующим образом:
 <a name="(idx._(gentag._181))"></a> <a name="(idx._(gentag._182))"></a></p>

<p></p>

<div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._check-with%29%29" class="RktStxLink" data-pltdoc="x">check-with</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="RktPn">]</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Как только какая-либо функция обработки событий производит что-то, кроме числа, мир
останавливается с соответствующим сообщением об ошибке. </div>

<p></p>

<p></p>

<div class="SIntrapara">Предложение <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._check-with%29%29" class="RktStxLink" data-pltdoc="x">check-with</a></span> еще более полезно, 
когда определение данных - это не просто класс данных со встроенным предикатом, таким как 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span> но что-то тонкое, например, это определение интервала: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">A </span><a name="(tech._unitworld)"></a><span style="font-style: italic">UnitWorld</span><span class="RktCmt"> is a number </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">between </span><span class="RktVal">0</span><span class="RktCmt"> (inclusive) and </span><span class="RktVal">1</span><span class="RktCmt"> (exclusive). </span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">In that case you want to formulate a predicate for this interval: <a name="(idx._(gentag._183))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a><span class="RktCmt"> </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is </span><span class="RktSym">x</span><span class="RktCmt"> between </span><span class="RktVal">0</span><span class="RktCmt"> (inclusive) and </span><span class="RktVal">1</span><span class="RktCmt"> (exclusive)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between-0-and-1?</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between-0-and-1?</span><span class="hspace">&nbsp;</span><span class="RktVal">1.2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between-0-and-1?</span><span class="hspace">&nbsp;</span><span class="RktVal">0.2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between-0-and-1?</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between-0-and-1?</span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">between-0-and-1?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c~3d%29%29" class="RktValLink" data-pltdoc="x">&lt;=</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
С помощью этого предиката вы теперь можете отслеживать каждый переход в вашем программном мире: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._check-with%29%29" class="RktStxLink" data-pltdoc="x">check-with</a></span><span class="hspace">&nbsp;</span><span class="RktSym">between-0-and-1?</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._......%29%29" class="RktStxLink" data-pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Если какой-либо из мировых обработчиков создает число за пределами интервала или, что еще хуже,
нечисловое значение, наша программа немедленно обнаруживает эту ошибку и дает нам шанс 
исправить ошибку.</div>

<p></p>

<p><a name="(counter._(exercise._predicate2))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;114. Используйте предикаты из  <a href="#%28counter._%28exercise._predicate1%29%29" data-pltdoc="x">упражнения&nbsp;113</a>, чтобы проверить программный мир космических захватчиков,
программу виртуальных питомцев (<a href="#%28counter._%28exercise._zoo3%29%29" data-pltdoc="x">упражнение&nbsp;106</a>) и программу-редактор  
(<a href="#%28part._sec~3aedit1%29" data-pltdoc="x">Графический Редактор</a>). 
<a href="#%28counter._%28exercise._predicate2%29%29" class="ex-end" data-pltdoc="x"></a></p>

<h4>6.5<tt>&nbsp;</tt><a name="(part._sec~3aequality1)"></a>Предикаты равенства </h4>

<p></p>

<div class="SIntrapara">
<span style="font-style: italic">Предикат равенства</span> - это функция, сравнивающая 
два элемента одного и того же набора данных. Вспомните определение 
<a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>, которое представляет собой набор из трех строк:
<span class="RktVal">"red"</span>, <span class="RktVal">"green"</span> и 
<span class="RktVal">"yellow"</span>. Вот один из способов определить функцию
<span class="RktSym">light=?</span>: 
 <a name="(idx._(gentag._184))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a><span class="RktCmt"> </span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">are the two (states of) traffic lights equal</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktSym">a-value</span><span class="hspace">&nbsp;</span><span class="RktSym">another-value</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-value</span><span class="hspace">&nbsp;</span><span class="RktSym">another-value</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Когда мы нажимаем <span class="emph">RUN</span>, все тесты проходят успешно, но, 
к сожалению, другие взаимодействия выявляют конфликты с нашими намерениями:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"salad"</span><span class="hspace">&nbsp;</span><span class="RktVal">"greens"</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktRes">#false</span></p>

</td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"beans"</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">string=?:expects a string, given 10</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">
Сравните эти взаимодействия с другими встроенными предикатами равенства: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._boolean~3d~3f%29%29" class="RktValLink" data-pltdoc="x">boolean=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"#true"</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span></td></tr><tr><td>

<p><span class="RktErr">boolean=?:expects a boolean as 1st argument, given "#true"</span></p>

</td></tr></tbody></table></blockquote></div><div class="SIntrapara">Попробуйте 
span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="stt"> </span><span class="RktVal">10</span><span class="stt"> </span><span class="RktVal">#true</span><span class="RktPn">)</span> и 
<span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._~3d%29%29" class="RktValLink" data-pltdoc="x">=</a></span><span class="stt"> </span><span class="RktVal">20</span><span class="stt"> </span><span class="RktVal">"help"</span><span class="RktPn">)</span>
самостоятельно. Все они сигнализируют об ошибке о применении к неверному аргументу.</div>

<p></p>

<p></p>

<div class="SIntrapara">Проверяющая версия <span class="RktSym">light=?</span> 
обеспечивает, чтобы оба аргумента принадлежали  
<a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>;<span class="refelem"><span class="refcolumn"><span class="refcontent">Регистр символов имеет значение; <span class="RktVal">"red"</span> 
 отличается от <span class="RktVal">"Red"</span> или <span class="RktVal">"RED"</span>.</span></span></span> 
в противном случае она сигнализирует об ошибке, подобной той, что выдают 
встроенные предикаты равенства. Мы называем предикат для  <span class="RktSym">TrafficLight</span> <span class="RktSym">light?</span>, для краткости:
<a name="(idx._(gentag._185))"></a>
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">is the given value an element of </span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._or%29%29" class="RktStxLink" data-pltdoc="x">or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p></p>

<div class="SIntrapara">Теперь можно завершить доработку <span class="RktSym">light=?</span>
просто следуя нашему первоначальному анализу. Во-первых, функция определяет, что два входа
являются элементами <a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>; в противном случае она использует 
<span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span>, чтобы сигнализировать об ошибке: 
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table class="RktBlk" cellspacing="0" cellpadding="0"><tbody><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">"traffic light expected, given some other value"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> </span><a href="#%28tech._any%29" class="techoutside" data-pltdoc="x"><span class="techinside">Any</span></a><span class="RktCmt"> -&gt; </span><a href="#%28tech._boolean%29" class="techoutside" data-pltdoc="x"><span class="techinside">Boolean</span></a></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">are the two values elements of </span><a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a><span class="RktCmt"> and, </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">if so, are they equal</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"red"</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#false</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="hspace">&nbsp;</span><span class="RktVal">"green"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._check-expect%29%29" class="RktStxLink" data-pltdoc="x">check-expect</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">#true</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light=?</span><span class="hspace">&nbsp;</span><span class="RktSym">a-value</span><span class="hspace">&nbsp;</span><span class="RktSym">another-value</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._if%29%29" class="RktStxLink" data-pltdoc="x">if</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light?</span><span class="hspace">&nbsp;</span><span class="RktSym">a-value</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">light?</span><span class="hspace">&nbsp;</span><span class="RktSym">another-value</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._string~3d~3f%29%29" class="RktValLink" data-pltdoc="x">string=?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-value</span><span class="hspace">&nbsp;</span><span class="RktSym">another-value</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktSym">MESSAGE</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></tbody></table></blockquote></div>

<p></p>

<p><a name="(counter._(exercise._cond10))"></a><span style="font-weight: bold">Упражнение</span>&nbsp;115.  Исправьте <span class="RktSym">light=?</span>, чтобы в сообщении об ошибке указывалось, какой из двух аргументов не является элементом  
<a href="#%28tech._trafficlight%29" class="techoutside" data-pltdoc="x"><span class="techinside">TrafficLight</span></a>. 
<a href="#%28counter._%28exercise._cond10%29%29" class="ex-end" data-pltdoc="x"></a></p>

<p>Хотя маловероятно, что ваши программы будут использовать  <span class="RktSym">light=?</span>,
им следует использовать <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._key~3d~3f%29%29" class="RktValLink" data-pltdoc="x">key=?</a></span> и 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._mouse~3d~3f%29%29" class="RktValLink" data-pltdoc="x">mouse=?</a></span>, два предиката равенства, 
которые мы кратко упомянули в конце последнего подраздела. 
Естественно, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._key~3d~3f%29%29" class="RktValLink" data-pltdoc="x">key=?</a></span> это операция для сравнения двух 
<a href="#%28tech._keyevent%29" class="techoutside" data-pltdoc="x"><span class="techinside">KeyEvent</span></a>s;; аналогично 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._mouse~3d~3f%29%29" class="RktValLink" data-pltdoc="x">mouse=?</a></span> сравнивает два 
<a href="#%28tech._mouseevt%29" class="techoutside" data-pltdoc="x"><span class="techinside">MouseEvt</span></a>s. Хотя оба типа событий представлены в виде строк, 
важно понимать, что не все строки представляют собой клавиатурные события или 
события мыши. </p>

<p>Мы рекомендуем использовать <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._key~3d~3f%29%29" class="RktValLink" data-pltdoc="x">key=?</a></span> в обработчиках клавиатурных событий и 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._mouse~3d~3f%29%29" class="RktValLink" data-pltdoc="x">mouse=?</a></span>  в обработчиках событий мыши,
с этого момента. 
Использование <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._key~3d~3f%29%29" class="RktValLink" data-pltdoc="x">key=?</a></span> в обработчике клавиатурных событий
гарантирует, что функция действительно сравнивает строки, которые представляют 
клавиатурные события, а не произвольные строки. 
Как только, скажем, функция случайно применяется к <span class="RktVal">"hello\n world"</span>, <span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28def._world._%28%28lib._2htdp%2Funiverse..rkt%29._key~3d~3f%29%29" class="RktValLink" data-pltdoc="x">key=?</a></span> сигнализирует об ошибке и, 
таким образом, сообщает нам, что что-то не так. .</p>

<h3>7<tt>&nbsp;</tt><a name="(part._ch~3asummary1)"></a>Резюме</h3>

<p>Из этой первой части книги вы извлекли ряд простых, но важных уроков. 
Вот краткое изложение: </p>

<ol><li>

<p><span style="font-weight: bold">Хороший программист</span> разрабатывает программы. 
Плохой программист возится, пока программа не заработает. </p>

</li><li>

<p><a name="(idx._(gentag._186))"></a><span style="font-weight: bold">Рецепт разработки</span>
имеет два измерения. Одно касается процесса проектирования, то есть последовательности шагов,
которые необходимо предпринять. Другое объясняет, как выбранное 
<a name="(idx._(gentag._187))"></a>представление данных влияет на 
<a name="(idx._(gentag._188))"></a>процесс проектирования</p>. </p>

</li><li>

<p>Каждая хорошо разработанная программа состоит из множества определений констант, 
определений структурных типов, определений данных и определений функций. 
Для <span style="font-weight: bold">пакетных программ</span> одна функция является 
“main”(главной) функцией, и она обычно составляет несколько других функций 
для выполнения своих вычислений. 
Для <span style="font-weight: bold">интерактивных программ</span> функция 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> играет роль главной функции; 
она определяет начальное состояние программы, функцию вывода изображения и 
не более трех обработчиков событий: один для тактов часов, один для щелчков мыши и 
один для клавиатурных событий. 
В программах обоих типов определения функций представлены “сверху вниз”, начиная с функции main,
за которой следуют функции, упомянутые в основной(main) функции, и так далее. 
</p>

</li><li>

<p>Как и все языки программирования, <span style="font-style: italic">Beginning Student Language</span> имеет <span style="font-weight: bold">словарный запас и грамматику</span>. 
Программисты должны уметь определять <span style="font-weight: bold">смысл</span> 
каждого предложения на языке, чтобы предвидеть, как программа выполняет свои вычисления 
при вводе. Следующее интермеццо подробно объясняет эту идею.  </p>

</li><li>

<p>Языки программирования, включая BSL, поставляются с богатым набором библиотек, 
чтобы программистам не приходилось постоянно изобретать велосипед.
Программист должен освоиться с функциями, которые предоставляет библиотека, 
особенно с их сигнатурами и предназначением. Это упрощает жизнь. </p>

</li><li>

<p>Программист должен знать “инструменты”, которые предлагает выбранный язык программирования. 
Эти инструменты либо являются частью языка, такие как <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28form._%28%28lib._lang%2Fhtdp-beginner..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span> или
 <span class="RktSym"><a href="https://docs.racket-lang.org/htdp-langs/beginner.html#%28def._htdp-beginner._%28%28lib._lang%2Fhtdp-beginner..rkt%29._max%29%29" class="RktValLink" data-pltdoc="x">max</a></span>, либо они “импортируются” из библиотеки. 
В этом духе убедитесь, что вы понимаете следующие термины: <span style="font-weight: bold">structure type</span> definition(определение структурного типа),
<span style="font-weight: bold">function</span> definition(определение функции), 
<span style="font-weight: bold">constant</span> definition(определение константы), 
<span style="font-weight: bold">structure instance</span>(экземпляр структуры), 
<span style="font-weight: bold">data definition</span>(определение данных), 
<span class="RktSym"><a href="https://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> и 
<span style="font-weight: bold">event-handling function</span>(функция обработки событий). 
</p>

</li></ol><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="part_prologue.html" title="backward to &quot;Prologue: How to Program&quot;" data-pltdoc="x">← prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;How to Design Programs, Second Edition&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="i1-2.html" title="forward to &quot;Intermezzo 1: Beginning Student Language&quot;" data-pltdoc="x">next →</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>